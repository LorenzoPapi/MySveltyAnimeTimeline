import"./DsnmJJEf.js";import{a1 as Oi,g as Ni,ba as Bi,h as Rr,ab as Fi,bb as Yi,bc as ji,I as qi,ay as Ui,aj as Vi,ak as Xi,aD as Ki,aF as Gi,ac as Qi,aE as Ji,aH as Zi,aI as pa,e as Ta,U as fe,at as Ae,R as P,X as L,T as j,Q as b,V as he,i as l,W as Y,d as Ve,Y as le,aL as D,J as Z,M as q,O as ct,aM as wt,n as Vt,aK as Q,x as Ze,s as O,ax as En,av as Ln,bd as Wt,b9 as Ma,aQ as Ca,aR as cr,u as $i}from"./DpUfl5DX.js";import{a as ae,b as nt,p as E,s as mt,r as rn}from"./CxoRivNK.js";import{w as Ea}from"./B-Mp_yfi.js";import{e as Ge,s as Te,i as gt,a as ye,c as wn,T as Da,R as Ia,b as vt,S as Wa,D as dr,C as eo,L as zn,P as to,d as Ha,B as ur,f as no,F as fr,M as ro,g as ao,h as io,j as oo,k as so,l as lo,m as co,n as uo,o as fo,p as ho,q as Pr,W as Lr,r as zr}from"./BWseBkBL.js";import{s as Me,b as go,e as Et,d as je,o as Rt}from"./BgCaPG2L.js";import{i as B,b as Xe,c as tt}from"./DGeho7VW.js";import{s as De,r as Ra,b as vo}from"./Cjl8lNBD.js";import{b as mo}from"./CWMWhTOm.js";import"./C1UqVTAy.js";import{i as wo}from"./D1hip-dY.js";const xo=[];function yo(n,e=!1,t=!1){return Mn(n,new Map,"",xo,null,t)}function Mn(n,e,t,r,a=null,i=!1){if(typeof n=="object"&&n!==null){var s=e.get(n);if(s!==void 0)return s;if(n instanceof Map)return new Map(n);if(n instanceof Set)return new Set(n);if(Oi(n)){var o=Array(n.length);e.set(n,o),a!==null&&e.set(a,o);for(var c=0;c<n.length;c+=1){var d=n[c];c in n&&(o[c]=Mn(d,e,t,r,null,i))}return o}if(Ni(n)===Bi){o={},e.set(n,o),a!==null&&e.set(a,o);for(var u in n)o[u]=Mn(n[u],e,t,r,null,i);return o}if(n instanceof Date)return structuredClone(n);if(typeof n.toJSON=="function"&&!i)return Mn(n.toJSON(),e,t,r,n)}if(n instanceof EventTarget)return n;try{return structuredClone(n)}catch{return n}}function _o(n,e,t){Rr&&Fi();var r=n,a=Ji,i,s,o=null,c=Yi()?ji:qi;function d(){i&&Zi(i),o!==null&&(o.lastChild.remove(),r.before(o),o=null),i=s}Ui(()=>{if(c(a,a=e())){var u=r,f=Gi();f&&(o=document.createDocumentFragment(),o.append(u=Vi())),s=Xi(()=>t(u)),f?Ki.add_callback(d):d()}}),Rr&&(r=Qi)}class hr{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,t){var r=this.#e.get(e)||new Set;return r.add(t),this.#e.set(e,r),this.#r().observe(e,this.#n),()=>{var a=this.#e.get(e);a.delete(t),a.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#r(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var t of e){hr.entries.set(t.target,t);for(var r of this.#e.get(t.target)||[])r(t)}}))}}var ko=new hr({box:"border-box"});function $t(n,e,t){var r=ko.observe(n,()=>t(n[e]));pa(()=>(Ta(()=>t(n[e])),r))}const gr={gantt:{"Task name":"Task name","Start date":"Start date","Add task":"Add task",Duration:"Duration",Task:"Task",Milestone:"Milestone","Summary task":"Summary task",Save:"Save",Delete:"Delete",Name:"Name",Description:"Description","Select type":"Select type",Type:"Type","End date":"End date",Progress:"Progress",Predecessors:"Predecessors",Successors:"Successors","Add task name":"Add task name","Add description":"Add description","Select link type":"Select link type","End-to-start":"End-to-start","Start-to-start":"Start-to-start","End-to-end":"End-to-end","Start-to-end":"Start-to-end",Add:"Add","Child task":"Child task","Task above":"Task above","Task below":"Task below","Convert to":"Convert to",Edit:"Edit",Cut:"Cut",Copy:"Copy",Paste:"Paste",Move:"Move",Up:"Up",Down:"Down",Indent:"Indent",Outdent:"Outdent","Split task":"Split task","New task":"New task","Move up":"Move up","Move down":"Move down"}};let bo=new Date().valueOf();const So=()=>bo++;function po(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in e){const r=n[t],a=e[t];if(!An(r,a))return!1}return!0}function An(n,e){if(typeof n=="number"||typeof n=="string"||typeof n=="boolean"||n===null)return n===e;if(typeof n!=typeof e||(n===null||e===null)&&n!==e||n instanceof Date&&e instanceof Date&&n.getTime()!==e.getTime())return!1;if(typeof n=="object")if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let r=n.length-1;r>=0;r--)if(!An(n[r],e[r]))return!1;return!0}else return po(n,e);return n===e}function Dn(n){if(typeof n!="object"||n===null)return n;if(n instanceof Date)return new Date(n);if(n instanceof Array)return n.map(Dn);const e={};for(const t in n)e[t]=Dn(n[t]);return e}class Pa{constructor(e){this._nextHandler=null,this._dispatch=e,this.exec=this.exec.bind(this)}async exec(e,t){return this._dispatch(e,t),this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}}let La=new Date().valueOf();const To=()=>La++;function za(){return"temp://"+La++}class Ar{constructor(e){this._data=e,this._pool=new Map;for(let t=0;t<e.length;t++){const r=e[t];this._pool.set(r.id,r)}}add(e){e={id:To(),...e},this._data.push(e),this._pool.set(e.id,e)}update(e,t){const r=this._data.findIndex(i=>i.id==e),a={...this._data[r],...t};this._data[r]=a,this._pool.set(a.id,a)}remove(e){this._data=this._data.filter(t=>t.id!=e),this._pool.delete(e)}filter(e){this._data=this._data.filter(t=>{const r=e(t);return r||this._pool.delete(t.id),r})}byId(e){return this._pool.get(e)}map(e){return this._data.map(e)}forEach(e){this._data.forEach(e)}}let Mo=class{constructor(e){const t={id:0,$level:0,data:[],parent:null},r=new Map;r.set(0,t),this._pool=r,e&&e.length&&this.parse(e,0)}parse(e,t){const r=this._pool;for(let i=0;i<e.length;i++){const s=e[i];s.parent=s.parent||t,s.data=null,r.set(s.id,s)}for(let i=0;i<e.length;i++){const s=e[i],o=r.get(s.parent);o&&(o.data||(o.data=[]),o.data.push(s))}const a=r.get(t);this.setLevel(a,a.$level+1,!1)}add(e,t){const r=this._pool.get(e.parent||0);e.$level=r.$level+1,this._pool.set(e.id,e),r.data?t===-1?r.data=[...r.data,e]:Or(r,t,e):r.data=[e]}addAfter(e,t){if(!t)return this.add(e,-1);const r=this.byId(t),a=this.byId(r.parent),i=a.data.indexOf(r)+1;e.parent=a.id,e.$level=a.$level+1,this.add(e,i)}remove(e){const t=this._pool.get(e);this._remove(t);const r=this._pool.get(t.parent);r.data=r.data.filter(a=>a.id!=e),this._clearBranch(r)}_remove(e){e.data&&e.data.forEach(t=>this._remove(t)),this._pool.delete(e.id)}update(e,t){let r=this._pool.get(e);const a=this._pool.get(r.parent),i=a?.data.indexOf(r);r={...r,...t},a&&i>=0&&(a.data[i]=r,a.data=[...a.data]),this._pool.set(r.id,r)}move(e,t,r){const a=this._pool.get(e),i=t==="child",s=this._pool.get(r),o=s.$level+(i?1:0);if(!a||!s)return;const c=this._pool.get(a.parent),d=i?s:this._pool.get(s.parent);d.data||(d.data=[]);const u=c.data.indexOf(a);Co(c,u);const f=i?d.data.length:d.data.indexOf(s)+(t==="after"?1:0);if(Or(d,f,a),c.id===d.id&&u===f)return null;a.parent=d.id,a.$level!==o&&(a.$level=o,this.setLevel(a,o+1,!0)),this.update(a.id,a),this._clearBranch(c)}_clearBranch(e){e.data&&!e.data.length&&(e.open&&delete e.open,this.update(e.id,{data:null}))}toArray(){const e=[],t=this._pool.get(0).data;return t&&Aa(t,e),e}byId(e){return this._pool.get(e)}getBranch(e){return this._pool.get(e).data}forEach(e){this._pool.forEach((t,r)=>{r!==0&&e(t)})}eachChild(e,t){const r=this.byId(t);!r||!r.data||r.data.forEach((a,i)=>{e(this.byId(a.id),i),this.eachChild(e,a.id)})}setLevel(e,t,r){e.data&&(e.data=e.data.map(a=>(r&&(a={...a},this._pool.set(a.id,a)),a.$level=t,a.data&&this.setLevel(a,t+1,r),a)))}};function Aa(n,e){n.forEach(t=>{e.push(t),t.open===!0&&Aa(t.data,e)})}function Co(n,e){const t=[...n.data];t.splice(e,1),n.data=t}function Or(n,e,t){const r=[...n.data];r.splice(e,0,t),n.data=r}const Oa=2;let Eo=class{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,t=0){const r={};return this._wrapProperties(e,this._state,this._values,"",r,t),r}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,t,r,a,i,s){for(const o in e){const c=t[o],d=r[o],u=e[o];if(c&&(d===u&&typeof u!="object"||u instanceof Date&&d instanceof Date&&d.getTime()===u.getTime()))continue;const f=a+(a?".":"")+o;c?(c.__parse(u,f,i,s)&&(r[o]=u),s&Oa?i[f]=c.__trigger:c.__trigger()):(u&&u.__reactive?t[o]=this._wrapNested(u,u,f,i):t[o]=this._wrapWritable(u),r[o]=u),i[f]=i[f]||null}}_wrapNested(e,t,r,a){const i=this._wrapWritable(e);return this._wrapProperties(e,i,t,r,a,0),i.__parse=(s,o,c,d)=>(this._wrapProperties(s,i,t,o,c,d),!1),i}_wrapWritable(e){const t=[],r=function(){for(let a=0;a<t.length;a++)t[a](e)};return{subscribe:a=>(t.push(a),this._async?setTimeout(a,1,e):a(e),()=>{const i=t.indexOf(a);i>=0&&t.splice(i,1)}),__trigger:()=>{t.length&&(this._async?setTimeout(r,1):r())},__parse:function(a){return e=a,!0}}}},Do=class{constructor(e,t,r,a){typeof e=="function"?this._setter=e:this._setter=e.setState.bind(e),this._routes=t,this._parsers=r,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(i=>{i.in.forEach(s=>{const o=this._triggers.get(s)||[];o.push(i),this._triggers.set(s,o)}),i.out.forEach(s=>{const o=this._sources.get(s)||{};i.in.forEach(c=>o[c]=!0),this._sources.set(s,o)})}),this._routes.forEach(i=>{i.length=Math.max(...i.in.map(s=>Na(s,this._sources,1)))}),this._bus=a}init(e){const t={};for(const r in e)if(this._prev[r]!==e[r]){const a=this._parsers[r];t[r]=a?a(e[r]):e[r]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(t),this._bus&&this._bus.exec("init-state",t)}setStateAsync(e){const t=this._setter(e,Oa);return this._async?Object.assign(this._async.signals,t):this._async={signals:t,timer:setTimeout(this._applyState.bind(this),1)},t}_applyState(){const e=this._async;if(e){this._async=null,this._triggerUpdates(e.signals,[]);for(const t in e.signals){const r=e.signals[t];r&&r()}}}setState(e,t=[]){const r=this._setter(e);return this._triggerUpdates(r,t),r}_triggerUpdates(e,t){const r=Object.keys(e),a=!t.length;t=t||[];for(let i=0;i<r.length;i++){const s=r[i],o=this._triggers.get(s);o&&o.forEach(c=>{t.indexOf(c)==-1&&t.push(c)})}a&&this._execNext(t)}_execNext(e){for(;e.length;){e.sort((r,a)=>r.length<a.length?1:-1);const t=e[e.length-1];e.splice(e.length-1),t.exec(e)}}};function Na(n,e,t){const r=e.get(n);if(!r)return t;const a=Object.keys(r).map(i=>Na(i,e,t+1));return Math.max(...a)}let Io=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,t,r){let a=this._handlers[e];a?r&&r.intercept?a.unshift(t):a.push(t):a=this._handlers[e]=[t],r&&r.tag&&this._tag.set(t,r.tag)}intercept(e,t,r){this.on(e,t,{...r,intercept:!0})}detach(e){for(const t in this._handlers){const r=this._handlers[t];for(let a=r.length-1;a>=0;a--)this._tag.get(r[a])===e&&r.splice(a,1)}}async exec(e,t){const r=this._handlers[e];if(r)for(let a=0;a<r.length;a++){const i=r[a](t);if(i===!1||i&&i.then&&await i===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}};function Wo(n,e){return typeof n=="string"?n.localeCompare(e,void 0,{numeric:!0}):typeof n=="object"?n.getTime()-e.getTime():(n??0)-(e??0)}function Ho(n,e){return typeof n=="string"?-n.localeCompare(e,void 0,{numeric:!0}):typeof e=="object"?e.getTime()-n.getTime():(e??0)-(n??0)}function Ro({key:n,order:e}){const t=e==="asc"?Wo:Ho;return(r,a)=>t(r[n],a[n])}function Po(n){if(!n||!n.length)return;const e=n.map(t=>Ro(t));return n.length===1?e[0]:function(t,r){for(let a=0;a<e.length;a++){const i=e[a](t,r);if(i!==0)return i}return 0}}function Lo(n,e){return n.sort(Po(e))}function _e(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function yt(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function Ba(n,e){const t=_e(n);return isNaN(e)?yt(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function vr(n,e){const t=_e(n);if(isNaN(e))return yt(n,NaN);if(!e)return t;const r=t.getDate(),a=yt(n,t.getTime());a.setMonth(t.getMonth()+e+1,0);const i=a.getDate();return r>=i?a:(t.setFullYear(a.getFullYear(),a.getMonth(),r),t)}function Fa(n,e){const t=+_e(n);return yt(n,t+e)}const On=6048e5,zo=864e5,Ya=6e4,ja=36e5;function Ao(n,e){return Fa(n,e*ja)}let Oo={};function Nn(){return Oo}function Nt(n,e){const t=Nn(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=_e(n),i=a.getDay(),s=(i<r?7:0)+i-r;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function tn(n){return Nt(n,{weekStartsOn:1})}function qa(n){const e=_e(n),t=e.getFullYear(),r=yt(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const a=tn(r),i=yt(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const s=tn(i);return e.getTime()>=a.getTime()?t+1:e.getTime()>=s.getTime()?t:t-1}function gn(n){const e=_e(n);return e.setHours(0,0,0,0),e}function In(n){const e=_e(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function mr(n,e){const t=gn(n),r=gn(e),a=+t-In(t),i=+r-In(r);return Math.round((a-i)/zo)}function Jn(n){const e=qa(n),t=yt(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),tn(t)}function No(n,e){return Fa(n,e*Ya)}function Bo(n,e){const t=e*3;return vr(n,t)}function Ua(n,e){const t=e*7;return Ba(n,t)}function Fo(n,e){return vr(n,e*12)}function fn(n,e){const t=_e(n),r=_e(e),a=t.getTime()-r.getTime();return a<0?-1:a>0?1:a}function Yo(n,e){const t=gn(n),r=gn(e);return+t==+r}function jo(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function qo(n){if(!jo(n)&&typeof n!="number")return!1;const e=_e(n);return!isNaN(Number(e))}function wr(n,e){const t=tn(n),r=tn(e),a=+t-In(t),i=+r-In(r);return Math.round((a-i)/On)}function Uo(n,e){const t=_e(n),r=_e(e),a=t.getFullYear()-r.getFullYear(),i=t.getMonth()-r.getMonth();return a*12+i}function Vo(n,e){const t=_e(n),r=_e(e);return t.getFullYear()-r.getFullYear()}function xr(n){return e=>{const t=(n?Math[n]:Math.trunc)(e);return t===0?0:t}}function Va(n,e){return+_e(n)-+_e(e)}function Xo(n,e,t){const r=Va(n,e)/ja;return xr(t?.roundingMethod)(r)}function Ko(n,e,t){const r=Va(n,e)/Ya;return xr(t?.roundingMethod)(r)}function Xa(n){const e=_e(n);return e.setHours(23,59,59,999),e}function yr(n){const e=_e(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Go(n){const e=_e(n);return+Xa(e)==+yr(e)}function Ka(n,e){const t=_e(n),r=_e(e),a=fn(t,r),i=Math.abs(Uo(t,r));let s;if(i<1)s=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-a*i);let o=fn(t,r)===-a;Go(_e(n))&&i===1&&fn(n,r)===1&&(o=!1),s=a*(i-Number(o))}return s===0?0:s}function Qo(n,e,t){const r=Ka(n,e)/3;return xr(t?.roundingMethod)(r)}function Jo(n,e){const t=_e(n),r=_e(e),a=fn(t,r),i=Math.abs(Vo(t,r));t.setFullYear(1584),r.setFullYear(1584);const s=fn(t,r)===-a,o=a*(i-+s);return o===0?0:o}function vn(n){const e=_e(n),t=e.getMonth(),r=t-t%3;return e.setMonth(r,1),e.setHours(0,0,0,0),e}function Ga(n){const e=_e(n);return e.setDate(1),e.setHours(0,0,0,0),e}function Zo(n){const e=_e(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function Qa(n){const e=_e(n),t=yt(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function $o(n){const e=_e(n);return e.setMinutes(59,59,999),e}function es(n,e){const t=e?.weekStartsOn,r=_e(n),a=r.getDay(),i=(a<t?-7:0)+6-(a-t);return r.setDate(r.getDate()+i),r.setHours(23,59,59,999),r}function _r(n){const e=_e(n),t=e.getMonth(),r=t-t%3+3;return e.setMonth(r,0),e.setHours(23,59,59,999),e}const ts={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ns=(n,e,t)=>{let r;const a=ts[n];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function qn(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const rs={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},as={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},is={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},os={date:qn({formats:rs,defaultWidth:"full"}),time:qn({formats:as,defaultWidth:"full"}),dateTime:qn({formats:is,defaultWidth:"full"})},ss={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ls=(n,e,t,r)=>ss[n];function sn(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&n.formattingValues){const s=n.defaultFormattingWidth||n.defaultWidth,o=t?.width?String(t.width):s;a=n.formattingValues[o]||n.formattingValues[s]}else{const s=n.defaultWidth,o=t?.width?String(t.width):n.defaultWidth;a=n.values[o]||n.values[s]}const i=n.argumentCallback?n.argumentCallback(e):e;return a[i]}}const cs={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ds={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},us={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},fs={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},hs={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},gs={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},vs=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},ms={ordinalNumber:vs,era:sn({values:cs,defaultWidth:"wide"}),quarter:sn({values:ds,defaultWidth:"wide",argumentCallback:n=>n-1}),month:sn({values:us,defaultWidth:"wide"}),day:sn({values:fs,defaultWidth:"wide"}),dayPeriod:sn({values:hs,defaultWidth:"wide",formattingValues:gs,defaultFormattingWidth:"wide"})};function ln(n){return(e,t={})=>{const r=t.width,a=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],i=e.match(a);if(!i)return null;const s=i[0],o=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(o)?xs(o,f=>f.test(s)):ws(o,f=>f.test(s));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const u=e.slice(s.length);return{value:d,rest:u}}}function ws(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function xs(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function ys(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const a=r[0],i=e.match(n.parsePattern);if(!i)return null;let s=n.valueCallback?n.valueCallback(i[0]):i[0];s=t.valueCallback?t.valueCallback(s):s;const o=e.slice(a.length);return{value:s,rest:o}}}const _s=/^(\d+)(th|st|nd|rd)?/i,ks=/\d+/i,bs={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ss={any:[/^b/i,/^(a|c)/i]},ps={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ts={any:[/1/i,/2/i,/3/i,/4/i]},Ms={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Cs={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Es={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ds={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Is={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ws={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Hs={ordinalNumber:ys({matchPattern:_s,parsePattern:ks,valueCallback:n=>parseInt(n,10)}),era:ln({matchPatterns:bs,defaultMatchWidth:"wide",parsePatterns:Ss,defaultParseWidth:"any"}),quarter:ln({matchPatterns:ps,defaultMatchWidth:"wide",parsePatterns:Ts,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ln({matchPatterns:Ms,defaultMatchWidth:"wide",parsePatterns:Cs,defaultParseWidth:"any"}),day:ln({matchPatterns:Es,defaultMatchWidth:"wide",parsePatterns:Ds,defaultParseWidth:"any"}),dayPeriod:ln({matchPatterns:Is,defaultMatchWidth:"any",parsePatterns:Ws,defaultParseWidth:"any"})},Rs={code:"en-US",formatDistance:ns,formatLong:os,formatRelative:ls,localize:ms,match:Hs,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ps(n){const e=_e(n);return mr(e,Qa(e))+1}function Ls(n){const e=_e(n),t=+tn(e)-+Jn(e);return Math.round(t/On)+1}function Ja(n,e){const t=_e(n),r=t.getFullYear(),a=Nn(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=yt(n,0);s.setFullYear(r+1,0,i),s.setHours(0,0,0,0);const o=Nt(s,e),c=yt(n,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const d=Nt(c,e);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function zs(n,e){const t=Nn(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Ja(n,e),i=yt(n,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),Nt(i,e)}function As(n,e){const t=_e(n),r=+Nt(t,e)-+zs(t,e);return Math.round(r/On)+1}function Ne(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const zt={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return Ne(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Ne(t+1,2)},d(n,e){return Ne(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Ne(n.getHours()%12||12,e.length)},H(n,e){return Ne(n.getHours(),e.length)},m(n,e){return Ne(n.getMinutes(),e.length)},s(n,e){return Ne(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Ne(a,e.length)}},Qt={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Nr={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return zt.y(n,e)},Y:function(n,e,t,r){const a=Ja(n,r),i=a>0?a:1-a;if(e==="YY"){const s=i%100;return Ne(s,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Ne(i,e.length)},R:function(n,e){const t=qa(n);return Ne(t,e.length)},u:function(n,e){const t=n.getFullYear();return Ne(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Ne(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Ne(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return zt.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return Ne(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const a=As(n,r);return e==="wo"?t.ordinalNumber(a,{unit:"week"}):Ne(a,e.length)},I:function(n,e,t){const r=Ls(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):Ne(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):zt.d(n,e)},D:function(n,e,t){const r=Ps(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Ne(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const a=n.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Ne(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const a=n.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Ne(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),a=r===0?7:r;switch(e){case"i":return String(a);case"ii":return Ne(a,e.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const r=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let a;switch(r===12?a=Qt.noon:r===0?a=Qt.midnight:a=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let a;switch(r>=17?a=Qt.evening:r>=12?a=Qt.afternoon:r>=4?a=Qt.morning:a=Qt.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return zt.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):zt.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Ne(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):Ne(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):zt.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):zt.s(n,e)},S:function(n,e){return zt.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Fr(r);case"XXXX":case"XX":return jt(r);case"XXXXX":case"XXX":default:return jt(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return Fr(r);case"xxxx":case"xx":return jt(r);case"xxxxx":case"xxx":default:return jt(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Br(r,":");case"OOOO":default:return"GMT"+jt(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Br(r,":");case"zzzz":default:return"GMT"+jt(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return Ne(r,e.length)},T:function(n,e,t){const r=n.getTime();return Ne(r,e.length)}};function Br(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),a=Math.trunc(r/60),i=r%60;return i===0?t+String(a):t+String(a)+e+Ne(i,2)}function Fr(n,e){return n%60===0?(n>0?"-":"+")+Ne(Math.abs(n)/60,2):jt(n,e)}function jt(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),a=Ne(Math.trunc(r/60),2),i=Ne(r%60,2);return t+a+e+i}const Yr=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Za=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Os=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Yr(n,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Yr(r,e)).replace("{{time}}",Za(a,e))},Ns={p:Za,P:Os},Bs=/^D+$/,Fs=/^Y+$/,Ys=["D","DD","YY","YYYY"];function js(n){return Bs.test(n)}function qs(n){return Fs.test(n)}function Us(n,e,t){const r=Vs(n,e,t);if(console.warn(r),Ys.includes(n))throw new RangeError(r)}function Vs(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Xs=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ks=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Gs=/^'([^]*?)'?$/,Qs=/''/g,Js=/[a-zA-Z]/;function Zn(n,e,t){const r=Nn(),a=t?.locale??r.locale??Rs,i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=_e(n);if(!qo(o))throw new RangeError("Invalid time value");let c=e.match(Ks).map(u=>{const f=u[0];if(f==="p"||f==="P"){const h=Ns[f];return h(u,a.formatLong)}return u}).join("").match(Xs).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const f=u[0];if(f==="'")return{isToken:!1,value:Zs(u)};if(Nr[f])return{isToken:!0,value:u};if(f.match(Js))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:u}});a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const d={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return c.map(u=>{if(!u.isToken)return u.value;const f=u.value;(!t?.useAdditionalWeekYearTokens&&qs(f)||!t?.useAdditionalDayOfYearTokens&&js(f))&&Us(f,e,String(n));const h=Nr[f[0]];return h(o,f,a.localize,d)}).join("")}function Zs(n){const e=n.match(Gs);return e?e[1].replace(Qs,"'"):n}function $a(n){const e=_e(n),t=e.getFullYear(),r=e.getMonth(),a=yt(n,0);return a.setFullYear(t,r+1,0),a.setHours(0,0,0,0),a.getDate()}function $s(n){const e=_e(n).getFullYear();return e%400===0||e%4===0&&e%100!==0}function ei(n){const e=_e(n);return String(new Date(e))==="Invalid Date"?NaN:$s(e)?366:365}function el(n){const e=Jn(n),t=+Jn(Ua(e,60))-+e;return Math.round(t/On)}function Jt(n,e){const t=_e(n),r=_e(e);return+t==+r}function tl(n){const e=_e(n);return e.setMinutes(0,0,0),e}function nl(n,e,t){const r=Nt(n,t),a=Nt(e,t);return+r==+a}function rl(n,e){const t=_e(n),r=_e(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function al(n,e){const t=vn(n),r=vn(e);return+t==+r}function il(n,e){const t=_e(n),r=_e(e);return t.getFullYear()===r.getFullYear()}const $n=8,ti=4,ol=3,jr=7,sl=$n+ti;function ni(n,e){(n.open||n.type!="summary")&&n.data?.forEach(t=>{t.$x+=e,ni(t,e)})}function er(n,e,t,r){const a=n.getSummaryId(e.id);if(a){const i=n.byId(a),s={xMin:1/0,xMax:0};ri(i,s,t,r),i.$x=s.xMin,i.$w=s.xMax-s.xMin,er(n,i,t,r)}}function ri(n,e,t,r){const{lengthUnit:a,start:i}=t;n.data?.forEach(s=>{if(!s.unscheduled){typeof s.$x>"u"&&(s.$x=Math.round(t.diff(s.start,i,a)*r),s.$w=Math.round(t.diff(s.end,s.start,a,!0)*r));const o=s.type==="milestone"&&s.$h?s.$h/2:0;e.xMin>s.$x&&(e.xMin=s.$x+o);const c=s.$x+s.$w-o;e.xMax<c&&(e.xMax=c)}s.type!=="summary"&&ri(s,e,t,r)})}function kr(n,e){let t;e&&(t=e.filter(a=>a.parent==n.id));const r={data:t,...n};if(r.data?.length)r.data.forEach(a=>{if(a.unscheduled&&!a.data)return;(e||a.type!="summary"&&a.data)&&(a.unscheduled&&(a={...a,start:void 0,end:void 0}),a=kr(a,e)),a.start&&(!r.start||r.start>a.start)&&(r.start=new Date(a.start));const i=a.type==="milestone"?a.start:a.end;i&&(!r.end||r.end<i)&&(r.end=new Date(i))});else if(n.type==="summary")throw Error("Summary tasks must have start and end dates if they have no subtasks");return r}function ll(n,e,t,r,a,i){return qr(n,e,t,r,a,i,!1),i&&qr(n,e,t,r,a,i,!0),n}function qr(n,e,t,r,a,i,s){const{start:o,end:c,lengthUnit:d,diff:u}=a,f=(s?"base_":"")+"start",h=(s?"base_":"")+"end",g="$x"+(s?"_base":""),v="$y"+(s?"_base":""),m="$w"+(s?"_base":""),w="$h"+(s?"_base":""),y="$skip"+(s?"_baseline":"");let S=n[f],M=n[h];if(s&&!S){n[y]=!0;return}n[f]<o&&(n[h]<o||Jt(n[h],o))?S=M=o:n[f]>c&&(S=M=c),n[g]=Math.round(u(S,o,d)*t),n[v]=s?n.$y+n.$h+ti:r*e+ol,n[m]=Math.round(u(M,S,d,!0)*t),n[w]=s?$n:i?r-jr-sl:r-jr,n.type==="milestone"&&(n[g]=n[g]-n.$h/2,n[m]=n.$h,s&&(n[v]=n.$y+$n,n[m]=n[w]=n.$h)),n.unscheduled&&!s?n.$skip=!0:n[y]=Jt(S,M)}class cl extends Mo{_sort;constructor(e){super(),this.parse(e,0)}parse(e,t){if(!e||!e.length)return;const r=e.map(a=>this.normalizeTask(a,e));super.parse(r,t),this._sort&&this.sortBranch(this._sort,t)}getBranch(e){const t=this._pool.get(e);return this._pool.get(t.parent||0).data}contains(e,t){const r=this._pool.get(e).data;let a=!1;if(r)for(let i=0;i<r.length;i++){if(r[i].id===t){a=!0;break}if(r[i].data&&(a=this.contains(r[i].id,t),a))break}return a}getIndexById(e){return this.getBranch(e).findIndex(t=>t.id===e)}add(e,t){const r=this.normalizeTask(e);return super.add(r,t),r}copy(e,t,r){const a=this.add({...e,id:null,data:null,parent:t},r);let i=[[e.id,a.id]];return e.data?.forEach((s,o)=>{const c=this.copy(s,a.id,o);i=i.concat(c)}),i}normalizeTask(e,t){const r=e.id||za(),a=e.parent||0,i=e.text||"",s=e.type||"task",o=e.progress||0,c=e.details||"",d={...e,id:r,text:i,parent:a,progress:o,type:s,details:c};if(d.type==="summary"&&!(d.start&&d.end)){const{start:u,end:f}=kr({...d},t);d.start=u,d.end=f}return d}getSummaryId(e){const t=this._pool.get(e);if(!t.parent)return null;const r=this._pool.get(t.parent);return r.type==="summary"?r.id:this.getSummaryId(r.id)}sort(e){this._sort=e,e&&this.sortBranch(e,0)}sortBranch(e,t){const r=this._pool.get(t||0).data;r&&(Lo(r,e),r.forEach(a=>{this.sortBranch(e,a.id)}))}serialize(){const e=[],t=this._pool.get(0).data;return t&&ai(t,e),e}}function ai(n,e){n.forEach(t=>{e.push(t),t.data&&ai(t.data,e)})}const tr={year:Jo,quarter:Qo,month:Ka,week:wr,day:mr,hour:Xo,minute:Ko},Bt={year:{quarter:4,month:12,week:el,day:dl,hour:ul},quarter:{month:3,week:fl,day:ii,hour:hl},month:{week:gl,day:vl,hour:ml},week:{day:7,hour:168},day:{hour:24},hour:{minute:60}};function dl(n){return n?ei(n):365}function ul(n){return ei(n)*24}function fl(n){const e=vn(n),t=_r(n);return wr(t,e)}function ii(n){if(n){const e=vn(n),t=_r(n);return mr(t,e)}return 91}function hl(n){return ii(n)*24}function gl(n){if(n){const e=Ga(n),t=yr(n);return wr(t,e)}return 5}function vl(n){return n?$a(n):30}function ml(n){return $a(n)*24}function Wn(n,e,t){const r=Bt[n][e];return r?typeof r=="number"?r:r(t):1}function wl(n,e){return n===e||!!(Bt[n]&&Bt[n][e])}const br={year:Fo,quarter:Bo,month:vr,week:Ua,day:Ba,hour:Ao,minute:No};function Sr(n){return(e,t,r,a)=>!Bt[n][r]||typeof Bt[n][r]=="number"||ci(n,e,t)?un(n,e,t,r,a):xl(e,t,n,r,a)}function un(n,e,t,r,a){const i=r||n;let s=t,o=e;if(a&&(s=Ht(i,t),o=Ht(i,e),o<e&&(o=Ct(i)(o,1))),n!==i){const c=tr[i](o,s),d=Wn(n,i,t);return c/d}else return tr[i](o,s)}function xl(n,e,t,r,a){let i=0;if(e>Ht(t,e)){const o=yl(t,e);i=un(t,o,e,r),e=o}let s=0;return ci(t,e,n)||(s=un(t,Ht(t,n),e),e=br[t](e,s)),s+=i+un(t,n,e,r),!s&&a&&(s=un(t,n,e,r,a)),s}function Ct(n){return br[n]}const oi={year:Qa,quarter:vn,month:Ga,week:n=>Nt(n,{weekStartsOn:1}),day:gn,hour:tl};function Ht(n,e){const t=oi[n];return t?t(e):new Date(e)}const si={year:Zo,quarter:_r,month:yr,week:n=>es(n,{weekStartsOn:1}),day:Xa,hour:$o};function yl(n,e){const t=si[n];return t?t(e):new Date(e)}const li={year:il,quarter:al,month:rl,week:(n,e)=>nl(n,e,{weekStartsOn:1}),day:Yo};function ci(n,e,t){const r=li[n];return r?r(e,t):!1}const _l={start:oi,end:si,add:br,isSame:li,diff:tr,smallerCount:Bt},Ur=n=>typeof n=="function"?n(new Date):n;function Cg(n,e){for(const t in e){if(t==="smallerCount"){const r=Object.keys(e[t]).sort((o,c)=>pt.indexOf(o)-pt.indexOf(c)).shift();let a=pt.indexOf(r);const i=e[t][r],s=Ur(i);for(let o=a-1;o>=0;o--){const c=pt[o],d=Ur(Bt[c][r]);if(s<=d)break;a=o}pt.splice(a,0,n)}if(t==="biggerCount")for(const r in e[t])Bt[r][n]=e[t][r];else _l[t][n]=e[t]}}function nn(n){const e=new Date;return n.map(t=>({item:t,len:Ct(t.unit)(e,1)})).sort((t,r)=>t.len<r.len?-1:1)[0].item}const pt=["year","quarter","month","week","day","hour"],bn={year:"yyyy",quarter:"QQQ",month:"MMM",week:"w",day:"MMM d",hour:"HH:mm"},nr=50,rr=300;function kl(n,e,t,r,a){let i=n,s=e,o=!1,c=!1;a&&a.forEach(u=>{(!n||t)&&(!i||u.start<=i)&&(i=u.start,o=!0);const f=u.type==="milestone"?u.start:u.end;(!e||t)&&(!s||f>=s)&&(s=f,c=!0)});const d=Ct(r||"day");return i?o&&(i=d(i,-1)):s?i=d(s,-30):i=new Date,s?c&&(s=d(s,1)):s=d(i,30),{_start:i,_end:s}}function bl(n,e,t,r,a,i){const s=nn(i).unit,o=Sr(s),c=o(e,n,"",!0),d=Ht(s,e);n=Ht(s,n),e=d<e?Ct(s)(d,1):d;const u=c*r,f=a*i.length,h=i.map(v=>{const m=[],w=Ct(v.unit);let y=Ht(v.unit,n);for(;y<e;){let S=w(y,v.step);y<n&&(y=n),S>e&&(S=e);const M=o(S,y,"",!0)*r,k=typeof v.format=="function"?v.format(y,S):Zn(y,v.format,{firstWeekContainsDate:4,weekStartsOn:1});let _="";v.css&&(_+=typeof v.css=="function"?v.css(y):v.css),m.push({width:M,value:k,date:y,css:_,unit:v.unit}),y=S}return{cells:m,add:w,height:a}});let g=r;return s!==t&&(g=Math.round(g/Wn(s,t))||1),{rows:h,width:u,height:f,diff:o,start:n,end:e,lengthUnit:t,minUnit:s,lengthUnitWidth:g}}function Sl(n,e,t){const r=typeof n=="boolean"?{}:n,a=pt.indexOf(nn(e).unit);if(typeof r.level>"u"&&(r.level=a),r.levels)r.levels.forEach(o=>{o.minCellWidth||(o.minCellWidth=Sn(r.minCellWidth,nr)),o.maxCellWidth||(o.maxCellWidth=Sn(r.maxCellWidth,rr))});else{const o=[],c=e.length||1,d=Sn(r.minCellWidth,nr),u=Sn(r.maxCellWidth,rr);e.forEach(f=>{f.format&&!bn[f.unit]&&(bn[f.unit]=f.format)}),pt.forEach((f,h)=>{if(h===a)o.push({minCellWidth:d,maxCellWidth:u,scales:e});else{const g=[];if(h)for(let v=c-1;v>0;v--){const m=pt[h-v];m&&g.push({unit:m,step:1,format:bn[m]})}g.push({unit:f,step:1,format:bn[f]}),o.push({minCellWidth:d,maxCellWidth:u,scales:g})}}),r.levels=o}r.levels[r.level]||(r.level=0);const i=r.levels[r.level],s=Math.min(Math.max(t,i.minCellWidth),i.maxCellWidth);return{_zoom:r,scales:i.scales,cellWidth:s}}function pl(n,e,t,r,a,i,s){n.level=t;let o;const c=r.scales||r,d=nn(c).unit,u=Tl(d,a);if(e===-1){const g=Wn(d,a);o=s*g}else{const g=Wn(nn(i).unit,d);o=Math.round(s/g)}const f=r.minCellWidth??nr,h=r.maxCellWidth??rr;return{scales:c,cellWidth:Math.min(h,Math.max(f,o)),lengthUnit:u,zoom:n}}function Tl(n,e){const t=pt.indexOf(n),r=pt.indexOf(e);return r>=t?n==="hour"?"hour":"day":pt[r]}function Sn(n,e){return n??e}const Un=20,Ml=function(n,e,t,r,a){const i=Math.round(r/2)-3;if(!e||!t||!e.$y||!t.$y||e.$skip||t.$skip)return n.$p="",n;let s=!1,o=!1;switch(n.type){case"e2s":o=!0;break;case"s2s":s=!0,o=!0;break;case"s2e":s=!0;break}const c=s?e.$x:e.$x+e.$w,d=a?e.$y-7:e.$y,u=o?t.$x:t.$x+t.$w,f=a?t.$y-7:t.$y;if(c!==u||d!==f){const h=Cl(c,d+i,u,f+i,s,o,r/2,a),g=El(u,f+i,o);n.$p=`${h},${g}`}return n};function Cl(n,e,t,r,a,i,s,o){const c=Un*(a?-1:1),d=Un*(i?-1:1),u=n+c,f=t+d,h=[n,e,u,e,0,0,0,0,f,r,t,r],g=f-u;let v=r-e;const m=i===a;return m||(f<=n+Un-2&&i||f>n&&!i)&&(v=o?v-s+6:v-s),m&&i&&u>f||m&&!i&&u<f?(h[4]=h[2]+g,h[5]=h[3],h[6]=h[4],h[7]=h[5]+v):(h[4]=h[2],h[5]=h[3]+v,h[6]=h[4]+g,h[7]=h[5]),h.join(",")}function El(n,e,t){return t?`${n-5},${e-3},${n-5},${e+3},${n},${e}`:`${n+5},${e+3},${n+5},${e-3},${n},${e}`}const di=["start","end","duration"];function Dl(n,e){const{type:t,unscheduled:r}=n;return r||t==="summary"?!di.includes(e):t==="milestone"?!["end","duration"].includes(e):!0}function Il(n,e){return typeof e=="function"?e:di.includes(n)?(typeof e=="string"&&(e={type:e,config:{}}),e.type==="datepicker"&&(e.config.buttons=["today"]),(t,r)=>Dl(t,r.id)?e:null):e}function Wl(n){return!n||!n.length?[]:n.map(e=>{const t=e.align||"left",r=e.id==="add-task",a=!r&&e.flexgrow?e.flexgrow:null,i=a?1:e.width||(r?50:120);let s=e.template;if(!s)switch(e.id){case"start":s=c=>Zn(c,"dd-MM-yyyy");break;case"end":s=c=>c?Zn(c,"dd-MM-yyyy"):"-";break}const o=e.editor&&Il(e.id,e.editor);return{width:i,align:t,header:e.header,id:e.id,template:s,...a&&{flexgrow:a},cell:e.cell,resize:e.resize??!0,sort:e.sort??!r,...o&&{editor:o},...e.options&&{options:e.options}}})}const Hl=[{id:"text",header:"Task name",flexgrow:1,sort:!0},{id:"start",header:"Start date",align:"center",sort:!0},{id:"duration",header:"Duration",width:100,align:"center",sort:!0},{id:"add-task",header:"Add task",width:50,align:"center",sort:!1,resize:!1}];function Rl(){let n=!0;return n=!1,n}function Zt(n,e,t,r){const{selected:a,tasks:i}=n.getState(),s=a.length,o=!s&&e==="add-task",c=["edit-task","paste-task"],d=["copy-task","cut-task"],u=["copy-task","cut-task","delete-task","indent-task:remove","move-task:down"],f=["indent-task:add","move-task:down","move-task:up"],h={"indent-task:remove":2},g={parent:f.includes(e),level:h[e]};if(t=t||(s?a[a.length-1]:null),!(!t&&!o)){if(e!=="paste-task"&&(n._temp=null),c.includes(e)||o||a.length===1)Vr(n,e,t,r);else if(s){const v=d.includes(e)?a:Pl(a,i,g);u.includes(e)&&v.reverse(),v.forEach(m=>Vr(n,e,m,r))}}}function Pl(n,e,t){let r=n.map(a=>{const i=e.byId(a);return{id:a,level:i.$level,parent:i.parent,index:e.getIndexById(a)}});return(t.parent||t.level)&&(r=r.filter(a=>t.level&&a.level<=t.level||!n.includes(a.parent))),r.sort((a,i)=>a.level-i.level||a.index-i.index),r.map(a=>a.id)}function Vr(n,e,t,r){const a=n.exec?n.exec:n.in.exec;let i=e.split(":")[0],s=e.split(":")[1],o={id:t},c={};if(i=="copy-task"||i=="cut-task"){n._temp||(n._temp=[]),n._temp.push({id:t,cut:i=="cut-task"});return}else if(i=="paste-task"){n._temp&&n._temp.length&&(n._temp.forEach(d=>{a(d.cut?"move-task":"copy-task",{id:d.id,target:t,mode:"after"})}),n._temp=null);return}else i==="add-task"?(c={task:{type:"task",text:r("New Task")},target:t},o={}):i==="edit-task"?i="show-editor":i==="convert-task"?(i="update-task",c={task:{type:s}},s=void 0):i==="indent-task"&&(s=s==="add");typeof s<"u"&&(c={mode:s,...c}),o={...o,...c},a(i,o)}function pr(n,e){return n.some(t=>t.data?pr(t.data,e):t.id===e)}const Ll=n=>Ct(n),zl=n=>Sr(n);function Xr(n,e,t){Kr(n,e),n.base_start&&Kr(n,e,!0),mn(e,t)}function mn(n,e,t,r){n.unscheduled||(t&&Al(n,r),Gr(n,e)),n.base_start&&Gr(n,e,!0)}function Kr(n,e,t=!1){e.type=e.type||n.type;const[r,a,i]=ui(t);e.type!=="milestone"?(n[a]&&e[r]||(e[r]=n[r]),e[r]&&!(e[i]||e[a])?(e[a]=n[a]>e[r]?n[a]:null,e[a]||(e[i]=1)):e[a]&&!(e[i]||e[r])?(e[r]=n[r]<e[a]?n[r]:e[a],e[r]===e[a]&&(e[i]=1,delete e[a])):e[i]&&!(e[r]||e[a])&&(e[r]=n[r])):(e[a]&&delete e[a],n[a]&&delete n[a])}function Gr(n,e="day",t){const[r,a,i]=ui(t);n.type==="milestone"?n[i]=0:n[r]&&(n[i]?n[a]||(n[a]=Ll(e)(n[r],n[i])):n[a]?n[i]=zl(e)(n[a],n[r]):(n[a]=n[r],n[i]=0))}function ui(n){return n?["base_start","base_end","base_duration"]:["start","end","duration"]}function Al(n,e){e==="duration"&&(n.end=null),n.start&&n.end&&(n.start>=n.end?n.end=null:n.duration=null),n.base_start&&n.base_end&&(n.base_start>=n.base_end?n.base_end=null:n.base_duration=null)}class Ol extends Eo{in;_router;constructor(e){super({writable:e,async:!1}),this._router=new Do(super.setState.bind(this),[{in:["tasks","start","end","scales","autoScale"],out:["_start","_end"],exec:a=>{const{_end:i,_start:s,start:o,end:c,tasks:d,scales:u,autoScale:f}=this.getState();if(!o||!c||f){const h=nn(u).unit,g=kl(o,c,f,h,d);(g._end!=i||g._start!=s)&&this.setState(g,a)}else this.setState({_start:o,_end:c},a)}},{in:["_start","_end","cellWidth","scaleHeight","scales","lengthUnit"],out:["_scales"],exec:a=>{const i=this.getState();let{lengthUnit:s}=i;const{_start:o,_end:c,cellWidth:d,scaleHeight:u,scales:f}=i,h=nn(f).unit;wl(h,s)||(s=h);const g=bl(o,c,s,d,u,f);this.setState({_scales:g},a)}},{in:["_scales","tasks","cellHeight","baselines"],out:["_tasks"],exec:a=>{const{cellWidth:i,cellHeight:s,tasks:o,_scales:c,baselines:d}=this.getState(),u=o.toArray().map((f,h)=>ll(f,h,i,s,c,d));this.setState({_tasks:u},a)}},{in:["_tasks","links","cellHeight"],out:["_links"],exec:a=>{const{tasks:i,links:s,cellHeight:o,baselines:c}=this.getState(),d=s.map(u=>{const f=i.byId(u.source),h=i.byId(u.target);return Ml(u,f,h,o,c)}).filter(u=>u!==null);this.setState({_links:d},a)}},{in:["tasks","activeTask"],out:["_activeTask"],exec:a=>{const{tasks:i,activeTask:s}=this.getState();this.setState({_activeTask:i.byId(s)||null},a)}},{in:["tasks","selected"],out:["_selected"],exec:a=>{const{tasks:i,selected:s}=this.getState(),o=s.map(c=>i.byId(c)).filter(c=>!!c);this.setState({_selected:o},a)}},{in:["start","end"],out:["cellWidth"],exec:a=>{const{_cellWidth:i,cellWidth:s}=this.getState();i!=s&&this.setState({cellWidth:i},a)}},{in:["markers","_scales","cellWidth"],out:["_markers"],exec:a=>{const{markers:i,_scales:s,cellWidth:o}=this.getState(),{start:c,diff:d}=s,u=i.map(f=>(f.left=d(f.start,c)*o,f));this.setState({_markers:u},a)}}],{tasks:a=>new cl(a),links:a=>new Ar(a),columns:a=>Wl(a)});const t=this.in=new Io;t.on("show-editor",({id:a})=>{this.setStateAsync({activeTask:a})}),t.on("select-task",({id:a,toggle:i,range:s,show:o})=>{const{selected:c,_tasks:d,activeTask:u}=this.getState();let f=!1,h;if(c.length&&(i||s)){const v=[...c];if(s){const m=v[v.length-1],w=d.findIndex(_=>_.id==m),y=d.findIndex(_=>_.id==a),S=Math.min(w,y),M=Math.max(w,y)+1,k=d.slice(S,M).map(_=>_.id);w>y&&k.reverse(),k.forEach(_=>{v.includes(_)||v.push(_)})}else if(i){const m=v.findIndex(w=>w==a);m===-1?v.push(a):(f=!0,v.splice(m,1))}h=v}else h=[a];const g={selected:h};o&&h.length&&(g._scrollTask={id:h[0],mode:o}),this.setStateAsync(g),!f&&u&&u!=a&&t.exec("show-editor",{id:a})}),t.on("delete-link",({id:a})=>{const{links:i}=this.getState();i.remove(a),this.setStateAsync({links:i})}),t.on("update-link",a=>{const{links:i}=this.getState(),{id:s,link:o}=a;i.update(s,o),this.setStateAsync({links:i}),a.link=i.byId(s)}),t.on("add-link",a=>{const{link:i}=a,{links:s}=this.getState();!i.source||!i.target||(i.type||(i.type="e2s"),i.id=i.id||za(),s.add(i),this.setStateAsync({links:s}),a.id=i.id,a.link=s.byId(i.id))});let r=null;t.on("move-task",a=>{const{tasks:i}=this.getState();let{mode:s,target:o}=a;const{id:c,inProgress:d}=a,u=i.byId(c);if(typeof d>"u"?a.source=u.parent:a.source=r=r??u.parent,d===!1){i.update(u.id,{$reorder:!1}),this.setState({tasks:i}),r=null;return}if(o===c||i.contains(c,o)){a.skipProvider=!0;return}if(s==="up"||s==="down"){const f=i.getBranch(c);let h=i.getIndexById(c);if(s==="up"){const g=u.parent===0;if(h===0&&g){a.skipProvider=!0;return}h-=1,s="before"}else if(s==="down"){const g=h===f.length-1,v=u.parent===0;if(g&&v){a.skipProvider=!0;return}h+=1,s="after"}if(o=f[h]&&f[h].id||u.parent,o){const g=i.getBranch(o);let v=i.getIndexById(o),m=g[v];if(m.data){if(s==="before"){if(m.parent===u.parent){for(;m.data;)m.open||t.exec("open-task",{id:m.id,mode:!0}),m=m.data[m.data.length-1];o=m.id}}else if(s==="after"){let S;m.parent===u.parent?(S=m,m=m.data[0],o=m.id,s="before"):g.length-1!==v&&(S=m,v+=1,m=g[v],u.$level>m.$level&&m.data?(S=m,m=m.data[0],o=m.id,s="before"):o=m.id),S&&!S.open&&t.exec("open-task",{id:S.id,mode:!0})}}const w=i.getSummaryId(u.id);i.move(c,s,o);const y=i.getSummaryId(c);w!=y&&(w&&this.resetSummaryDates(w,"move-task"),y&&this.resetSummaryDates(y,"move-task"))}}else{const f=i.byId(o);let h=f,g=!1;for(;h.$level>u.$level;)h=i.byId(h.parent),h.id===c&&(g=!0);if(g)return;const v=i.getSummaryId(u.id);if(i.move(c,s,o),s=="child"){let w=f;for(;w.id!==0&&!w.open;)t.exec("open-task",{id:w.id,mode:!0}),w=i.byId(w.parent)}const m=i.getSummaryId(c);v!=m&&(v&&this.resetSummaryDates(v,"move-task"),m&&this.resetSummaryDates(m,"move-task"))}d?this.setState({tasks:i}):this.setStateAsync({tasks:i}),a.target=o,a.mode=s}),t.on("drag-task",a=>{const{id:i,width:s,left:o,top:c,inProgress:d}=a,u=this.getState(),{tasks:f,_tasks:h,_selected:g,_scales:v,cellWidth:m}=u,w={_tasks:h,_selected:g},y=f.byId(i);typeof s<"u"&&(y.$w=s,er(f,y,v,m)),typeof o<"u"&&(y.type==="summary"&&ni(y,o-y.$x),y.$x=o,er(f,y,v,m)),typeof c<"u"&&(y.$y=c+4,y.$reorder=d),typeof s<"u"&&(y.$w=s),typeof o<"u"&&(y.$x=o),typeof c<"u"&&(y.$y=c+4,y.$reorder=d),this.setState(w)}),t.on("update-task",a=>{const{id:i,task:s,eventSource:o}=a;let c=a.diff;const{tasks:d,_scales:u,durationUnit:f}=this.getState(),h=d.byId(i);if(o==="add-task"||o==="copy-task"||o==="move-task"||o==="update-task"||o==="delete-task"){Xr(h,s,f),d.update(i,s);return}const g=u.lengthUnit,v=Ct(g),m=Sr(g);if(c&&(s.start&&(s.start=v(s.start,c)),s.end&&(s.end=v(s.end,c))),s.start&&s.end){if((!Jt(s.start,h.start)||!Jt(s.end,h.end))&&h.type==="summary"&&(!s.type||s.type==="summary")&&h.data?.length){if(!c&&(c=m(s.start,h.start),m(s.end,h.end)!==c))return;this.moveSummaryKids(h,y=>v(y,c),"update-task")}}else if(h.type=="summary"&&(s.start&&!s.end||s.end&&!s.start||s.duration))return;Xr(h,s,f),d.update(i,s),s.type==="summary"&&h.type!=="summary"&&this.resetSummaryDates(i,"update-task");const w=d.getSummaryId(i);w&&this.resetSummaryDates(w,"update-task"),this.setStateAsync({tasks:d}),a.task=d.byId(i)}),t.on("add-task",a=>{const{tasks:i,_scales:s,baselines:o,unscheduledTasks:c,durationUnit:d}=this.getState(),{target:u,mode:f,task:h,show:g}=a;h.unscheduled=c;let v=-1,m,w;if(u?(w=i.byId(u),f=="child"?(m=w,h.parent=m.id):(w.parent!==null&&(m=i.byId(w.parent),h.parent=m.id),v=i.getIndexById(u),f=="after"&&(v+=1))):h.parent&&(m=i.byId(h.parent)),!h.start){if(m?.start)h.start=new Date(m.start.valueOf());else if(w)h.start=new Date(w.start.valueOf());else{const M=i.getBranch(0);let k;if(M?.length){const _=M[M.length-1];if(!_.$skip){const x=new Date(_.start.valueOf());s.start<=x&&(k=x)}}h.start=k||Ct(d)(s.start,1)}h.duration=1,o&&(h.base_start=h.start,h.base_duration=h.duration)}mn(h,d);const y=i.add(h,v);if(m)for(;m&&m.id;)t.exec("open-task",{id:m.id,mode:!0}),m=i.byId(m.parent);a.id=y.id;const S=i.getSummaryId(y.id);S&&this.resetSummaryDates(S,"add-task"),this.setStateAsync({tasks:i}),t.exec("select-task",{id:y.id,show:g||!1}),a.id=y.id,a.task=y}),t.on("delete-task",a=>{const{id:i}=a,{tasks:s,links:o,selected:c}=this.getState();a.source=s.byId(i).parent;const d=s.getSummaryId(i),u=[i];s.eachChild(h=>u.push(h.id),i),o.filter(h=>!(u.includes(h.source)||u.includes(h.target)));const f={tasks:s,links:o};c.includes(i)&&(f.selected=c.filter(h=>h!==i)),s.remove(i),d&&this.resetSummaryDates(d,"delete-task"),this.setStateAsync(f)}),t.on("indent-task",({id:a,mode:i})=>{const{tasks:s}=this.getState();if(i){const o=s.getBranch(a)[s.getIndexById(a)-1];o&&t.exec("move-task",{id:a,mode:"child",target:o.id})}else{const o=s.byId(a),c=s.byId(o.parent);c&&c.parent!==null&&t.exec("move-task",{id:a,mode:"after",target:o.parent})}}),t.on("copy-task",a=>{const{id:i,target:s,mode:o,eventSource:c}=a;if(c==="copy-task")return;const{tasks:d,links:u}=this.getState();if(d.contains(i,s)){a.skipProvider=!0;return}const f=d.getSummaryId(i),h=d.getSummaryId(s);let g=d.getIndexById(s);o=="before"&&(g-=1);const v=d.byId(i),m=d.copy(v,d.byId(s).parent,g+1);a.source=a.id,a.id=m[0][1],v.lazy&&(a.lazy=!0),f!=h&&h&&this.resetSummaryDates(h,"copy-task");let w=[];for(let y=1;y<m.length;y++){const[S,M]=m[y];u.forEach(k=>{if(k.source===S){const _={...k};delete _.target,w.push({..._,source:M})}else if(k.target===S){const _={...k};delete _.source,w.push({..._,target:M})}})}w=w.reduce((y,S)=>{const M=y.findIndex(k=>k.id===S.id);return M>-1?y[M]={...y[M],...S}:y.push(S),y},[]);for(let y=1;y<m.length;y++){const[S,M]=m[y],k=d.byId(M);t.exec("copy-task",{source:S,id:M,lazy:!!k.lazy,eventSource:"copy-task",target:k.parent,mode:"child"})}w.forEach(y=>{t.exec("add-link",{link:{source:y.source,target:y.target,type:y.type}})}),this.setStateAsync({tasks:d})}),t.on("open-task",({id:a,mode:i})=>{const{tasks:s}=this.getState(),o=s.byId(a);o.lazy?t.exec("request-data",{id:o.id}):(s.toArray().forEach(c=>c.$y=0),s.update(a,{open:i}),this.setState({tasks:s}))}),t.on("scroll-chart",({left:a,top:i})=>{if(!isNaN(a)){const s=this.calcScaleDate(a);this.setState({scrollLeft:a,_scaleDate:s})}isNaN(i)||this.setState({scrollTop:i})}),t.on("render-data",a=>{this.setState({area:a})}),t.on("provide-data",a=>{const{tasks:i,links:s}=this.getState(),o=i.byId(a.id);o.lazy?(o.lazy=!1,o.open=!0):o.data=[],i.parse(a.data.tasks,a.id),this.setStateAsync({tasks:i,links:new Ar(s.map(c=>c).concat(a.data.links))})}),t.on("zoom-scale",({dir:a,offset:i})=>{const{zoom:s,cellWidth:o,_cellWidth:c,scrollLeft:d}=this.getState(),u=i+d,f=this.calcScaleDate(u);let h=o;a<0&&(h=c||o);const g=h+a*50,v=s.levels[s.level],m=a<0&&o>v.maxCellWidth;if(g<v.minCellWidth||g>v.maxCellWidth||m){if(!this.changeScale(s,a))return}else this.setState({cellWidth:g,_cellWidth:g});const{_scales:w,_start:y,cellWidth:S}=this.getState(),M=Ht(w.minUnit,y),k=w.diff(f,M,"hour");typeof i>"u"&&(i=S);let _=Math.round(k*S)-i;_<0&&(_=0),this.setState({scrollLeft:_,_scaleDate:f,_zoomOffset:i})}),t.on("expand-scale",({minWidth:a})=>{const{_start:i,_scales:s,start:o,end:c,_end:d,cellWidth:u,_scaleDate:f,_zoomOffset:h}=this.getState(),g=Ct(s.minUnit);let v=s.width;if(o&&c){if(v<a&&v){const M=a/v;this.setState({cellWidth:u*M})}return!0}let m=0;for(;v<a;)v+=u,m++;const w=m?c?-m:-1:0,y=o||g(i,w);let S=0;if(f){const M=s.diff(f,y,"hour");S=Math.max(0,Math.round(M*u)-(h||0))}this.setState({_start:y,_end:c||g(d,m),scrollLeft:S})}),t.on("sort-tasks",({key:a,order:i,add:s})=>{const o=this.getState(),{tasks:c}=o;let d=o._sort;const u={key:a,order:i};let f=d?.length||0;f&&s?(d.forEach((h,g)=>{h.key===a&&(f=g)}),d[f]=u):d=[u],c.sort(d),this.setState({_sort:d,tasks:c})}),t.on("hotkey",({key:a,event:i,eventSource:s})=>{switch(a){case"arrowup":case"arrowdown":{const{selected:o,_tasks:c}=this.getState();i.preventDefault();const d=o.length;let u;if(a==="arrowup"?u=d?this.getPrevRow(o[d-1])?.id:c[c.length-1]?.id:u=d?this.getNextRow(o[d-1])?.id:c[0]?.id,u){const f=s==="chart"?"xy":!0;this.in.exec("select-task",{id:u,show:f})}break}case"ctrl+c":{Zt(this,"copy-task",null,null);break}case"ctrl+x":{Zt(this,"cut-task",null,null);break}case"ctrl+v":{Zt(this,"paste-task",null,null);break}case"ctrl+d":case"backspace":{i.preventDefault(),Zt(this,"delete-task",null,null);break}}})}init(e){const t=this.getState().area?{}:{scrollLeft:0,scrollTop:0,area:{from:0,start:0,end:0}};if(e.cellWidth&&(e._cellWidth=e.cellWidth),e._sort=null,Rl()&&(e.unscheduledTasks=!1,e.baselines=!1,e.markers=[]),Array.isArray(e.tasks)&&e.tasks.forEach(r=>mn(r,e.durationUnit)),this._router.init({_scrollTask:null,selected:[],markers:[],autoScale:!0,durationUnit:"day",...t,...e}),e.zoom){const r=Sl(e.zoom,e.scales,e.cellWidth);this.setState({zoom:r._zoom,cellWidth:r.cellWidth,_cellWidth:r.cellWidth,scales:r.scales})}}setState(e,t){return this._router.setState(e,t)}setStateAsync(e){this._router.setStateAsync(e)}getTask(e){const{tasks:t}=this.getState();return t.byId(e)}serialize(){const{tasks:e}=this.getState();return e.serialize()}changeScale(e,t){const r=e.level+t,a=e.levels[r];if(a){const{cellWidth:i,scales:s,_scales:o}=this.getState(),c=pl(e,t,r,a,o.lengthUnit,s,i);return c._cellWidth=c.cellWidth,this.setState(c),!0}return!1}isScheduled(e){return this.getState().unscheduledTasks?e.some(t=>!t.unscheduled||t.data&&this.isScheduled(t.data)):!0}resetSummaryDates(e,t){const{tasks:r}=this.getState(),a=r.byId(e),i=a.data;if(i?.length&&this.isScheduled(i)){const s=kr({...a,start:void 0,end:void 0,duration:void 0});if(!Jt(a.start,s.start)||!Jt(a.end,s.end)){this.in.exec("update-task",{id:e,task:s,eventSource:t});const o=r.getSummaryId(e);o&&this.resetSummaryDates(o,t)}}}moveSummaryKids(e,t,r){const{tasks:a}=this.getState();e.data.forEach(i=>{const s={...a.byId(i.id),start:t(i.start)};s.type!=="milestone"&&(s.end=t(i.end)),delete s.id,this.in.exec("update-task",{id:i.id,task:s,eventSource:r}),i.data?.length&&this.moveSummaryKids(i,t,r)})}calcScaleDate(e){const{_scales:t,_start:r}=this.getState(),a=t.lengthUnit==="day"?t.lengthUnitWidth/24:t.lengthUnitWidth;return Ct("hour")(Ht(t.minUnit,r),Math.floor(e/a))}getNextRow(e){const t=this.getState()._tasks,r=t.findIndex(a=>a.id==e);return t[r+1]}getPrevRow(e){const t=this.getState()._tasks,r=t.findIndex(a=>a.id==e);return t[r-1]}}function Nl(n,e,t,r){if(typeof document>"u")return"";const a=document.createElement("canvas");{const i=Bl(a,n,e,1,t);Fl(i,r,0,n,0,e)}return a.toDataURL()}function Bl(n,e,t,r,a){n.setAttribute("width",(e*r).toString()),n.setAttribute("height",(t*r).toString());const i=n.getContext("2d");return i.translate(-.5,-.5),i.strokeStyle=a,i}function Fl(n,e,t,r,a,i){n.beginPath(),n.moveTo(r,a),n.lineTo(r,i),e==="full"&&n.lineTo(t,i),n.stroke()}function Tr(n){return n.map(e=>{switch(e.data&&Tr(e.data),e.id){case"add-task:before":case"move-task:up":e.check=(t,r)=>!jl(t,r);break;case"move-task:down":e.check=(t,r)=>!ql(t,r);break;case"indent-task:add":e.check=(t,r)=>Ul(t,r)!==t.parent;break;case"indent-task:remove":e.check=t=>!Yl(t);break}return e})}function Yl(n){return n.parent===0}function jl(n,e){return e[0]?.id===n.id}function ql(n,e){return e[e.length-1]?.id===n.id}function Ul(n,e){const t=e.findIndex(r=>r.id===n.id);return e[t-1]?.id??n.parent}const Vl=n=>e=>e.type!==n,Qr=Tr([{id:"add-task",text:"Add",icon:"wxi-plus",data:[{id:"add-task:child",text:"Child task"},{id:"add-task:before",text:"Task above"},{id:"add-task:after",text:"Task below"}]},{type:"separator"},{id:"convert-task",text:"Convert to",icon:"wxi-swap-horizontal",dataFactory:n=>({id:`convert-task:${n.id}`,text:`${n.label}`,check:Vl(n.id)})},{id:"edit-task",text:"Edit",icon:"wxi-edit",subtext:"Ctrl+E"},{id:"cut-task",text:"Cut",icon:"wxi-content-cut",subtext:"Ctrl+X"},{id:"copy-task",text:"Copy",icon:"wxi-content-copy",subtext:"Ctrl+C"},{id:"paste-task",text:"Paste",icon:"wxi-content-paste",subtext:"Ctrl+V"},{id:"move-task",text:"Move",icon:"wxi-swap-vertical",data:[{id:"move-task:up",text:"Up"},{id:"move-task:down",text:"Down"}]},{type:"separator"},{id:"indent-task:add",text:"Indent",icon:"wxi-indent"},{id:"indent-task:remove",text:"Outdent",icon:"wxi-unindent"},{type:"separator"},{id:"delete-task",icon:"wxi-delete",text:"Delete",subtext:"Ctrl+D / BS"}]),Jr=Tr([{id:"add-task",comp:"button",icon:"wxi-plus",text:"New task",type:"primary"},{id:"edit-task",comp:"icon",icon:"wxi-edit",menuText:"Edit",text:"Ctrl+E"},{id:"delete-task",comp:"icon",icon:"wxi-delete",menuText:"Delete",text:"Ctrl+D, Backspace"},{comp:"separator"},{id:"move-task:up",comp:"icon",icon:"wxi-angle-up",menuText:"Move up"},{id:"move-task:down",comp:"icon",icon:"wxi-angle-down",menuText:"Move down"},{comp:"separator"},{id:"copy-task",comp:"icon",icon:"wxi-content-copy",menuText:"Copy",text:"Ctrl+V"},{id:"cut-task",comp:"icon",icon:"wxi-content-cut",menuText:"Cut",text:"Ctrl+X"},{id:"paste-task",comp:"icon",icon:"wxi-content-paste",menuText:"Paste",text:"Ctrl+V"},{comp:"separator"},{id:"indent-task:add",comp:"icon",icon:"wxi-indent",menuText:"Indent"},{id:"indent-task:remove",comp:"icon",icon:"wxi-unindent",menuText:"Outdent"}]),Xl=[{key:"text",comp:"text",label:"Name",config:{placeholder:"Add task name"}},{key:"details",comp:"textarea",label:"Description",config:{placeholder:"Add description"}},{key:"type",comp:"select",label:"Type"},{key:"start",comp:"date",label:"Start date"},{key:"end",comp:"date",label:"End date"},{key:"duration",comp:"counter",label:"Duration",config:{min:1}},{key:"unscheduled",comp:"twostate",label:"",config:{value:!0,text:"Unschedule",textActive:"Schedule"}},{key:"progress",comp:"slider",label:"Progress",config:{min:1,max:100}},{key:"links",comp:"links",label:""}],Kl=[{id:"task",label:"Task"},{id:"summary",label:"Summary task"},{id:"milestone",label:"Milestone"}];new Date().valueOf();function Gl(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in e){const r=n[t],a=e[t];if(!xn(r,a))return!1}return!0}function xn(n,e){if(typeof n=="number"||typeof n=="string"||typeof n=="boolean"||n===null)return n===e;if(typeof n!=typeof e||(n===null||e===null)&&n!==e||n instanceof Date&&e instanceof Date&&n.getTime()!==e.getTime())return!1;if(typeof n=="object")if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let t=n.length-1;t>=0;t--)if(!xn(n[t],e[t]))return!1;return!0}else return Gl(n,e);return n===e}function ar(n){if(typeof n!="object"||n===null)return n;if(n instanceof Date)return new Date(n);if(n instanceof Array)return n.map(ar);const e={};for(const t in n)e[t]=ar(n[t]);return e}const fi=2;class Ql{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,t=0){const r={};return this._wrapProperties(e,this._state,this._values,"",r,t),r}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,t,r,a,i,s){for(const o in e){const c=t[o],d=r[o],u=e[o];if(c&&(d===u&&typeof u!="object"||u instanceof Date&&d instanceof Date&&d.getTime()===u.getTime()))continue;const f=a+(a?".":"")+o;c?(c.__parse(u,f,i,s)&&(r[o]=u),s&fi?i[f]=c.__trigger:c.__trigger()):(u&&u.__reactive?t[o]=this._wrapNested(u,u,f,i):t[o]=this._wrapWritable(u),r[o]=u),i[f]=i[f]||null}}_wrapNested(e,t,r,a){const i=this._wrapWritable(e);return this._wrapProperties(e,i,t,r,a,0),i.__parse=(s,o,c,d)=>(this._wrapProperties(s,i,t,o,c,d),!1),i}_wrapWritable(e){const t=[],r=function(){for(let a=0;a<t.length;a++)t[a](e)};return{subscribe:a=>(t.push(a),this._async?setTimeout(a,1,e):a(e),()=>{const i=t.indexOf(a);i>=0&&t.splice(i,1)}),__trigger:()=>{t.length&&(this._async?setTimeout(r,1):r())},__parse:function(a){return e=a,!0}}}}class Jl{constructor(e,t,r,a){typeof e=="function"?this._setter=e:this._setter=e.setState.bind(e),this._routes=t,this._parsers=r,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(i=>{i.in.forEach(s=>{const o=this._triggers.get(s)||[];o.push(i),this._triggers.set(s,o)}),i.out.forEach(s=>{const o=this._sources.get(s)||{};i.in.forEach(c=>o[c]=!0),this._sources.set(s,o)})}),this._routes.forEach(i=>{i.length=Math.max(...i.in.map(s=>hi(s,this._sources,1)))}),this._bus=a}init(e){const t={};for(const r in e)if(this._prev[r]!==e[r]){const a=this._parsers[r];t[r]=a?a(e[r]):e[r]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(t),this._bus&&this._bus.exec("init-state",t)}setStateAsync(e){const t=this._setter(e,fi);return this._async?Object.assign(this._async.signals,t):this._async={signals:t,timer:setTimeout(this._applyState.bind(this),1)},t}_applyState(){const e=this._async;if(e){this._async=null,this._triggerUpdates(e.signals,[]);for(const t in e.signals){const r=e.signals[t];r&&r()}}}setState(e,t=[]){const r=this._setter(e);return this._triggerUpdates(r,t),r}_triggerUpdates(e,t){const r=Object.keys(e),a=!t.length;t=t||[];for(let i=0;i<r.length;i++){const s=r[i],o=this._triggers.get(s);o&&o.forEach(c=>{t.indexOf(c)==-1&&t.push(c)})}a&&this._execNext(t)}_execNext(e){for(;e.length;){e.sort((r,a)=>r.length<a.length?1:-1);const t=e[e.length-1];e.splice(e.length-1),t.exec(e)}}}function hi(n,e,t){const r=e.get(n);if(!r)return t;const a=Object.keys(r).map(i=>hi(i,e,t+1));return Math.max(...a)}class Zl{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,t,r){let a=this._handlers[e];a?r&&r.intercept?a.unshift(t):a.push(t):a=this._handlers[e]=[t],r&&r.tag&&this._tag.set(t,r.tag)}intercept(e,t,r){this.on(e,t,{...r,intercept:!0})}detach(e){for(const t in this._handlers){const r=this._handlers[t];for(let a=r.length-1;a>=0;a--)this._tag.get(r[a])===e&&r.splice(a,1)}}async exec(e,t){const r=this._handlers[e];if(r)for(let a=0;a<r.length;a++){const i=r[a](t);if(i===!1||i&&i.then&&await i===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}}function $l(n){return e=>e[n]}function ec(n){return(e,t)=>e[n]=t}function Ut(n,e){return(e.getter||$l(e.id))(n)}function Zr(n,e,t){return(e.setter||ec(e.id))(n,t)}function $r(n,e){const t=document.createElement("a");t.href=URL.createObjectURL(n),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function an(n,e){let t=Ut(n,e)??"";return e.template&&(t=e.template(t,n,e)),e.optionsMap&&(Array.isArray(t)?t=t.map(r=>e.optionsMap.get(r)):t=e.optionsMap.get(t)),typeof t>"u"?"":t+""}function tc(n,e){const t=/\n|"|;|,/;let r="";const a=e.rows||`
`,i=e.cols||"	",s=n._columns,o=n.flatData;e.header!==!1&&s[0].header&&(r=ea("header",s,r,i,a));for(let c=0;c<o.length;c++){const d=[];for(let u=0;u<s.length;u++){let f=an(o[c],s[u]);t.test(f)&&(f='"'+f.replace(/"/g,'""')+'"'),d.push(f)}r+=(r?a:"")+d.join(i)}return e.footer!==!1&&s[0].footer&&(r=ea("footer",s,r,i,a)),r}function ea(n,e,t,r,a){const i=/\n|"|;|,/;for(let s=0;s<e[0][n].length;s++){const o=[];for(let c=0;c<e.length;c++){let d=(e[c][n][s].text||"")+"";i.test(d)&&(d='"'+d.replace(/"/g,'""')+'"'),o.push(d)}t+=(t?a:"")+o.join(r)}return t}function nc(n,e,t){const r=[],a=[],i=[];let s=[];const o=n._columns,c=n.flatData,d=n._sizes;for(const f of o)i.push({width:f.flexgrow?d.columnWidth:f.width});let u=0;e.header!==!1&&o[0].header&&(ta("header",o,r,a,u,e,t),s=s.concat(d.headerRowHeights.map(f=>({height:f}))),u+=o[0].header.length);for(let f=0;f<c.length;f++){const h=[];for(let g=0;g<o.length;g++){const v=c[f],m=o[g],w=Ut(v,m)??"";let y=an(v,m),S;e.cellStyle&&(S=e.cellStyle(w,v,m)),e.cellTemplate&&(y=e.cellTemplate(w,v,m)??y);const M=gi(y,2,S,t);h.push(M)}r.push(h),s.push({height:d.rowHeight})}return u+=c.length,e.footer!==!1&&o[0].footer&&(ta("footer",o,r,a,u,e,t),s=s.concat(d.footerRowHeights.map(f=>({height:f})))),{cells:r,merged:a,rowSizes:s,colSizes:i,styles:t}}function ta(n,e,t,r,a,i,s){for(let o=0;o<e[0][n].length;o++){const c=[];for(let d=0;d<e.length;d++){const u=e[d][n][o],f=u.colspan?u.colspan-1:0,h=u.rowspan?u.rowspan-1:0;(f||h)&&r.push({from:{row:o+a,column:d},to:{row:o+a+h,column:d+f}});let g=u.text??"",v;i.headerCellStyle&&(v=i.headerCellStyle(g,u,e[d],n)),i.headerCellTemplate&&(g=i.headerCellTemplate(g,u,e[d],n)??g);let m;n=="header"?o==e[0][n].length-1?m=1:m=0:o?m=4:m=3;const w=gi(g,m,v,s);c.push(w)}t.push(c)}}function gi(n,e,t,r){let a=e;if(n&&n instanceof Date&&(n=ac(n),t=t||{},t.format=t.format||"dd/mm/yyyy"),t){t={...r[e],...t};const i=r.findIndex(s=>xn(s,t));i<0?(r.push(t),a=r.length-1):a=i}return{v:n+"",s:a}}function rc(n){const e={material:"#000000",willow:"#000000","willow-dark":"#ffffff"},t={material:"none",willow:"none","willow-dark":"#2a2b2d"},r={material:"#fafafb",willow:"#f2f3f7","willow-dark":"#20262b"},a={material:"0.5px solid #dfdfdf",willow:"0.5px solid #e6e6e6","willow-dark":"0.5px solid #384047"},i={material:"#dfdfdf",willow:"#e6e6e6","willow-dark":"#384047"},s=e[n],o="0.5px solid "+i[n],c={verticalAlign:"center",align:"left"},d={fontWeight:"bold",color:s,background:r[n],...c,borderBottom:o,borderRight:o};return{cell:{color:s,background:t[n],borderBottom:a[n],borderRight:a[n],...c},header:{...d},footer:{...d}}}function ac(n){return n?25569+(n.getTime()-n.getTimezoneOffset()*6e4)/(86400*1e3):null}const ic="portrait",oc=100,sc="a4",lc={a3:{width:11.7,height:16.5},a4:{width:8.27,height:11.7},letter:{width:8.5,height:11}};function cc(n,e){const t=[];let r=[],a=0;const i=n.filter(o=>!o.hidden),s=dc(e);return i.forEach((o,c)=>{a+o.width<=s?(a+=o.width,r.push(o)):(r.length&&t.push(r),r=[o],a=o.width),c===i.length-1&&r.length&&t.push(r)}),t}function na(n,e,t){const r=[];return n.forEach((a,i)=>{const s=a[e];for(let o=0;o<t.length;o++){r[o]||(r[o]=[]);const c={...s[o]};if(r[o][i]!==null){if(!i&&!c.rowspan&&!c.colspan){let d=1,u=n[i+d][e][o],f=c.width;for(;!u.rowspan&&!u.colspan;)d++,u=n[i+d][e][o],f+=u.width;c.colspan=d,c.width=f,c.height=t[o]}if(r[o].push(c),!c.collapsed&&c.colspan>1){let d=c.colspan-1;if(c.colspan+i>n.length){const u=c.colspan-(c.colspan+i-n.length);c.colspan=u,c.width=n.slice(i,i+d+1).reduce((f,h)=>f+h.width,0),u>1&&(d=u-1)}for(let u=0;u<d;u++)r[o].push(null)}if(c.rowspan>1){const d=c.rowspan;for(let u=1;u<d;u++)r[o+u]||(r[o+u]=[]),r[o+u].push(null)}}}if(a.collapsed)for(let o=0;o<r.length;o++){const c=r[o],d=c[i];if(d&&d.collapsed){if(c[i]=null,!o)break}else{const u=d||c.findLast(f=>f?.colspan>=1);u&&(u.colspan=u.colspan-1,u.width=u.width-a.width)}}}),r.map(a=>a.filter(i=>i&&i.colspan!==0))}function dc(n){const{mode:e,ppi:t,paper:r}=n,{width:a,height:i}=lc[r];return uc(e==="portrait"?a:i,t)}function uc(n,e){return n*e}function fc(n={}){const{mode:e,ppi:t,paper:r}=n;return{mode:e||ic,ppi:t||oc,paper:r||sc}}function vi(n,e){return n.flexgrow?`min-width:${e}px;width:auto`:`width:${n.width}px; max-width:${n.width}px; height:${n.height}px`}function hc(n,e,t){let r=n[t.id];if(t.filter.type==="richselect"&&r){const a=t.filter.config?.options||e.find(({id:i})=>i==t.id).options;a&&(r=a.find(({id:i})=>i==r).label)}return r??""}const ra=["resize-column","hide-column","update-cell"],gc=["delete-row","update-row","update-cell"],vc=["move-item"],mc=["resize-column","move-item"];class wc{undo=[];redo=[];progress={};in;getState;setState;_previousValues={};constructor(e,t,r){this.in=e,this.getState=t,this.setState=r,this.setHandlers(),this.resetStateHistory()}getHandlers(){return{"add-row":{handler:e=>({action:"delete-row",data:{id:e.id},source:{action:"add-row",data:e}})},"delete-row":{handler:e=>{const{id:t}=e,{data:r}=this.getPrev(),a=r.findIndex(i=>i.id==t);return{action:"add-row",data:{id:t,row:r[a],before:a<r.length-1?r[a+1].id:void 0},source:{action:"delete-row",data:e}}}},"update-cell":{handler:e=>{const{id:t,column:r}=e,a=this.getRow(t),i=this.getColumn(r),s=Ut(a,i);return xn(s,e.value)?null:{action:"update-cell",data:{id:t,column:r,value:s},source:{action:"update-cell",data:e}}}},"update-row":{handler:e=>{const{id:t}=e,r=this.getRow(t);return{action:"update-row",data:{id:t,row:r},source:{action:"update-row",data:e}}}},"resize-column":{handler:e=>{const{id:t,width:r}=e,a=this.getColumn(t),{_sizes:i}=this.getState();return{action:"resize-column",data:{id:t,width:a.width??i.columnWidth},source:{action:"resize-column",data:{id:t,width:r}}}}},"hide-column":{handler:e=>{const{id:t}=e,r=this.getColumn(t);return{action:"hide-column",data:{id:t,mode:r.hidden},source:{action:"hide-column",data:e}}}},"collapse-column":{handler:e=>{const{id:t,row:r,mode:a}=e;return{action:"collapse-column",data:{id:t,row:r,mode:typeof a=="boolean"?!a:a},source:{action:"collapse-column",data:e}}}},"move-item":{handler:e=>{const{id:t,target:r,mode:a}=e,{flatData:i}=this.getPrev(),s=i.findIndex(o=>o.id==t);return{action:"move-item",data:{id:t,target:i[s+(s?-1:1)].id,mode:s?"after":"before"},source:{action:"move-item",data:{id:t,target:r,mode:a}}}}},"open-row":{handler:e=>{const{id:t,nested:r}=e;return{action:"close-row",data:{id:t,nested:r},source:{action:"open-row",data:e}}}},"close-row":{handler:e=>{const{id:t,nested:r}=e;return{action:"open-row",data:{id:t,nested:r},source:{action:"close-row",data:e}}}}}}resetHistory(){this.undo=[],this.redo=[],this.progress={},this.resetStateHistory()}getPrev(){return this._previousValues}setHandlers(){const e=this.getHandlers();for(const t in e)this.in.intercept(t,r=>{if(!(r.eventSource==="undo"||r.eventSource==="redo"||r.skipUndo)){if(mc.includes(t)){(r.inProgress&&!this.progress[t]||typeof r.inProgress!="boolean")&&(vc.includes(t)&&this.setPrev("flatData"),ra.includes(t)&&this.setPrev("columns")),this.progress[t]=r.inProgress;return}gc.includes(t)&&this.setPrev("data"),ra.includes(t)&&this.setPrev("columns")}}),this.in.on(t,r=>{if(r.eventSource==="undo"||r.eventSource==="redo"||r.skipUndo||r.inProgress)return;const a=e[t].handler(r);a&&this.addToHistory(a)})}setPrev(e){this._previousValues[e]=ar(this.getState()[e])}addToHistory(e){this.undo.push(e),this.redo=[],this.setStateHistory()}handleUndo(){if(!this.undo.length)return;const e=this.undo.pop();this.redo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"undo"}),this.setStateHistory()}handleRedo(){if(!this.redo.length)return;const e=this.redo.pop();this.undo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"redo"}),this.setStateHistory()}resetStateHistory(){this.setState({history:{undo:0,redo:0}})}setStateHistory(){this.setState({history:{undo:this.undo.length,redo:this.redo.length}})}getRow(e){const{data:t}=this.getPrev();return this.getState().tree?this.getTreeRow(t,e):t.find(r=>r.id==e)}getTreeRow(e,t){for(let r=0;r<e.length;r++){if(e[r].id==t)return e[r];if(e[r].data){const a=this.getTreeRow(e[r].data,t);if(a)return a}}return null}getColumn(e){const{columns:t}=this.getPrev();return t.find(r=>r.id==e)}}function Mr(){let n=!0;return n=!1,n}function mi(n,e){return typeof n>"u"||n===null?-1:typeof e>"u"||e===null?1:n===e?0:n>e?1:-1}function xc(n,e){return-mi(n,e)}function yc(n,e){const t=n==="asc"?mi:xc;return function(r,a){return t(Ut(r,e),Ut(a,e))}}function _c(n,e){if(!n||!n.length)return;const t=n.map(r=>yc(r.order,e.find(a=>a.id==r.key)));return n.length===1?t[0]:function(r,a){for(let i=0;i<t.length;i++){const s=t[i](r,a);if(s!==0)return s}return 0}}const pn=28,kc=20;function bc(){if(typeof document>"u")return"willow";const n=document.querySelector('[class^="wx"][class$="theme"]');return n?n.className.substring(3,n.className.length-6):"willow"}function Hn(n,e,t,r,a){const i=document.createElement("div"),s=document.createElement("div"),o=document.body;a=a?`${a}px`:"auto";let c,d;s.className=e,i.classList.add(`wx-${t}-theme`),i.style.cssText=`height:auto;position:absolute;top:0px;left:100px;overflow:hidden;width=${a};white-space:nowrap;`,i.appendChild(s),o.appendChild(i),typeof n!="object"&&(n=[n]);for(let u=0;u<n.length;u++){s.innerText=n[u]+"";const f=i.getBoundingClientRect(),h=Math.ceil(f.width)+(r&&r.length?r[u]:0),g=Math.ceil(f.height);c=Math.max(c||0,h),d=Math.max(d||0,g)}return i.remove(),{width:c,height:d}}function aa(n,e,t,r,a){const i=[];for(let s=0;s<n.length;s++){const o=n[s][e],c=o.length;for(let d=0;d<c;d++){const{text:u,vertical:f,collapsed:h,rowspan:g,css:v}=o[d];if(!u){i[d]=Math.max(i[d]||0,r);continue}let m=0;if(f&&!h){let w=`wx-measure-cell-${e}`;if(w+=v?` ${v}`:"",m=Hn(u,w,a).width,(g>1||!o[d+1])&&t>d+1){const y=g||t-d,S=i.slice(d,d+y).reduce((M,k)=>M+k,0);if(S<m){const M=Math.ceil((m-S)/y);for(let k=d;k<d+y;k++)i[k]=(i[k]||r)+M}continue}}i[d]=Math.max(i[d]||r,m)}}return i}function Sc(n,e,t){const r=[],a=[];let i="wx-measure-cell-body";i+=n.css?` ${n.css}`:"";for(let s=0;s<e.length;s++){const o=e[s],c=an(o,n);c&&(r.push(c),n.treetoggle?a.push(e[s].$level*pn+(e[s].$count?pn:0)+(n.draggable?pn:0)):n.draggable&&a.push(pn))}return Hn(r,i,t,a).width}function pc(n,e){const t="wx-measure-cell-header",r=n.sort?kc:0;let a=n.header;if(typeof a=="string")return Hn(a,t,e).width+r;let i;Array.isArray(a)||(a=[a]);for(let s=0;s<a.length;s++){const o=a[s],c=typeof o=="string"?o:o.text,d=t+(typeof o=="string"?"":` ${o.css}`);let u=Hn(c,d,e).width;s===a.length-1&&(u+=r),i=Math.max(i||0,u)}return i}const Tc={text:(n,e)=>n?n.toLowerCase().indexOf(e.toLowerCase())!==-1:!e,richselect:(n,e)=>typeof e!="number"&&!e?!0:n==e};function Mc(n){return Tc[n]}class Cc extends Ql{in;_router;_branches;_xlsxWorker;_historyManager;constructor(e){super({writable:e,async:!1});const t={rowHeight:37,columnWidth:160,headerHeight:36,footerHeight:36};this._router=new Jl(super.setState.bind(this),[{in:["columns","sizes","_skin"],out:["_columns","_sizes"],exec:a=>{const{columns:i,sizes:s,_skin:o}=this.getState(),c=this.copyColumns(i),d=c.reduce((h,g)=>Math.max(g.header.length,h),0),u=c.reduce((h,g)=>Math.max(g.footer.length,h),0);c.forEach(this.setCollapsibleColumns);const f=this.normalizeSizes(c,s,d,u,o);c.forEach((h,g)=>{this.normalizeColumns(c,g,"header",d,f),this.normalizeColumns(c,g,"footer",u,f)}),this.setState({_columns:c,_sizes:f},a)}},{in:["data","tree","_filterIds"],out:["flatData"],exec:a=>{const{data:i,tree:s,_filterIds:o}=this.getState(),c=s?this.flattenRows(i,[],o):i.filter(d=>!o||o.includes(d.id));this.setState({flatData:c},a)}}],{sizes:a=>({...t,...a})});const r=this.in=new Zl;r.on("close-editor",({ignore:a})=>{const{editor:i}=this.getState();i&&(a||r.exec("update-cell",i),this.setState({editor:null}))}),r.on("open-editor",({id:a,column:i})=>{let s=this.getState().editor;s&&r.exec("close-editor",{});const o=this.getRow(a),c=i?this.getColumn(i):this.getNextEditor(o);if(c?.editor){let d=c.editor;if(typeof d=="function"&&(d=d(o,c)),!d)return;s={column:c.id,id:a,value:Ut(o,c)??"",renderedValue:an(o,c)},typeof d=="object"&&d.config&&(s.config=d.config,d.config.options&&(s.options=d.config.options)),c.options&&!s.options&&(s.options=c.options),this.setState({editor:s})}}),r.on("editor",({value:a})=>{const i=this.getState().editor;i&&(i.value=a,this.setState({editor:i}))}),r.on("add-row",a=>{const i=this.getState();let{data:s}=i;const{_select:o,_filterIds:c}=i,{row:d,before:u,after:f,select:h}=a;if(a.id=d.id=a.id||d.id||Vn(),u||f){const v=u||f,m=s.findIndex(w=>w.id===v);s.splice(m+(f?1:0),0,a.row),s=[...s]}else s=[...s,a.row];const g={data:s};c&&(g._filterIds=[...c,a.id]),this.setState(g),!(typeof h=="boolean"&&!h)&&(h||o)&&r.exec("select-row",{id:d.id,show:!0})}),r.on("delete-row",a=>{const{data:i,selectedRows:s,focusCell:o}=this.getState(),{id:c}=a,d={data:i.filter(u=>u.id!==c)};this.isSelected(c)&&(d.selectedRows=s.filter(u=>u!==c)),this.setState(d),o?.row===c&&this.in.exec("focus-cell",{eventSource:"delete-row"})}),r.on("update-cell",a=>{const i=this.getState();let{data:s}=i;s=[...s];const{tree:o}=i,{id:c,column:d,value:u}=a,f=this.getColumn(d);if(o){const h={...this._branches[c]};Zr(h,f,u);const g=this.updateTreeRow(h);h.$parent===0&&(s=g)}else{const h=s.findIndex(v=>v.id==c),g={...s[h]};Zr(g,f,u),s[h]=g}this.setState({data:s})}),r.on("update-row",a=>{let{data:i}=this.getState();const{id:s,row:o}=a,c=i.findIndex(d=>d.id==s);i=[...i],i[c]={...i[c],...o},this.setState({data:i})}),r.on("select-row",({id:a,toggle:i,range:s,mode:o,show:c,column:d})=>{const u=this.getState(),{focusCell:f}=u;let{selectedRows:h}=u;if(h.length||(s=i=!1),s){const{data:g}=this.getState();let v=g.findIndex(w=>w.id==h[h.length-1]),m=g.findIndex(w=>w.id==a);v>m&&([v,m]=[m,v]),g.slice(v,m+1).forEach(w=>{h.indexOf(w.id)===-1&&h.push(w.id)})}else if(i&&this.isSelected(a)){if(o===!0)return;h=h.filter(g=>g!==a)}else if(i){if(o===!1)return;h.push(a)}else h=[a];this.setState({selectedRows:h}),f?.row!==a&&this.in.exec("focus-cell",{eventSource:"select-row"}),c&&this.in.exec("scroll",{row:a,column:d})}),this.in.on("focus-cell",a=>{const{row:i,column:s,eventSource:o}=a,{_columns:c,split:d}=this.getState();i&&s?(this.setState({focusCell:{row:i,column:s}}),o!=="click"&&((!d.left||c.findIndex(u=>u.id==a.column)>=d.left)&&(!d.right||c.findIndex(u=>u.id==a.column)<c.length-d.right)?this.in.exec("scroll",{row:i,column:s}):this.in.exec("scroll",{row:i}))):this.setState({focusCell:null})}),r.on("resize-column",a=>{const{id:i,auto:s,maxRows:o,inProgress:c}=a;if(c===!1)return;let d=a.width||0;const u=[...this.getState().columns],f=u.find(h=>h.id==i);if(s){if(s=="data"||s===!0){const{flatData:h,_skin:g}=this.getState();let v=h.length;o&&(v=Math.min(o,v));const m=h.slice(0,v);d=Sc(f,m,g)}if(s=="header"||s===!0){const{_skin:h}=this.getState();d=Math.max(pc(f,h),d)}}f.width=Math.max(17,d),delete f.flexgrow,this.setState({columns:u})}),r.on("hide-column",a=>{const{id:i,mode:s}=a,o=[...this.getState().columns],c=o.find(u=>u.id==i),d=o.reduce((u,f)=>u+(f.hidden?0:1),0);!s||d>1?(c.hidden=!c.hidden,this.setState({columns:o})):a.skipUndo=!0}),r.on("sort-rows",a=>{const{key:i,add:s}=a;let{order:o="asc"}=a;const c=this.getState();let d=c.sortMarks;const{columns:u,data:f,tree:h}=c,g=Object.keys(d),v=g.length;d[i]&&(o=d[i].order==="asc"?"desc":"asc"),!s||!v||v===1&&d[i]?d={[i]:{order:o}}:(v===1&&(d[g[0]]={...d[g[0]],index:0}),d={...d,[i]:{order:o,index:d[i]?.index??v}});const m=Object.keys(d).sort((y,S)=>d[y].index-d[S].index).map(y=>({key:y,order:d[y].order}));this.setState({sortMarks:d});const w=_c(m,u);if(w){const y=[...f];h?this.sortTree(y,w):y.sort(w),this.setState({data:y})}}),r.on("filter-rows",a=>{const{value:i,key:s,filter:o}=a;if(!Object.keys(a).length){this.setState({filterValues:{},_filterIds:null});return}const c=this.getState(),{data:d,tree:u}=c;let f=c.filterValues;const h={};s&&(f={...f,[s]:i},h.filterValues=f);const g=o??this.createFilter(f);let v=[];u?v=this.filterTree(d,g,v):d.forEach(m=>{g(m)&&v.push(m.id)}),h._filterIds=v,this.setState(h)}),r.on("collapse-column",a=>{const{id:i,row:s,mode:o}=a,c=[...this.getState().columns],d=this.getColumn(i).header,u=Array.isArray(d)?d[s]:d;typeof u=="object"&&(u.collapsed=o??!u.collapsed,this.setState({columns:c}))}),r.on("move-item",a=>{const{id:i,target:s,mode:o="after",inProgress:c}=a,{data:d,flatData:u,tree:f}=this.getState(),h=u.findIndex(m=>m.id==i),g=u.findIndex(m=>m.id==s);if(h===-1||g===-1||c===!1)return;let v;f?v=this.moveItem(i,s,d,o):v=this.moveItem(i,s,d,o),this.setState({data:f?this.normalizeTreeRows(v):v})}),r.on("open-row",a=>{const{id:i,nested:s}=a;this.toggleBranch(i,!0,s)}),r.on("close-row",a=>{const{id:i,nested:s}=a;this.toggleBranch(i,!1,s)}),r.on("export",a=>new Promise((i,s)=>{const o=a.options||{},c=`${o.fileName||"data"}.${o.format}`;if(o.format=="csv"){const d=tc(this.getState(),o);o.download!==!1?$r(new Blob(["\uFEFF"+d],{type:"text/csv"}),c):a.result=d,i(!0)}else if(o.format=="xlsx"){let d=o.styles;!d&&d!==!1&&(d=rc(this.getState()._skin));const u=d,f=u?[{...u.header},{...u.lastHeaderCell||u.header},{...u.cell},{...u.firstFooterCell||u.footer},{...u.footer}]:Array(5).fill({}),{cells:h,merged:g,rowSizes:v,colSizes:m,styles:w}=nc(this.getState(),o,f),y=o.cdn||"https://cdn.dhtmlx.com/libs/json2excel/1.3.2/worker.js";this.getXlsxWorker(y).then(S=>{S.onmessage=M=>{if(M.data.type=="ready"){const k=M.data.blob;o.download!==!1?$r(k,c):a.result=k,i(!0)}},S.postMessage({type:"convert",data:{data:[{name:o.sheetName||"data",cells:h,cols:m,rows:v,merged:g}],styles:w}})})}else s()})),r.on("hotkey",({key:a,event:i,isInput:s})=>{switch(a){case"arrowup":{const{flatData:o,focusCell:c,_select:d}=this.getState();if(i.preventDefault(),s)return;const u=c?c.column:this._getFirstVisibleColumn()?.id,f=c?this.getPrevRow(c.row)?.id:o[o.length-1]?.id;u&&f&&(this.in.exec("focus-cell",{row:f,column:u,eventSource:"key"}),d&&this.in.exec("select-row",{id:f}));break}case"arrowdown":{const{flatData:o,focusCell:c,_select:d}=this.getState();if(i.preventDefault(),s)return;const u=c?c.column:this._getFirstVisibleColumn()?.id,f=c?this.getNextRow(c.row)?.id:o[0]?.id;u&&f&&(this.in.exec("focus-cell",{row:f,column:u,eventSource:"key"}),d&&this.in.exec("select-row",{id:f}));break}case"arrowright":{const{focusCell:o}=this.getState();if(s)return;if(i.preventDefault(),o){const c=this.getNextColumn(o.column,!0)?.id;c&&this.in.exec("focus-cell",{row:o.row,column:c,eventSource:"key"})}break}case"arrowleft":{const{focusCell:o}=this.getState();if(s)return;if(i.preventDefault(),o){const c=this.getPrevColumn(o.column,!0)?.id;c&&this.in.exec("focus-cell",{row:o.row,column:c,eventSource:"key"})}break}case"tab":{const{editor:o,focusCell:c,_select:d}=this.getState();if(o){i.preventDefault();const u=o.column;let f=o.id,h=this.getNextEditor(this.getRow(f),this.getColumn(u));if(!h){const g=this.getNextRow(f);g&&(f=g.id,h=this.getNextEditor(g))}h&&(this.in.exec("open-editor",{id:f,column:h.id}),this.in.exec("focus-cell",{row:f,column:h.id,eventSource:"key"}),d&&!this.isSelected(f)&&this.in.exec("select-row",{id:f}))}else c&&this.in.exec("focus-cell",{eventSource:"key"});break}case"shift+tab":{const{editor:o,focusCell:c,_select:d}=this.getState();if(o){i.preventDefault();const u=o.column;let f=o.id,h=this.getPrevEditor(this.getRow(f),this.getColumn(u));if(!h){const g=this.getPrevRow(f);g&&(f=g.id,h=this.getPrevEditor(g))}h&&(this.in.exec("open-editor",{id:f,column:h.id}),this.in.exec("focus-cell",{row:f,column:h.id,eventSource:"key"}),d&&!this.isSelected(f)&&this.in.exec("select-row",{id:f}))}else c&&this.in.exec("focus-cell",{eventSource:"key"});break}case"escape":{const{editor:o}=this.getState();o&&(this.in.exec("close-editor",{ignore:!0}),this.in.exec("focus-cell",{row:o.id,column:o.column,eventSource:"key"}));break}case"f2":{const{editor:o,focusCell:c}=this.getState();!o&&c&&this.in.exec("open-editor",{id:c.row,column:c.column});break}case"enter":{const{focusCell:o,tree:c}=this.getState();if(!s&&c&&o&&this.getColumn(o.column).treetoggle){const d=this.getRow(o.row);if(!d.data)return;this.in.exec(d.open?"close-row":"open-row",{id:o.row,nested:!0})}break}case"home":{const{editor:o,focusCell:c}=this.getState();if(!o&&c){i.preventDefault();const d=this._getFirstVisibleColumn()?.id;this.in.exec("focus-cell",{row:c.row,column:d,eventSource:"key"})}break}case"ctrl+home":{const{editor:o,focusCell:c,flatData:d,_select:u}=this.getState();if(!o&&c){i.preventDefault();const f=d[0]?.id,h=this._getFirstVisibleColumn()?.id;f&&h&&(this.in.exec("focus-cell",{row:f,column:h,eventSource:"key"}),u&&!this.isSelected(f)&&this.in.exec("select-row",{id:f}))}break}case"end":{const{editor:o,focusCell:c}=this.getState();if(!o&&c){i.preventDefault();const d=this._getLastVisibleColumn()?.id,u=c.row;this.in.exec("focus-cell",{row:u,column:d,eventSource:"key"})}break}case"ctrl+end":{const{editor:o,focusCell:c,flatData:d,_select:u}=this.getState();if(!o&&c){i.preventDefault();const f=d.at(-1).id,h=this._getLastVisibleColumn()?.id;f&&h&&(this.in.exec("focus-cell",{row:f,column:h,eventSource:"key"}),u&&!this.isSelected(f)&&this.in.exec("select-row",{id:f}))}break}case"ctrl+z":{this.in.exec("undo",{});break}case"ctrl+y":{this.in.exec("redo",{});break}}}),r.on("scroll",a=>{const{_columns:i,split:s,_sizes:o,flatData:c,dynamic:d}=this.getState();let u=-1,f=-1,h=0;if(a.column){u=0;const g=i.findIndex(v=>v.id==a.column);h=i[g].width;for(let v=s.left??0;v<g;v++){const m=i[v];m.hidden||(u+=m.width)}}if(a.row&&!d){const g=c.findIndex(v=>v.id===a.row);g>=0&&(f=o.rowHeight*g)}this.setState({scroll:{top:f,left:u,width:h,height:o.rowHeight}})}),r.on("print",a=>{const i=fc(a);this.setState({_print:i}),this.setStateAsync({_print:null})}),r.on("undo",()=>{this._historyManager?.handleUndo()}),r.on("redo",()=>{this._historyManager?.handleRedo()}),this.initOnce()}getXlsxWorker(e){if(!this._xlsxWorker){const t=window.URL.createObjectURL(new Blob([`importScripts('${e}');`],{type:"text/javascript"}));this._xlsxWorker=new Promise(r=>{const a=new Worker(t);a.addEventListener("message",i=>{i.data.type==="init"&&r(a)})})}return this._xlsxWorker}initOnce(){const e={sortMarks:{},_filterIds:null,data:[],filterValues:{},scroll:null,editor:null,focusCell:null,_print:null,history:{undo:0,redo:0}};this._router.init(e)}init(e){e.hasOwnProperty("_skin")&&!e._skin&&(e._skin=bc()),e.columns&&e.columns.forEach(t=>{t.options&&(t.optionsMap=new Map(t.options.map(r=>[r.id,r.label])))}),xn(this.getState().data,e.data)||(e.tree?(this._branches={0:{data:e.data}},e.data=this.normalizeTreeRows(e.data)):e.data=this.normalizeRows(e.data),this.setState({_filterIds:null,filterValues:{},sortMarks:{}}),this._historyManager&&this._historyManager.resetHistory()),Mr()&&(e.tree&&(e.undo=!1),e.split?.right&&(e.split.right=0)),e.undo&&!this._historyManager&&(this._historyManager=new wc(this.in,this.getState.bind(this),this.setState.bind(this))),this._router.init({...e})}setState(e,t){return this._router.setState(e,t)}setStateAsync(e){this._router.setStateAsync(e)}getRow(e){const{tree:t}=this.getState();return t?this._branches[e]:this.getState().data.find(r=>r.id==e)}getRowIndex(e,t){return t||(t=this.getState().flatData),t.findIndex(r=>r.id==e)}getNextRow(e){const t=this.getState().flatData,r=this.getRowIndex(e,t);return t[r+1]}getPrevRow(e){const t=this.getState().flatData,r=this.getRowIndex(e,t);return t[r-1]}getColumn(e){return this.getState().columns.find(t=>t.id==e)}getNextColumn(e,t){const r=this.getState()._columns,a=r.findIndex(i=>i.id==e);return t?this._getFirstVisibleColumn(a+1):r[a+1]}getPrevColumn(e,t){const r=this.getState()._columns,a=r.findIndex(i=>i.id==e);return t?this._getLastVisibleColumn(a-1):r[a-1]}_getFirstVisibleColumn(e){const t=this.getState()._columns;let r=e??0;for(;r<t.length&&(t[r]?.hidden||t[r]?.collapsed);)r++;return t[r]}_getLastVisibleColumn(e){const t=this.getState()._columns;let r=e??t.length-1;for(;r<t.length&&(t[r]?.hidden||t[r]?.collapsed);)r--;return t[r]}isCellEditable(e,t){const{editor:r,hidden:a}=t;return!r||a?!1:typeof r=="function"?r(e,t):!0}getNextEditor(e,t){let r=this.getState().columns;if(t){const a=r.findIndex(i=>i.id==t.id);r=r.slice(a+1)}return r.find(a=>this.isCellEditable(e,a))}getPrevEditor(e,t){let r=this.getState().columns;if(t){const a=r.findLastIndex(i=>i.id==t.id);r=r.slice(0,a)}return r.findLast(a=>this.isCellEditable(e,a))}toggleBranch(e,t,r){let a=this._branches[e],{data:i}=this.getState();if(i=[...i],e!==0){a={...a,open:t};const s=this.updateTreeRow(a);a.$parent===0&&(i=s)}r&&a.data?.length&&a.data.forEach(s=>{const o=this.toggleKids(s,t,r);e===0&&(i=o)}),this.setState({data:i})}toggleKids(e,t,r){e={...e,open:t};const a=this.updateTreeRow(e);return r&&e.data?.length&&e.data.forEach(i=>{this.toggleKids(i,t,r)}),a}updateTreeRow(e){const t=e.id;this._branches[t]=e;const r=this._branches[e.$parent],a=r.data.findIndex(i=>i.id==t);return r.data=[...r.data],r.data[a]=e,r.data}isSelected(e){return this.getState().selectedRows.indexOf(e)!==-1}findAndRemove(e,t){for(let r=0;r<e.length;r++){if(e[r].id==t)return e.splice(r,1)[0];if(e[r].data){const a=[...e[r].data],i=this.findAndRemove(a,t);if(i)return e[r]={...e[r],data:a},i}}return null}insertItem(e,t,r,a){for(let i=0;i<e.length;i++){if(e[i].id==t){const s=e[i],o=a==="before"?i:i+1;if(s.data){if(a==="before"){const c=i>0?e[i-1]:null;return c?.data&&c.open?e[i-1]={...c,data:[...c.data,r]}:e.splice(o,0,r),!0}else if(s.open)return e[i]={...s,data:[r,...s.data]},!0}return e.splice(o,0,r),!0}if(e[i].data&&(e[i]={...e[i],data:[...e[i].data]},this.insertItem(e[i].data,t,r,a)))return!0}return!1}moveItem(e,t,r,a){const i=[...r],s=this.findAndRemove(i,e);return this.insertItem(i,t,s,a),i}copyColumns(e){const t=[];return e.forEach(r=>{const a={...r};this.copyHeaderFooter(a,"header"),this.copyHeaderFooter(a,"footer"),t.push(a)}),t}copyHeaderFooter(e,t){let r=e[t];r=Array.isArray(r)?[...r]:[r],r.forEach((a,i)=>{r[i]=typeof a=="string"?{text:a}:{...a}}),e[t]=r}setCollapsibleColumns(e,t,r){let a=e.header;for(let i=0;i<a.length;i++){const s=a[i];if(s.collapsible&&s.collapsed){if(s.collapsible!=="first"){e.collapsed=!0,e.width=36,s.vertical=!0;const c=a.length-i;a=a.slice(0,i+1),a[i].rowspan=c}const o=s.colspan;if(o){const c=a[i+1];let d=1;c&&c.colspan&&!c.collapsed&&(d=c.colspan);for(let u=d;u<o;u++){const f=r[t+u];f&&(f.hidden=!0)}}}}}normalizeColumns(e,t,r,a,i){const s=e[t];s.width||(s.width=s.flexgrow?17:i.columnWidth),s._colindex=t+1;const o=s[r],c=i[`${r}RowHeights`];for(let d=0;d<a;d++){const u=o[d];u.id=s.id,d===o.length-1&&(u.rowspan=u.rowspan?Math.min(u.rowspan,a-d):a-d);for(let f=1;f<u.rowspan;f++){o.splice(d+f,0,{_hidden:!0});for(let h=1;h<u.colspan;h++)e[t+h][r].splice(d+f,0,{})}if(u.rowspan){const f=(u.rowspan===a?c:c.slice(d,u.rowspan+d)).reduce((h,g)=>h+g,0);u.height=f,d+u.rowspan!=a&&u.height--}if(u.colspan){let f=s.width,h=s.flexgrow||0;const g=u.colspan;for(let v=1;v<g;v++){const m=e[t+v];m&&(m.hidden?u.colspan-=1:m.flexgrow?h+=m.flexgrow:f+=m.width||i.columnWidth),h?u.flexgrow=h:u.width=f}}else u.width=s.width,u.flexgrow=s.flexgrow;r==="header"&&u.filter&&typeof u.filter=="string"&&(u.filter={type:u.filter})}o.length>a&&(o.length=a),s[r]=o}normalizeRows(e){return e.forEach(t=>{t.id||(t.id=Vn())}),e}normalizeTreeRows(e,t,r){return e.forEach(a=>{a.id||(a.id=Vn()),a.$level=t||0,a.$parent=r||0,this._branches[a.id]=a,a.data&&(a.data.length?(a.$count=a.data.length,this.normalizeTreeRows(a.data,a.$level+1,a.id)):(delete a.data,delete a.$count,delete a.open))}),e}sortTree(e,t){e.sort(t),e.forEach(r=>{r.data&&this.sortTree(r.data,t)})}filterTree(e,t,r){return e.forEach(a=>{t(a)&&r.push(a.id),a.data&&this.filterTree(a.data,t,r)}),r}flattenRows(e,t,r){const a=t;return e.forEach(i=>{(!r||r.includes(i.id))&&a.push(i),i.data?.length&&i.open!==!1&&this.flattenRows(i.data,a,r)}),a}createFilter(e){const{_columns:t}=this.getState(),r=[];for(const a in e){const{config:i,type:s}=t.find(c=>c.id==a).header.find(c=>c.filter).filter,o=e[a];r.push(c=>i?.handler?i.handler(c[a],o):Mc(s)(c[a],o))}return a=>{for(let i=0;i<r.length;i++)if(!r[i](a))return!1;return!0}}normalizeSizes(e,t,r,a,i){const s=aa(e,"header",r,t.headerHeight,i),o=aa(e,"footer",a,t.footerHeight,i),c=s.reduce((u,f)=>u+f,0),d=o.reduce((u,f)=>u+f,0);return{...t,headerRowHeights:s,footerRowHeights:o,headerHeight:c,footerHeight:d}}}let Ec=new Date().valueOf();function Vn(){return"temp://"+Ec++}function Dc(n,e="data-id"){let t=n;for(!t.tagName&&n.target&&(t=n.target);t;){if(t.getAttribute&&t.getAttribute(e))return t;t=t.parentNode}return null}new Date().valueOf();function Cr(n,{keys:e,exec:t}){for(const a in e){const i=a.toLowerCase().replace(/ /g,"");i!==a&&(e[i]=e[a])}function r(a){let i=a.code.replace("Key","").toLowerCase();i===" "&&(i="space");const s=`${a.ctrlKey||a.metaKey?"ctrl+":""}${a.shiftKey?"shift+":""}${a.altKey?"alt+":""}${i.replace(/^key/,"")}`,o=e[s];if(typeof o<"u"){const c=a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA"||Dc(a.target,"data-header-id")?.classList.contains("wx-filter")||!!a.target.closest(".wx-cell.wx-editor");typeof o=="function"?o({key:s,event:a,node:n,isInput:c}):o&&t({key:s,event:a,node:n,isInput:c})}}return n.addEventListener("keydown",r),{destroy:()=>{n.removeEventListener("keydown",r)}}}function Ic(n,e){let t=null;e.scroll.subscribe(r=>{if(!r||r===t)return;t=r;const{left:a,top:i,height:s,width:o}=r,c=e.getHeight(),d=e.getWidth(),u=e.getScrollMargin();if(i>=0){const f=n.scrollTop;i<f?n.scrollTop=i:i+s>f+c&&(n.scrollTop=i-c+s)}if(a>=0){const f=n.scrollLeft;a<f?n.scrollLeft=a:a+o>f+d-u&&(n.scrollLeft=a-d+o+u)}})}var Wc=P("<div> </div>"),Hc=P('<div class="wx-row svelte-nufjbd"></div>'),Rc=P('<div class="wx-scale svelte-nufjbd"></div>');function Pc(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(o,"$scales",t),i=()=>ae(c,"$scrollLeft",t),s=Ae("gantt-store"),{_scales:o,scrollLeft:c}=s.getReactiveState();var d=Rc();Ge(d,5,()=>a().rows,gt,(u,f)=>{var h=Hc();Ge(h,21,()=>l(f).cells,gt,(g,v)=>{var m=Wc(),w=Y(m,!0);L(m),j(y=>{ye(m,1,`wx-cell ${l(v).css??""} ${y??""}`,"svelte-nufjbd"),Te(m,`width:${l(v).width??""}px`),Me(w,l(v).value)},[()=>e.highlightTime?e.highlightTime(l(v).date,l(v).unit):""]),b(g,m)}),L(h),j(()=>Te(h,`height:${l(f).height??""}px`)),b(u,h)}),L(d),j(()=>Te(d,`width:${a().width??""}px;left:${-i()}px`)),b(n,d),he(),r()}function xt(n,e="data-id"){let t=n;for(!t.tagName&&n.target&&(t=n.target);t;){if(t.getAttribute&&t.getAttribute(e))return t;t=t.parentNode}return null}function ir(n,e="data-id"){const t=xt(n,e);return t?t.getAttribute(e):null}function Bn(n,e="data-id"){const t=xt(n,e);return t?yn(t.getAttribute(e)):null}function yn(n){if(typeof n=="string"){const e=n*1;if(!isNaN(e))return e}return n}function Lc(){return{detect:()=>!0,addEvent:function(n,e,t){return n.addEventListener(e,t),()=>n.removeEventListener(e,t)},addGlobalEvent:function(n,e){return document.addEventListener(n,e),()=>document.removeEventListener(n,e)},getTopNode:function(){return window.document.body}}}const Ot=Lc();function wi(n){Object.assign(Ot,n)}function ia(n,e,t){function r(a){const i=xt(a);if(!i)return;const s=yn(i.dataset.id);if(typeof e=="function")return e(s,a);let o,c=a.target;for(;c!=i;){if(o=c.dataset?c.dataset.action:null,o&&e[o]){e[o](s,a);return}c=c.parentNode}e[t]&&e[t](s,a)}Ot.addEvent(n,t,r)}function zc(n,e){ia(n,e,"click"),e.dblclick&&ia(n,e.dblclick,"dblclick")}function Ac(n,e){for(let t=n.length-1;t>=0;t--)if(n[t]===e){n.splice(t,1);break}}let xi=new Date,Rn=!1,Tn=[];const qt=[],oa=n=>{if(Rn){Rn=!1;return}for(let e=qt.length-1;e>=0;e--){const{node:t,date:r,props:a}=qt[e];if(!(r>xi)&&!t.contains(n.target)&&t!==n.target&&(a.callback&&a.callback(n),a.modal||n.defaultPrevented))break}},Oc=n=>{xi=new Date,Rn=!0;for(let e=qt.length-1;e>=0;e--){const{node:t}=qt[e];if(!t.contains(n.target)&&t!==n.target){Rn=!1;break}}};function Er(n,e){Tn.length||(Tn=[Ot.addGlobalEvent("click",oa,n),Ot.addGlobalEvent("contextmenu",oa,n),Ot.addGlobalEvent("mousedown",Oc,n)]),typeof e!="object"&&(e={callback:e});const t={node:n,date:new Date,props:e};return qt.push(t),{destroy(){Ac(qt,t),qt.length||(Tn.forEach(r=>r()),Tn=[])}}}const Nc=n=>n.indexOf("bottom")!==-1,Bc=n=>n.indexOf("left")!==-1,sa=n=>n.indexOf("right")!==-1,Fc=n=>n.indexOf("top")!==-1,la=n=>n.indexOf("fit")!==-1,ca=n=>n.indexOf("overlap")!==-1,Yc=n=>n.indexOf("center")!==-1;function jc(n,e){let t=0;const r=Ot.getTopNode(n);for(;n&&n!==r;){const a=getComputedStyle(n).position;if((a==="absolute"||a==="relative"||a==="fixed")&&(t=parseInt(getComputedStyle(n).zIndex)||0),n=n.parentNode,n===e)break}return t}let ft,At,cn,Mt;function qc(n,e,t="bottom",r=0,a=0){if(!n)return null;ft=r,At=a,cn="auto";let i=0,s=0;const o=Uc(n),c=ca(t)?Ot.getTopNode(n):o;if(!o)return null;const d=o.getBoundingClientRect(),u=n.getBoundingClientRect(),f=c.getBoundingClientRect();if(e){const v=jc(e,o);i=Math.max(v+1,20)}if(e){if(Mt=e.getBoundingClientRect(),la(t)&&(cn=Mt.width+"px"),t!=="point")if(Yc(t))la(t)?ft=0:(ft=f.width/2,s=1),At=(f.height-u.height)/2;else{const v=ca(t)?0:1;ft=sa(t)?Mt.right+v:Mt.left-v,At=Nc(t)?Mt.bottom+1:Mt.top}}else Mt={left:r,right:r,top:a,bottom:a};Bc(t)&&(ft=Mt.left,s=2),Fc(t)&&(At=Mt.top-u.height);const h=At+u.height-f.bottom;return h>0&&(At-=h),ft+u.width-f.right>0&&(sa(t)?s=2:ft=f.right-u.width),s&&(ft=Math.round(ft-u.width*s/2)),ft<0&&(t!=="left"?ft=0:ft=Mt.right),ft+=c.scrollLeft-d.left,At+=c.scrollTop-d.top,cn=cn||"auto",{x:ft,y:At,z:i,width:cn}}function Uc(n){const e=Ot.getTopNode(n);for(n&&(n=n.parentElement);n;){const t=getComputedStyle(n).position;if(n===e||t==="relative"||t==="absolute"||t==="fixed")return n;n=n.parentNode}return null}let da=new Date().valueOf();function Vc(){return da+=1,da}function ht(n){return n<10?"0"+n:n.toString()}function Xc(n){const e=ht(n);return e.length==2?"0"+e:e}function Kc(n){let e=n.getDay();e===0&&(e=7);const t=new Date(n.valueOf());t.setDate(n.getDate()+(4-e));const r=t.getFullYear(),a=Math.floor((t.getTime()-new Date(r,0,1).getTime())/864e5);return 1+Math.floor(a/7)}const ua=["",""];function Gc(n,e,t){switch(n){case"%d":return ht(e.getDate());case"%m":return ht(e.getMonth()+1);case"%j":return e.getDate();case"%n":return e.getMonth()+1;case"%y":return ht(e.getFullYear()%100);case"%Y":return e.getFullYear();case"%D":return t.dayShort[e.getDay()];case"%l":return t.dayFull[e.getDay()];case"%M":return t.monthShort[e.getMonth()];case"%F":return t.monthFull[e.getMonth()];case"%h":return ht((e.getHours()+11)%12+1);case"%g":return(e.getHours()+11)%12+1;case"%G":return e.getHours();case"%H":return ht(e.getHours());case"%i":return ht(e.getMinutes());case"%a":return((e.getHours()>11?t.pm:t.am)||ua)[0];case"%A":return((e.getHours()>11?t.pm:t.am)||ua)[1];case"%s":return ht(e.getSeconds());case"%S":return Xc(e.getMilliseconds());case"%W":return ht(Kc(e));case"%c":{let r=e.getFullYear()+"";return r+="-"+ht(e.getMonth()+1),r+="-"+ht(e.getDate()),r+="T",r+=ht(e.getHours()),r+=":"+ht(e.getMinutes()),r+=":"+ht(e.getSeconds()),r}default:return n}}const Qc=/%[a-zA-Z]/g;function Jc(n,e){return typeof n=="function"?n:function(t){return t?(t.getMonth||(t=new Date(t)),n.replace(Qc,r=>Gc(r,t,e))):""}}function fa(n){return n&&typeof n=="object"&&!Array.isArray(n)}function or(n,e){for(const t in e){const r=e[t];fa(n[t])&&fa(r)?n[t]=or({...n[t]},e[t]):n[t]=e[t]}return n}function Dr(n){return{getGroup(e){const t=n[e];return r=>t&&t[r]||r},getRaw(){return n},extend(e,t){if(!e)return this;let r;return t?r=or({...e},n):r=or({...n},e),Dr(r)}}}function hn(n){const e=n.getAttribute("data-id"),t=parseInt(e);return isNaN(t)||t.toString()!=e?e:t}function Zc(n,e,t){const r=n.getBoundingClientRect(),a=e.querySelector(".wx-body").getBoundingClientRect();return{top:r.top-a.top,left:r.left-a.left,dt:r.bottom-t.clientY,db:t.clientY-r.top}}function ha(n){return n&&n.getAttribute("data-context-id")}const ga=5;function $c(n,e){let t,r,a,i,s,o,c,d,u;function f(x){i=x.clientX,s=x.clientY,o={...Zc(t,n,x),y:e.getTask(a).$y},document.body.style.userSelect="none"}function h(x){t=xt(x),ha(t)&&(a=hn(t),u=setTimeout(()=>{d=!0,e&&e.touchStart&&e.touchStart(),f(x.touches[0])},500),n.addEventListener("touchmove",S),n.addEventListener("contextmenu",g),window.addEventListener("touchend",M))}function g(x){if(d||u)return x.preventDefault(),!1}function v(x){x.which===1&&(t=xt(x),ha(t)&&(a=hn(t),n.addEventListener("mousemove",y),window.addEventListener("mouseup",k),f(x)))}function m(x){n.removeEventListener("mousemove",y),n.removeEventListener("touchmove",S),document.body.removeEventListener("mouseup",k),document.body.removeEventListener("touchend",M),document.body.style.userSelect="",x&&(n.removeEventListener("mousedown",v),n.removeEventListener("touchstart",h))}function w(x){const T=x.clientX-i,z=x.clientY-s;if(!r){if(Math.abs(T)<ga&&Math.abs(z)<ga||e&&e.start&&e.start({id:a,e:x})===!1)return;r=t.cloneNode(!0),r.style.pointerEvents="none",r.classList.add("wx-reorder-task"),r.style.position="absolute",r.style.left=o.left+"px",r.style.top=o.top+"px",t.style.visibility="hidden",t.parentNode.insertBefore(r,t)}if(r){const p=Math.round(Math.max(0,o.top+z));if(e&&e.move&&e.move({id:a,top:p,detail:c})===!1)return;const C=e.getTask(a),H=C.$y;if(!o.start&&o.y==H)return _();o.start=!0,o.y=C.$y-4,r.style.top=p+"px";const N=document.elementFromPoint(x.clientX,x.clientY),F=xt(N);if(F&&F!==t){const A=hn(F),X=F.getBoundingClientRect(),ue=X.top+X.height/2,ne=x.clientY+o.db>ue&&F.nextElementSibling!==t,oe=x.clientY-o.dt<ue&&F.previousElementSibling!==t;c?.after==A||c?.before==A?c=null:ne?c={id:a,after:A}:oe&&(c={id:a,before:A})}}}function y(x){w(x)}function S(x){d?(x.preventDefault(),w(x.touches[0])):u&&(clearTimeout(u),u=null)}function M(){d=null,u&&(clearTimeout(u),u=null),_()}function k(){_()}function _(){t&&(t.style.visibility=""),r&&(r.parentNode.removeChild(r),e&&e.end&&e.end({id:a,top:o.top})),a=t=r=o=c=null,m()}return n.style.position!=="absolute"&&(n.style.position="relative"),n.addEventListener("mousedown",v),n.addEventListener("touchstart",h),{destroy(){m(!0)}}}const ed={grid:{"Add before":"Add before","Add after":"Add after",Copy:"Copy",Delete:"Delete"}};function td(n,e){const t=new ResizeObserver(r=>{requestAnimationFrame(()=>e(r[0].contentRect))});return t.observe(n.parentNode),{destroy(){t.disconnect()}}}const va=5,nd=700;function rd(n){return yn(n.getAttribute("data-id"))}function Cn(n){const e=n.getBoundingClientRect(),t=document.body,r=e.top+t.scrollTop-t.clientTop||0,a=e.left+t.scrollLeft-t.clientLeft||0;return{y:Math.round(r),x:Math.round(a),width:n.offsetWidth,height:n.offsetHeight}}function sr(n,e){const t=Cn(e);return{x:n.clientX-t.x,y:n.clientY-t.y}}function ad(n,e){let t=null,r,a,i=!1,s=!1;const o=document.createElement("DIV");o.className="wx-drag-zone",o.setAttribute("tabindex",-1);function c(){clearTimeout(r),r=null}function d(x){const T=xt(x);T&&(t={container:o,sourceNode:x.target,from:rd(T),pos:sr(x,n)},a=t.pos,u(x))}function u(x){if(!t)return;const T=t.pos=sr(x,n);if(!i){if(!s&&!x?.target?.getAttribute("draggable-data")&&Math.abs(a.x-T.x)<va&&Math.abs(a.y-T.y)<va)return;if(k(x)===!1)return _()}if(s){const z=window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft,p=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop;t.targetNode=document.elementFromPoint(x.pageX-z,x.pageY-p)}else t.targetNode=x.target;e?.move&&e.move(x,t),o.style.left=-(t.offset?t.offset.x:0)+"px",o.style.top=t.pos.y+(t.offset?t.offset.y:0)+"px"}function f(x){o.parentNode&&o.parentNode.removeChild(o),o.innerHTML="",i&&e?.end&&e.end(x,t),t=a=null,_()}function h(x){e?.getReorder()&&x.button===0&&(M(x),window.addEventListener("mousemove",g),window.addEventListener("mouseup",v),d(x))}function g(x){u(x)}function v(x){f(x)}function m(x){if(!e?.getReorder())return;r=setTimeout(()=>{s=!0,d(x.touches[0])},nd),M(x);function T(){r&&c(),x.target.removeEventListener("touchmove",w),x.target.removeEventListener("touchend",T),f(x)}x.target.addEventListener("touchmove",w),x.target.addEventListener("touchend",T),n.addEventListener("contextmenu",y)}function w(x){i?(x.preventDefault(),u(x.touches[0])):r&&c()}function y(x){if(i||r)return x.preventDefault(),!1}function S(x){x.preventDefault()}function M(x){const{hasDraggable:T}=e.getDraggableInfo();(!T||x.target.getAttribute("draggable-data"))&&(document.body.style.userSelect="none",document.body.style.webkitUserSelect="none")}function k(x){if(i=!0,e?.start){if(e.start(x,t)===!1)return!1;n.appendChild(o),document.body.style.cursor="move"}}function _(x){i=s=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.style.webkitUserSelect="",window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",v),x&&(n.removeEventListener("mousedown",h),n.removeEventListener("touchstart",m),n.removeEventListener("dragstart",S))}return n.addEventListener("mousedown",h),n.addEventListener("touchstart",m),n.addEventListener("dragstart",S),{destroy(){_(!0)}}}const id=.004;function od(){return{dirX:0,dirY:0,scrollSpeedFactor:1}}function sd(n,e,t,r){const{node:a,left:i,top:s,bottom:o,sense:c,xScroll:d,yScroll:u}=r,f=sr(n,a);t.scrollState||(t.scrollState=od());let h=0,g=0;f.x<i+c?h=-1:f.x>e.width-c&&(h=1),f.y<s+Math.round(c/2)?g=-1:f.y>e.height-o-Math.round(c/2)&&(g=1),(t.scrollState.dirX!==h||t.scrollState.dirY!==g)&&(yi(t),t.scrollState.dirX=h,t.scrollState.dirY=g),(d&&t.scrollState.dirX!==0||u&&t.scrollState.dirY!==0)&&ld(t,r,{x:t.scrollState.dirX,y:t.scrollState.dirY})}function ld(n,e,t){n.autoScrollTimer||(n.autoScrollTimer=setTimeout(()=>{n.activeAutoScroll=setInterval(cd,15,n,e,t)},250))}function yi(n){n.scrollSpeedFactor=1,n.autoScrollTimer&&(n.autoScrollTimer=clearTimeout(n.autoScrollTimer),n.activeAutoScroll=clearInterval(n.activeAutoScroll))}function cd(n,e,t){const{x:r,y:a}=t;n.scrollSpeedFactor+=id,r!==0&&ud(n,e,r),a!==0&&dd(n,e,a)}function dd(n,e,t){const r=e.node.scrollTop;_i(r+Math.round(e.sense/3)*n.scrollSpeedFactor*t,"scrollTop",e)}function ud(n,e,t){const r=e.node.scrollLeft;_i(r+Math.round(e.sense/3)*n.scrollSpeedFactor*t,"scrollLeft",e)}function _i(n,e,t){t.node[e]=n}function fd(n){return{tab:!0,"shift+tab":!0,arrowup:!0,arrowdown:!0,arrowright:!0,arrowleft:!0,enter:!0,escape:!0,f2:!0,home:!0,end:!0,"ctrl+home":!0,"ctrl+end":!0,"ctrl+z":n.undo,"ctrl+y":n.undo}}function Fn(n,e,t,r,a,i){const s=n?`width:${n}px;`:"",o=n?`min-width:${n}px;`:"",c=e?`flex-grow:${e};`:"",d=i?`height:${i}px;`:"";let u="";return t&&(t.left&&(u=`position:sticky;left:${r}px;`),t.right&&(u=`position:sticky;right:${a}px;`)),`${o}${s}${d}${c}${u}`}function ki(n,e,t){let r="";if(n.fixed)for(const a in n.fixed)r+=n.fixed[a]===-1?"wx-shadow ":"wx-fixed ";return r+=e.rowspan>1?"wx-rowspan ":"",r+=e.colspan>1?"wx-colspan ":"",r+=e.vertical?"wx-vertical ":"",r+=t?t(n)+" ":"",r}var hd=P('<i draggable-data="true" class="wx-draggable wxi-drag svelte-1wkb0jq"></i>'),gd=P('<i class="wx-draggable-stub svelte-1wkb0jq"></i>'),vd=P('<i data-action="toggle-row"></i>'),md=P("<span></span> <!>",1),wd=P("<div><!> <!> <!></div>");function xd(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(f,"$focusCell",t);let i=E(e,"cellStyle",3,null),s=E(e,"columnStyle",3,null),o=E(e,"focusable",7),c=D(()=>Fn(e.column.width,e.column.flexgrow,e.column.fixed,e.column.left,e.column.right)),d=D(()=>v(s(),i()));const u=Ae("grid-store"),{focusCell:f}=u.getReactiveState(),h=D(()=>typeof e.column.draggable=="function"?e.column.draggable(e.row,e.column)!==!1:e.column.draggable);let g;Ve(()=>{const p=a()?.row===e.row.id&&a()?.column===e.column.id;g&&o()&&p&&g.focus()});function v(p,C){let H="wx-cell";return H+=e.column.fixed?" "+(e.column.fixed===-1?"wx-shadow":"wx-fixed"):"",H+=p?" "+p(e.column):"",H+=C?" "+C(e.row,e.column):"",H+=e.column.treetoggle?" wx-tree-cell":"",H}function m(){o()&&!a()&&u.exec("focus-cell",{row:e.row.id,column:e.column.id,eventSource:"focus"})}go(()=>{o()&&a()&&(u.exec("focus-cell",{eventSource:"destroy"}),o(!1))});var w=wd();let y;De(w,"role","gridcell");var S=Y(w);{var M=p=>{var C=Z(),H=q(C);{var N=A=>{var X=hd();b(A,X)},F=A=>{var X=gd();b(A,X)};B(H,A=>{l(h)?A(N):A(F,!1)})}b(p,C)};B(S,p=>{e.reorder&&e.column.draggable&&p(M)})}var k=le(S,2);{var _=p=>{var C=md(),H=q(C),N=le(H,2);{var F=A=>{var X=vd();j(()=>ye(X,1,`wx-table-tree-toggle wxi-menu-${e.row.open!==!1?"down":"right"}`,"svelte-1wkb0jq")),b(A,X)};B(N,A=>{e.row.$count&&A(F)})}j(()=>Te(H,`margin-left:${e.row.$level*28}px;`)),b(p,C)};B(k,p=>{e.column.treetoggle&&p(_)})}var x=le(k,2);{var T=p=>{var C=Z(),H=q(C);tt(H,()=>e.column.cell,(N,F)=>{F(N,{get api(){return u},get row(){return e.row},get column(){return e.column},onaction:({action:A,data:X})=>u.exec(A,X)})}),b(p,C)},z=p=>{var C=Z(),H=q(C);{var N=A=>{var X=Z(),ue=q(X);ct(ue,()=>e.children),b(A,X)},F=A=>{var X=wt();j(ue=>Me(X,ue),[()=>an(e.row,e.column)]),b(A,X)};B(H,A=>{e.children?A(N):A(F,!1)},!0)}b(p,C)};B(x,p=>{e.column.cell?p(T):p(z,!1)})}L(w),Xe(w,p=>g=p,()=>g),j(p=>{y=ye(w,1,wn(l(d)),"svelte-1wkb0jq",y,p),Te(w,l(c)),De(w,"data-row-id",e.row.id),De(w,"data-col-id",e.column.id),De(w,"tabindex",o()?"0":"-1"),De(w,"aria-colindex",e.column._colindex),De(w,"aria-readonly",e.column.editor?void 0:!0)},[()=>({"wx-shadow":e.column.fixed&&e.column.fixed.left===-1||e.column.fixed.right===-1,"wx-fixed-right":e.column.fixed&&e.column.fixed.right})]),Et("focus",w,m),b(n,w),he(),r()}function yd(n,e){let t,r;function a(o){t=o.clientX,n.style.opacity=1,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",i),window.addEventListener("mouseup",s),e&&e.down&&e.down(n)}function i(o){r=o.clientX-t,e&&e.move&&e.move(r)}function s(){n.style.opacity="",document.body.style.cursor="",document.body.style.userSelect="",e&&e.up&&e.up(r),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",s)}return n.addEventListener("mousedown",a),{destroy(){n.removeEventListener("mousedown",a)}}}function _d(n,e){fe(e,!0);function t({value:r}){e.action({value:r,key:e.column.id})}Da(n,mt(()=>e.filter.config??{},{get value(){return e.filterValue},onchange:t})),he()}function kd(n){n.key!=="Tab"&&n.preventDefault()}var bd=P('<div style="width:100%;"><!></div>');function Sd(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(s,"$data",t),i=Ae("grid-store"),{flatData:s}=i.getReactiveState();let o=D(()=>e.filter?.config?.options||e.column.options||d(a())),c=D(()=>e.filter?.config?.template);function d(){const g=[];return a().forEach(v=>{const m=Ut(v,e.column);g.includes(m)||g.push(m)}),g.map(v=>({id:v,label:v}))}function u({value:g}){e.action({value:g,key:e.column.id})}var f=bd();f.__keydown=[kd];var h=Y(f);Ia(h,mt({placeholder:"",clear:!0},()=>e.filter.config??{},{get options(){return l(o)},get value(){return e.filterValue},onchange:u,children:(v,m=Vt)=>{var w=Z(),y=q(w);{var S=k=>{var _=wt();j(x=>Me(_,x),[()=>l(c)(m())]),b(k,_)},M=k=>{var _=wt();j(()=>Me(_,m().label)),b(k,_)};B(y,k=>{l(c)?k(S):k(M,!1)})}b(v,w)},$$slots:{default:!0}})),L(f),b(n,f),he(),r()}je(["keydown"]);const pd={text:_d,richselect:Sd};function Td(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(s,"$filterValues",t),i=Ae("grid-store"),{filterValues:s}=i.getReactiveState();function o(f){i.exec("filter-rows",f)}const c=D(()=>pd[e.filter.type]);var d=Z(),u=q(d);tt(u,()=>l(c),(f,h)=>{h(f,{get filter(){return e.filter},get column(){return e.column},action:o,get filterValue(){return a()[e.column.id]}})}),b(n,d),he(),r()}function ma(n,e){n.key==="Enter"&&e()}function Md(n,e,t){n.key==="Enter"&&!e.cell.filter&&t(n)}var Cd=P('<div role="button" tabindex="0"><div class="wx-text svelte-1m17ldm"> </div></div>'),Ed=P('<div class="wx-collapse svelte-1m17ldm" role="button" tabindex="0"><i></i></div>'),Dd=P('<div class="wx-text svelte-1m17ldm"> </div>'),Id=n=>n.stopPropagation(),Wd=P('<div class="wx-grip svelte-1m17ldm" role="presentation" aria-label="Resize column"><div class="svelte-1m17ldm"></div></div>'),Hd=P('<div class="wx-order svelte-1m17ldm"> </div>'),Rd=P("<!> <i></i>",1),Pd=P('<div class="wx-sort svelte-1m17ldm"><!></div>'),Ld=P('<div role="columnheader"><!> <!> <!> <!></div>');function zd(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(s,"$sortMarks",t),i=Ae("grid-store"),{sortMarks:s}=i.getReactiveState();let o,c=D(()=>a()[e.column.id]);function d(p){o=e.cell.flexgrow?p.parentNode.clientWidth:e.cell.width}function u(p){h(p,!0)}function f(p){h(p,!1)}function h(p,C){i.exec("resize-column",{id:e.cell.id,width:Math.max(1,o+p),inProgress:C})}function g(p){!e.column.sort||e.cell.filter||i.exec("sort-rows",{key:e.cell.id,add:p.ctrlKey})}function v(p){p&&p.stopPropagation(),i.exec("collapse-column",{id:e.cell.id,row:e.row})}let m=D(()=>e.cell.collapsed&&e.column.collapsed),w=D(()=>l(m)&&!e.hasSplit&&e.cell.collapsible!=="header"),y=D(()=>l(w)?`top:-${e.bodyHeight/2}px;position:absolute;`:""),S=D(()=>Fn(e.cell.width,e.cell.flexgrow,e.column.fixed,e.column.left,e.cell.right??e.column.right,e.cell.height+(l(m)&&l(w)?e.bodyHeight:0)));const M=D(()=>ki(e.column,e.cell,e.columnStyle));function k(){return Object.fromEntries(Object.entries(e.cell).filter(([p])=>p!=="cell"))}var _=Z(),x=q(_);{var T=p=>{var C=Cd();C.__keydown=[ma,v],C.__click=v;var H=Y(C),N=Y(H,!0);L(H),L(C),j(()=>{ye(C,1,`wx-cell ${l(M)??""} ${(e.cell.css||"")??""} wx-collapsed`,"svelte-1m17ldm"),Te(C,l(S)),De(C,"aria-label",`Expand column ${e.cell.text||""}`),De(C,"aria-expanded",!e.cell.collapsed),De(C,"data-header-id",e.column.id),Te(H,l(y)),Me(N,e.cell.text||"")}),b(p,C)},z=p=>{var C=Ld();let H;C.__click=g,C.__keydown=[Md,e,g];var N=Y(C);{var F=U=>{var ce=Ed();ce.__keydown=[ma,v],ce.__click=v;var me=Y(ce);L(ce),j(()=>{De(ce,"aria-label",e.cell.collapsed?"Expand column":"Collapse column"),De(ce,"aria-expanded",!e.cell.collapsed),ye(me,1,`wxi-angle-${e.cell.collapsed?"down":"right"}`,"svelte-1m17ldm")}),b(U,ce)};B(N,U=>{e.cell.collapsible&&U(F)})}var A=le(N,2);{var X=U=>{var ce=Z(),me=q(ce);{let Ie=D(k);tt(me,()=>e.cell.cell,(We,we)=>{we(We,{get api(){return i},get cell(){return l(Ie)},get column(){return e.column},get row(){return e.row},onaction:({action:He,data:Se})=>i.exec(He,Se)})})}b(U,ce)},ue=U=>{var ce=Z(),me=q(ce);{var Ie=we=>{Td(we,{get filter(){return e.cell.filter},get column(){return e.column}})},We=we=>{var He=Dd(),Se=Y(He,!0);L(He),j(()=>Me(Se,e.cell.text||"")),b(we,He)};B(me,we=>{e.cell.filter?we(Ie):we(We,!1)},!0)}b(U,ce)};B(A,U=>{e.cell.cell?U(X):U(ue,!1)})}var ne=le(A,2);{var oe=U=>{var ce=Wd();ce.__click=[Id],vt(ce,(me,Ie)=>yd?.(me,Ie),()=>({down:d,move:u,up:f})),b(U,ce)};B(ne,U=>{e.column.resize&&e.lastRow&&!e.cell._hidden&&U(oe)})}var $=le(ne,2);{var J=U=>{var ce=Pd(),me=Y(ce);{var Ie=We=>{var we=Rd(),He=q(we);{var Se=ee=>{var pe=Hd(),G=Y(pe,!0);L(pe),j(()=>Me(G,l(c).index+1)),b(ee,pe)};B(He,ee=>{typeof l(c).index<"u"&&ee(Se)})}var qe=le(He,2);j(()=>ye(qe,1,`wxi-arrow-${l(c).order==="asc"?"up":"down"}`,"svelte-1m17ldm")),b(We,we)};B(me,We=>{l(c)&&We(Ie)})}L(ce),b(U,ce)};B($,U=>{e.sortRow&&U(J)})}L(C),j(U=>{H=ye(C,1,`wx-cell ${l(M)??""} ${(e.cell.css||"")??""}`,"svelte-1m17ldm",H,U),Te(C,l(S)),De(C,"data-header-id",e.column.id),De(C,"tabindex",!e.cell._hidden&&e.column.sort&&!e.cell.filter?"0":void 0),De(C,"aria-colindex",e.cell._colindex),De(C,"aria-colspan",e.cell.colspan>1?e.cell.colspan:void 0),De(C,"aria-rowspan",e.cell.rowspan>1?e.cell.rowspan:void 0),De(C,"aria-sort",!l(c)?.order||e.cell.filter?"none":l(c)?.order==="asc"?"ascending":"descending")},[()=>({"wx-filter":e.cell.filter,"wx-fixed-right":e.column.fixed&&e.column.fixed.right})]),b(p,C)};B(x,p=>{l(m)?p(T):p(z,!1)})}b(n,_),he(),r()}je(["keydown","click"]);var Ad=P('<div class="wx-text svelte-aecvi5"> </div>'),Od=P("<div><!></div>");function Nd(n,e){fe(e,!0);const t=Ae("grid-store");let r=D(()=>Fn(e.cell.width,e.cell.flexgrow,e.column.fixed,e.column.left,e.cell.right??e.column.right,e.cell.height)),a=D(()=>ki(e.column,e.cell,e.columnStyle));function i(){return Object.fromEntries(Object.entries(e.cell).filter(([u])=>u!=="cell"))}var s=Od();let o;var c=Y(s);{var d=u=>{var f=Z(),h=q(f);{var g=m=>{var w=Z(),y=q(w);{let S=D(i);tt(y,()=>e.cell.cell,(M,k)=>{k(M,{get api(){return t},get cell(){return l(S)},get column(){return e.column},get row(){return e.row},onaction:({action:_,data:x})=>t.exec(_,x)})})}b(m,w)},v=m=>{var w=Ad(),y=Y(w,!0);L(w),j(()=>Me(y,e.cell.text||"")),b(m,w)};B(h,m=>{e.cell.cell?m(g):m(v,!1)})}b(u,f)};B(c,u=>{!e.column.collapsed&&!e.cell.collapsed&&u(d)})}L(s),j(u=>{o=ye(s,1,`wx-cell ${l(a)??""} ${(e.cell.css||"")??""}`,"svelte-aecvi5",o,u),Te(s,l(r))},[()=>({"wx-fixed-right":e.column.fixed&&e.column.fixed.right})]),b(n,s),he()}var Bd=P('<div role="row"></div>'),Fd=P('<div role="rowgroup"></div>');function wa(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(c,"$sizes",t),i=()=>ae(d,"$split",t);let s=E(e,"type",3,"header");const o=Ae("grid-store"),{_sizes:c,split:d}=o.getReactiveState();let u=D(()=>a()[`${s()}RowHeights`]),f=D(()=>{let y=[];if(e.columns.length){const S=e.columns[0][s()].length;for(let M=0;M<S;M++){let k=0;y.push([]),e.columns.forEach((_,x)=>{const T={..._[s()][M]};if(k||y[M].push(T),T.colspan>1){if(k=T.colspan-1,!Mr()&&_.right){let z=_.right;for(let p=1;p<T.colspan;p++)z-=e.columns[x+p].width;T.right=z}}else k&&k--})}}return y});const h=D(()=>i()?.left||i()?.right);function g(y){return e.columns.find(S=>S.id===y)}function v(y,S){return y.rowspan&&(S+=y.rowspan-1),S===l(f).length-1}function m(y,S,M){if(!M.sort)return!1;for(let k=l(f).length-1;k>=0;k--){const _=M.header[k];if(!_.filter&&!_._hidden)return S===k}return v(y,S)}var w=Fd();Ge(w,21,()=>l(f),gt,(y,S,M)=>{var k=Bd();Ge(k,21,()=>l(S),_=>_.id,(_,x)=>{const T=D(()=>g(l(x).id));var z=Z(),p=q(z);{var C=N=>{{let F=D(()=>v(l(x),M)),A=D(()=>m(l(x),M,l(T)));zd(N,{get cell(){return l(x)},get columnStyle(){return e.columnStyle},get column(){return l(T)},row:M,get lastRow(){return l(F)},get bodyHeight(){return e.bodyHeight},get sortRow(){return l(A)},get hasSplit(){return l(h)}})}},H=N=>{{let F=D(()=>g(l(x).id));Nd(N,{get cell(){return l(x)},get columnStyle(){return e.columnStyle},get column(){return l(F)},row:M})}};B(p,N=>{s()==="header"?N(C):N(H,!1)})}b(_,z)}),L(k),j(()=>{ye(k,1,wn(s()==="header"?"wx-h-row":"wx-f-row")),Te(k,`height:${l(u)[M]??""}px; display: flex`)}),b(y,k)}),L(w),j(()=>{ye(w,1,`wx-${s()}`,"svelte-f3sbch"),Te(w,`padding-left:${e.deltaLeft??""}px;width:${e.contentWidth??""}px;`)}),b(n,w),he(),r()}var Yd=P('<div class="wx-overlay svelte-zjaxrx"><!></div>');function jd(n,e){fe(e,!0);const t=Ae("grid-store");function r(c){return typeof c=="function"}var a=Yd(),i=Y(a);{var s=c=>{const d=D(()=>e.overlay);var u=Z(),f=q(u);tt(f,()=>l(d),(h,g)=>{g(h,{onaction:({action:v,data:m})=>t.exec(v,m)})}),b(c,u)},o=c=>{var d=wt();j(()=>Me(d,e.overlay)),b(c,d)};B(i,c=>{r(e.overlay)?c(s):c(o,!1)})}L(a),b(n,a),he()}function qd(n,e,t,r){O(e,l(t).value,!0),r.actions.updateValue(l(t).value)}function Ud({key:n},e){n==="Enter"&&e.actions.save()}var Vd=P('<input class="wx-text svelte-1a713m7" type="text"/>');function Xd(n,e){fe(e,!0);let t=Q(Ze(e.editor.value||"")),r=Q(void 0);Rt(()=>l(r).focus());var a=Vd();Ra(a),a.__input=[qd,t,r,e],a.__keydown=[Ud,e],Xe(a,i=>O(r,i),()=>l(r)),j(()=>vo(a,l(t))),b(n,a),he()}je(["input","keydown"]);var Kd=(n,e,t)=>l(e)(n,l(t)),Gd=P('<input class="wx-input svelte-1s4pc76"/> <!>',1);function Qd(n,e){fe(e,!0);let t=e.editor,r=Ze(t.value),a=Q(Ze(t.renderedValue)),i=Q(Ze(t.options)),s=e.editor?.config||{},o=Ze(s.template),c=Ze(s.cell),d=D(()=>l(i).findIndex(M=>M.id===r));function u({id:M}){e.actions.updateValue(M),e.actions.save()}let f,h=Q(void 0);function g(M){f=M.navigate,O(h,M.keydown,!0),f(l(d))}function v(){O(i,l(a)?e.editor.options.filter(M=>M.label.toLowerCase().includes(l(a).toLowerCase())):e.editor.options,!0),l(i).length?f(-1/0):f(null)}let m=Q(void 0);Rt(()=>{l(m).focus()});var w=Gd(),y=q(w);Ra(y),y.__input=v,y.__keydown=[Kd,h,d],Xe(y,M=>O(m,M),()=>l(m));var S=le(y,2);Wa(S,{get items(){return l(i)},onready:g,onselect:u,children:(k,_)=>{let x=()=>_?.().option;var T=Z(),z=q(T);{var p=H=>{var N=wt();j(F=>Me(N,F),[()=>o(x())]),b(H,N)},C=H=>{var N=Z(),F=q(N);{var A=ue=>{const ne=D(()=>c);var oe=Z(),$=q(oe);tt($,()=>l(ne),(J,U)=>{U(J,{get data(){return x()},get onaction(){return e.onaction}})}),b(ue,oe)},X=ue=>{var ne=wt();j(()=>Me(ne,x().label)),b(ue,ne)};B(F,ue=>{c?ue(A):ue(X,!1)},!0)}b(H,N)};B(z,H=>{o?H(p):H(C,!1)})}b(k,T)},$$slots:{default:!0}}),mo(y,()=>l(a),M=>O(a,M)),b(n,w),he()}je(["input","keydown"]);var Jd=(n,e)=>e.actions.cancel(),Zd=n=>n.preventDefault(),$d=P('<span class="wx-text svelte-1eq9nh5"> </span>'),eu=P('<div class="wx-value svelte-1eq9nh5" tabindex="0"><!></div> <!>',1);function tu(n,e){fe(e,!0);let t=Ze(e.editor.value||new Date),r=Ze(e.editor.config?.template),a=Ze(e.editor.config?.cell);function i({value:g}){e.actions.updateValue(g),e.actions.save()}let s;Rt(()=>{s.focus(),window.getSelection&&window.getSelection().removeAllRanges()});var o=eu(),c=q(o);c.__click=[Jd,e],c.__keydown=[Zd];var d=Y(c);{var u=g=>{var v=wt();j(m=>Me(v,m),[()=>r(t)]),b(g,v)},f=g=>{var v=Z(),m=q(v);{var w=S=>{const M=D(()=>a);var k=Z(),_=q(k);tt(_,()=>l(M),(x,T)=>{T(x,{get data(){return e.editor.value},get onaction(){return e.onaction}})}),b(S,k)},y=S=>{var M=$d(),k=Y(M,!0);L(M),j(()=>Me(k,e.editor.renderedValue)),b(S,M)};B(m,S=>{a?S(w):S(y,!1)},!0)}b(g,v)};B(d,g=>{r?g(u):g(f,!1)})}L(c),Xe(c,g=>s=g,()=>s);var h=le(c,2);dr(h,{width:"auto",children:(g,v)=>{{let m=D(()=>e.editor.config?.buttons);eo(g,{get value(){return t},onchange:i,get buttons(){return l(m)}})}},$$slots:{default:!0}}),b(n,o),he()}je(["click","keydown"]);var nu=(n,e)=>e.actions.cancel(),ru=(n,e,t)=>{l(e)(n,l(t)),n.preventDefault()},au=P('<span class="wx-text svelte-z4gexz"> </span>'),iu=P('<div class="wx-value svelte-z4gexz" tabindex="0"><!></div> <!>',1);function ou(n,e){fe(e,!0);let t=Ze(e.editor.options.find(_=>_.id===e.editor.value)),r=e.editor,a=Ze(r.value),i=Ze(r.options),s=e.editor?.config||{},o=Ze(s.template),c=Ze(s.cell),d=D(()=>i.findIndex(_=>_.id===a));function u({id:_}){e.actions.updateValue(_),e.actions.save()}let f,h=Q(void 0);function g(_){f=_.navigate,O(h,_.keydown,!0),f(l(d))}let v=Q(void 0);Rt(()=>{l(v).focus(),window&&window.getSelection&&window.getSelection().removeAllRanges()});var m=iu(),w=q(m);w.__click=[nu,e],w.__keydown=[ru,h,d];var y=Y(w);{var S=_=>{var x=wt();j(T=>Me(x,T),[()=>o(t)]),b(_,x)},M=_=>{var x=Z(),T=q(x);{var z=C=>{const H=D(()=>c);var N=Z(),F=q(N);tt(F,()=>l(H),(A,X)=>{X(A,{get data(){return t},get onaction(){return e.onaction}})}),b(C,N)},p=C=>{var H=au(),N=Y(H,!0);L(H),j(()=>Me(N,e.editor.renderedValue)),b(C,H)};B(T,C=>{c?C(z):C(p,!1)},!0)}b(_,x)};B(y,_=>{o?_(S):_(M,!1)})}L(w),Xe(w,_=>O(v,_),()=>l(v));var k=le(w,2);Wa(k,{get items(){return i},onready:g,onselect:u,children:(x,T)=>{let z=()=>T?.().option;var p=Z(),C=q(p);{var H=F=>{var A=wt();j(X=>Me(A,X),[()=>o(z())]),b(F,A)},N=F=>{var A=Z(),X=q(A);{var ue=oe=>{const $=D(()=>c);var J=Z(),U=q(J);tt(U,()=>l($),(ce,me)=>{me(ce,{get data(){return z()},get onaction(){return e.onaction}})}),b(oe,J)},ne=oe=>{var $=wt();j(()=>Me($,z().label)),b(oe,$)};B(X,oe=>{c?oe(ue):oe(ne,!1)},!0)}b(F,A)};B(C,F=>{o?F(H):F(N,!1)})}b(x,p)},$$slots:{default:!0}}),b(n,m),he()}je(["click","keydown"]);const su={text:Xd,combo:Qd,datepicker:tu,richselect:ou};function lu(n,e,t,r){n.key==="Enter"&&e()&&r()}var cu=n=>n.stopPropagation(),du=n=>n.stopPropagation(),uu=P('<div class="wx-cell wx-editor svelte-sntz6" tabindex="-1"><!></div>');function fu(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(s,"$editor",t),i=Ae("grid-store"),{editor:s}=i.getReactiveState();function o(m){const w=m?null:{row:a().id,column:a().column};u(!1,w)}function c(){u(!0,{row:a().id,column:a().column})}function d(m){i.exec("editor",{value:m})}function u(m,w){i.exec("close-editor",{ignore:m}),w&&i.exec("focus-cell",{...w,eventSource:"click"})}let f=D(()=>Fn(e.column.width,e.column.flexgrow,e.column.fixed,e.column.left,e.column.right));const h=D(()=>{let m=e.column.editor;typeof m=="function"&&(m=m(e.row,e.column));let w=typeof m=="string"?m:m.type;return su[w]});var g=uu();g.__click=[cu],g.__dblclick=[du],g.__keydown=[lu,a,s,c];var v=Y(g);tt(v,()=>l(h),(m,w)=>{w(m,{get editor(){return a()},actions:{save:o,cancel:c,updateValue:d},onaction:({action:y,data:S})=>i.exec(y,S)})}),L(g),vt(g,(m,w)=>Er?.(m,w),()=>()=>o(!0)),j(()=>{Te(g,l(f)),De(g,"role",typeof e.row.$parent<"u"?"gridcell":"cell"),De(g,"aria-readonly",typeof e.row.$parent<"u"?!e.column.editor:void 0)}),b(n,g),he(),r()}je(["click","dblclick","keydown"]);var hu=P('<div class="wx-print-filter"> </div>'),gu=P('<div class="wx-text"> </div>'),vu=P("<th><!></th>"),mu=P("<tr></tr>");function xa(n,e){fe(e,!0);const t=Ae("grid-store"),{filterValues:r,_columns:a,_sizes:i}=t.getState();function s(d){return e.columnStyle?" "+e.columnStyle(d):""}var o=Z(),c=q(o);Ge(c,17,()=>e.columns,gt,(d,u,f)=>{var h=mu();Ge(h,21,()=>l(u),g=>g.id,(g,v)=>{const m=D(()=>a.find(_=>_.id==l(v).id));var w=vu();let y;var S=Y(w);{var M=_=>{var x=Z(),T=q(x);{let z=D(()=>Object.fromEntries(Object.entries(l(v)).filter(([p])=>p!=="cell")));tt(T,()=>l(v).cell,(p,C)=>{C(p,{get api(){return t},get cell(){return l(z)},get column(){return l(m)},row:f})})}b(_,x)},k=_=>{var x=Z(),T=q(x);{var z=C=>{var H=hu(),N=Y(H,!0);L(H),j(F=>Me(N,F),[()=>hc(r,a,l(v))]),b(C,H)},p=C=>{var H=gu(),N=Y(H,!0);L(H),j(()=>Me(N,l(v).text??"")),b(C,H)};B(T,C=>{l(v).filter?C(z):C(p,!1)},!0)}b(_,x)};B(S,_=>{l(v).cell?_(M):_(k,!1)})}L(w),j((_,x,T)=>{Te(w,_),y=ye(w,1,`wx-print-cell-${e.type??""} ${x??""}`,null,y,T),De(w,"rowspan",l(v).rowspan),De(w,"colspan",l(v).colspan)},[()=>vi(l(v),i.columnWidth),()=>s(l(m)),()=>({"wx-print-cell-filter":l(v).filter,"wx-vertical":l(v).vertical})]),b(g,w)}),L(h),b(d,h)}),b(n,o),he()}var wu=P("<thead><!></thead>"),xu=P('<i class="wxi-drag"></i>'),yu=P('<span class="wx-print-draggable"><!></span>'),_u=P("<i></i>"),ku=P("<span></span> <!>",1),bu=P("<span> </span>"),Su=P("<td><!> <!> <!></td>"),pu=P("<tr></tr>"),Tu=P("<tfoot><!></tfoot>"),Mu=P("<table><!><tbody></tbody><!></table>");function Cu(n,e){fe(e,!0);const t=Ae("grid-store"),{flatData:r,_sizes:a}=t.getState(),i=e.header&&na(e.columns,"header",a.headerRowHeights),s=e.footer&&na(e.columns,"footer",a.footerRowHeights);function o(w,y){let S="";return S+=e.columnStyle?" "+e.columnStyle(y):"",S+=e.cellStyle?" "+e.cellStyle(w,y):"",S}function c(w,y){return typeof y.draggable=="function"?y.draggable(w,y)!==!1:y.draggable}var d=Mu();let u;var f=Y(d);{var h=w=>{var y=wu(),S=Y(y);xa(S,{get columns(){return i},type:"header",get columnStyle(){return e.columnStyle}}),L(y),b(w,y)};B(f,w=>{e.header&&w(h)})}var g=le(f);Ge(g,21,()=>r,gt,(w,y)=>{var S=pu();Ge(S,21,()=>e.columns,M=>M.id,(M,k)=>{var _=Z(),x=q(_);{var T=z=>{var p=Su(),C=Y(p);{var H=ne=>{var oe=yu(),$=Y(oe);{var J=U=>{var ce=xu();b(U,ce)};B($,U=>{c(l(y),l(k))&&U(J)})}L(oe),b(ne,oe)};B(C,ne=>{e.reorder&&l(k).draggable&&ne(H)})}var N=le(C,2);{var F=ne=>{var oe=ku(),$=q(oe),J=le($,2);{var U=ce=>{var me=_u();j(()=>ye(me,1,`wx-print-grid-tree-toggle wxi-menu-${l(y).open!==!1?"down":"right"}`)),b(ce,me)};B(J,ce=>{l(y).$count&&ce(U)})}j(()=>Te($,`margin-left:${l(y).$level*28}px;`)),b(ne,oe)};B(N,ne=>{l(k).treetoggle&&ne(F)})}var A=le(N,2);{var X=ne=>{var oe=Z(),$=q(oe);tt($,()=>l(k).cell,(J,U)=>{U(J,{get api(){return t},get row(){return l(y)},get column(){return l(k)}})}),b(ne,oe)},ue=ne=>{var oe=bu(),$=Y(oe,!0);L(oe),j(J=>Me($,J),[()=>an(l(y),l(k))]),b(ne,oe)};B(A,ne=>{l(k).cell?ne(X):ne(ue,!1)})}L(p),j((ne,oe)=>{ye(p,1,`wx-print-cell wx-cell ${ne??""}`,"svelte-15wlng7"),Te(p,oe)},[()=>o(l(y),l(k)),()=>vi(l(k),a.columnWidth)]),b(z,p)};B(x,z=>{l(k).collapsed||z(T)})}b(M,_)}),L(S),j(M=>ye(S,1,M,"svelte-15wlng7"),[()=>"wx-row"+(e.rowStyle?" "+e.rowStyle(l(y)):"")]),b(w,S)}),L(g);var v=le(g);{var m=w=>{var y=Tu(),S=Y(y);xa(S,{get columns(){return s},type:"footer",get columnStyle(){return e.columnStyle}}),L(y),b(w,y)};B(v,w=>{e.footer&&w(m)})}L(d),j(w=>u=ye(d,1,"wx-print-grid svelte-15wlng7",null,u,w),[()=>({"wx-flex-columns":e.columns.some(w=>w.flexgrow)})]),b(n,d),he()}var Eu=P('<div class="wx-print-grid-wrapper"><!></div>'),Du=P("<div></div>");function Iu(n,e){fe(e,!0);let t=rn(e,["$$slots","$$events","$$legacy","config"]);const r=Ae("grid-store"),{_skin:a,_columns:i}=r.getState();let s=cc(i,e.config),o=Q(void 0);Rt(()=>{const d=document.body;d.classList.add("wx-print");const u=l(o).cloneNode(!0);d.appendChild(u);const f=`@media print { @page { size: ${e.config.paper} ${e.config.mode}; }`,h=document.createElement("style");h.setAttribute("type","text/css"),h.setAttribute("media","print"),document.getElementsByTagName("head")[0].appendChild(h),h.appendChild(document.createTextNode(f)),window.print(),h.remove(),d.classList.remove("wx-print"),u.remove()});var c=Du();Ge(c,21,()=>s,gt,(d,u)=>{var f=Eu(),h=Y(f);Cu(h,mt({get columns(){return l(u)}},()=>t)),L(f),b(d,f)}),L(c),Xe(c,d=>O(o,d),()=>l(o)),j(()=>ye(c,1,`wx-${a??""}-theme wx-print-container`)),b(n,c),he()}var Wu=P('<div class="wx-header-wrapper svelte-d6gh8v"><!></div>'),Hu=(n,e)=>e(n),Ru=P('<div class="wx-cell wx-collapsed svelte-d6gh8v"></div>'),Pu=P('<div role="row" tabindex="-1"></div>'),Lu=P('<div><div class="wx-table-box svelte-d6gh8v"><div class="wx-scroll svelte-d6gh8v"><!> <div class="wx-body svelte-d6gh8v"><!> <div class="wx-data svelte-d6gh8v"></div></div> <!></div></div></div> <!>',1);function zu(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(S,"$_columns",t),i=()=>ae(_,"$_sizes",t),s=()=>ae(y,"$dynamic",t),o=()=>ae(M,"$data",t),c=()=>ae(k,"$split",t),d=()=>ae(x,"$selectedRows",t),u=()=>ae(T,"$select",t),f=()=>ae(H,"$focusCell",t),h=()=>ae(F,"$undo",t),g=()=>ae(C,"$tree",t),v=()=>ae(z,"$editor",t),m=()=>ae(N,"$_print",t),w=Ae("grid-store"),{dynamic:y,_columns:S,flatData:M,split:k,_sizes:_,selectedRows:x,_select:T,editor:z,scroll:p,tree:C,focusCell:H,_print:N,undo:F}=w.getReactiveState();let A=Q(0);Rt(()=>O(A,Pe(),!0));let X=Q(0),ue=Q(0);const ne=D(()=>a().some(W=>!W.hidden&&W.flexgrow)),oe=D(()=>i().rowHeight);let $,J=Q(null),U=Q(null);const ce=D(()=>{const W=s()?s().rowCount:o().length,V=W*l(oe);return e.autoRowHeight?l(kt)+l(R).d+(W-l(Be))*l(oe):V}),me=D(()=>a().reduce((W,V)=>(V.hidden||(W+=V.width),W),0)),Ie=D(()=>{let W=[],V=0;return c().left&&(W=a().slice(0,c().left).filter(ke=>!ke.hidden).map(ke=>({...ke})),W.forEach(ke=>{ke.fixed={left:1},ke.left=V,V+=ke.width}),W.length&&(W[W.length-1].fixed={left:-1})),{columns:W,width:V}}),We=D(()=>{let W=[],V=0;if(c().right){W=a().slice(c().right*-1).filter(ke=>!ke.hidden).map(ke=>({...ke}));for(let ke=W.length-1;ke>=0;ke--){const be=W[ke];be.fixed={right:1},be.right=V,V+=be.width}W.length&&(W[0].fixed={right:-1})}return{columns:W,width:V}}),we=D(()=>{const W=a().slice(c().left,a().length-(c().right??0)).filter(V=>!V.hidden);return W.forEach(V=>{V.fixed=0}),W}),He=1,Se=D(()=>{let W,V,ke;const be=l(X),rt=l(X)+e.clientWidth;let Ke=0,Le=0,et=0,ut=0;l(we).forEach((lt,Lt)=>{be>et&&(Ke=Lt,ut=et),et=et+lt.width,rt>et&&(Le=Lt+He)});const Tt={header:0,footer:0};for(let lt=Le;lt>=Ke;lt--)["header","footer"].forEach(Lt=>{l(we)[lt]&&l(we)[lt][Lt].forEach(Ai=>{const jn=Ai.colspan;if(jn&&jn>1){const Hr=jn-(Le-lt+1);Hr>0&&(Tt[Lt]=Math.max(Tt[Lt],Hr))}})});const Ft=ge(Ke,ut,"header"),bt=ge(Ke,ut,"footer"),Pt=Ft.delta,Yt=Ft.index,Kt=bt.delta,Gt=bt.index;return l(ne)&&l(me)>e.clientWidth?W=V=ke=[...l(Ie).columns,...l(we),...l(We).columns]:(W=[...l(Ie).columns,...l(we).slice(Ke,Le+1),...l(We).columns],V=[...l(Ie).columns,...l(we).slice(Yt,Le+Tt.header+1),...l(We).columns],ke=[...l(Ie).columns,...l(we).slice(Gt,Le+Tt.footer+1),...l(We).columns]),{data:W,header:V,footer:ke,d:ut,df:Kt,dh:Pt}}),qe=D(()=>l(ne)&&l(me)<=e.clientWidth?e.clientWidth-(l(G)?l(A):0):l(me)),ee=D(()=>e.header?i().headerHeight:0),pe=D(()=>e.footer?i().footerHeight:0),G=D(()=>e.clientWidth&&e.clientHeight?l(ce)+l(ee)+l(pe)>=e.clientHeight-(l(me)>=e.clientWidth?l(A):0):!1),ve=D(()=>e.clientWidth&&e.clientHeight?l(me)>=e.clientWidth:!1),Ce=D(()=>l(ne)&&l(me)<=e.clientWidth?e.clientWidth:l(qe)<e.clientWidth?l(me)+(l(G)?l(A):0):-1),Re=D(()=>e.clientHeight-l(ee)-l(pe)-(l(ve)?l(A):0)),se=D(()=>Math.ceil(l(Re)/l(oe))+1),I=2,R=D(()=>{let W=0,V=0;if(e.autoRowHeight){let be=l(ue);for(;be>0;)be-=at[W]||l(oe),W++;V=l(ue)-be;for(let rt=Math.max(0,W-I-1);rt<W;rt++)V-=at[W-rt]||l(oe);W=Math.max(0,W-I)}else W=Math.floor(l(ue)/l(oe)),W=Math.max(0,W-I),V=W*l(oe);const ke=Math.min(s()?s().rowCount:o().length,W+l(se)+I);return{d:V,start:W,end:ke}});let ie={};Ve(()=>{if(s()&&(ie.start!==l(R).start||ie.end!==l(R).end)){const{start:W,end:V}=l(R);ie={start:W,end:V},w.exec("request-data",{row:{start:W,end:V}})}});const te=D(()=>s()?o():o().slice(l(R).start,l(R).end)),re=D(()=>d().filter(W=>l(te).some(V=>V.id===W)));let ze=D(()=>l(R).start),Be=Q(void 0);function $e(W){O(ue,W.target.scrollTop,!0),O(X,W.target.scrollLeft,!0)}function Fe(W){W.shiftKey&&W.preventDefault(),$.focus()}function Ue(){return!!a().find(W=>!!W.draggable)}let ot,Qe;const st={dblclick:(W,V)=>{const ke={id:W,column:ir(V,"data-col-id")};w.exec("open-editor",ke)},click:(W,V)=>{if(ot)return;const ke=ir(V,"data-col-id");if(w.exec("focus-cell",{row:W,column:ke,eventSource:"click"}),T===!1)return;const be=e.multiselect&&V.ctrlKey,rt=e.multiselect&&V.shiftKey;u()&&w.exec("select-row",{id:W,toggle:be,range:rt})},"toggle-row":W=>{const V=w.getRow(W);w.exec(V.open!==!1?"close-row":"open-row",{id:W})},"ignore-click":()=>!1},_t=D(()=>({top:l(ee),bottom:l(pe),left:l(Ie).width,xScroll:l(ve),yScroll:l(G),sense:e.autoRowHeight&&l(U)?l(U).offsetHeight:Math.max(i().rowHeight,40),node:$&&$.firstElementChild}));function K(W,V){const{container:ke,sourceNode:be,from:rt}=V;if(Ue()&&!be.getAttribute("draggable-data"))return!1;O(J,rt,!0),w.getRow(l(J)).open&&w.exec("close-row",{id:l(J),nested:!0});const Le=xt(be,"data-id");O(U,Le.cloneNode(!0),!0),l(U).classList.remove("wx-selected"),l(U).querySelectorAll("[tabindex]").forEach(Ft=>Ft.setAttribute("tabindex","-1")),ke.appendChild(l(U));const et=l(X)-l(Se).d,ut=l(G)?l(A):0;ke.style.width=Math.min(e.clientWidth-ut,l(ne)&&l(me)<=e.clientWidth?l(qe):l(qe)-ut)+et+"px";const Tt=Cn(Le);V.offset={x:et,y:-Math.round(Tt.height/2)},Qe||(Qe=W.clientY)}function de(W,V){const{from:ke}=V,be=V.pos,rt=Cn($);be.x=rt.x;const Ke=l(_t).top;if(be.y<Ke)be.y=Ke;else{const Le=rt.height-(l(ve)&&l(A)>0?l(A):Math.round(l(_t).sense/2))-l(_t).bottom;be.y>Le&&(be.y=Le)}if($.contains(V.targetNode)){const Le=xt(V.targetNode,"data-id"),et=yn(Le?.getAttribute("data-id"));if(et&&et!==ke){V.to=et;const ut=e.autoRowHeight?l(U)?.offsetHeight:i().rowHeight;if(l(ue)===0||be.y>Ke+ut-1){const Tt=Le.getBoundingClientRect(),bt=Cn(l(U)).y,Pt=Tt.y,Yt=bt>Pt?-1:1,Kt=Yt===1?"after":"before",Gt=Math.abs(w.getRowIndex(ke)-w.getRowIndex(et)),lt=Gt!==1?Kt==="before"?"after":"before":Kt;if(Gt===1&&(Yt===-1&&W.clientY>Qe||Yt===1&&W.clientY<Qe))return;Qe=W.clientY,w.exec("move-item",{id:ke,target:et,mode:lt,inProgress:!0})}}e.onreorder&&e.onreorder({event:W,context:V})}sd(W,rt,V,l(_t))}function xe(W,V){const{from:ke,to:be}=V;w.exec("move-item",{id:ke,target:be,inProgress:!1}),ot=setTimeout(()=>{ot=0},1),O(J,O(U,Qe=null,!0),!0),yi(V)}function ge(W,V,ke){let be=V,rt=W;if(l(we).length){let Ke=l(we).length;for(let Le=W;Le>=0;Le--)l(we)[Le][ke].forEach(ut=>{ut.colspan>1&&Le>W-ut.colspan&&Le<Ke&&(Ke=Le)});if(Ke!==l(we).length&&Ke<W){for(let Le=Ke;Le<W;Le++)be-=l(we)[Le].width;rt=Ke}}return{index:rt,delta:be}}function Pe(){const W=document.createElement("div");W.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;",document.body.appendChild(W);const V=W.offsetWidth-W.clientWidth;return document.body.removeChild(W),V}const Ee=D(()=>l(Ce)>0?`width:${l(Ce)}px;`:"");let Oe,at=[],kt=Q(0);function Dt(){En().then(()=>{let W=0,V=l(ze);Array.from(Oe.children).forEach((ke,be)=>{at[l(ze)+be]=ke.offsetHeight,W+=ke.offsetHeight,V++}),O(kt,W,!0),O(Be,V,!0)})}Ve(()=>l(te)&&e.autoRowHeight&&Dt());let it=Q(void 0);Ve(()=>{if(f()&&(!u()||!l(re).length||l(re).includes(f().row)))O(it,{...f()},!0);else if(l(te).length&&l(Se).data.length){if(!l(it)||l(re).length&&!l(re).includes(l(it).row)||l(te).findIndex(W=>W.id==l(it).row)===-1||l(Se).data.findIndex(W=>W.id==l(it).column&&!W.collapsed)===-1){const W=l(re)[0]||l(te)[0].id,V=l(Se).data.findIndex(ke=>!ke.collapsed);V!==-1?O(it,{row:W,column:l(Se).data[V].id},!0):O(it,null)}}else O(it,null)});var Xt=Lu(),Je=q(Xt),Ye=Y(Je),dt=Y(Ye),_n=Y(dt);{var Yn=W=>{var V=Wu(),ke=Y(V);{let be=D(()=>l(Re)-+e.footer);wa(ke,{get contentWidth(){return l(qe)},get deltaLeft(){return l(Se).dh},get columns(){return l(Se).header},get columnStyle(){return e.columnStyle},get bodyHeight(){return l(be)}})}L(V),b(W,V)};B(_n,W=>{e.header&&W(Yn)})}var It=le(_n,2);It.__mousedown=[Hu,Fe];var Wr=Y(It);{var Hi=W=>{jd(W,{get overlay(){return e.overlay}})};B(Wr,W=>{e.overlay&&W(Hi)})}var kn=le(Wr,2);Ge(kn,23,()=>l(te),W=>W.id,(W,V,ke)=>{var be=Pu();let rt;Ge(be,21,()=>l(Se).data,Ke=>Ke.id,(Ke,Le)=>{var et=Z(),ut=q(et);{var Tt=bt=>{var Pt=Ru();b(bt,Pt)},Ft=bt=>{var Pt=Z(),Yt=q(Pt);{var Kt=lt=>{fu(lt,{get row(){return l(V)},get column(){return l(Le)}})},Gt=lt=>{{let Lt=D(()=>l(it)?.row===l(V).id&&l(it)?.column==l(Le).id);xd(lt,{get row(){return l(V)},get column(){return l(Le)},get columnStyle(){return e.columnStyle},get cellStyle(){return e.cellStyle},get reorder(){return e.reorder},get focusable(){return l(Lt)}})}};B(Yt,lt=>{v()?.id===l(V).id&&v().column==l(Le).id?lt(Kt):lt(Gt,!1)},!0)}b(bt,Pt)};B(ut,bt=>{l(Le).collapsed?bt(Tt):bt(Ft,!1)})}b(Ke,et)}),L(be),j((Ke,Le,et)=>{rt=ye(be,1,Ke,"svelte-d6gh8v",rt,Le),De(be,"data-id",l(V).id),De(be,"data-context-id",l(V).id),Te(be,`${e.autoRowHeight?"min-height":"height"}:${l(oe)}px;`),De(be,"aria-rowindex",l(ke)),De(be,"aria-expanded",l(V).open),De(be,"aria-level",g()?l(V).$level+1:void 0),De(be,"aria-selected",et)},[()=>"wx-row"+(e.rowStyle?" "+e.rowStyle(l(V)):""),()=>({"wx-autoheight":e.autoRowHeight,"wx-selected":d().indexOf(l(V).id)!==-1,"wx-inactive":l(J)===l(V).id}),()=>g()?d().indexOf(l(V).id)!==-1:void 0]),b(W,be)}),L(kn),Xe(kn,W=>Oe=W,()=>Oe),L(It),vt(It,(W,V)=>Er?.(W,V),()=>()=>w.exec("focus-cell",{eventSource:"click"})),vt(It,(W,V)=>zc?.(W,V),()=>st);var Ri=le(It,2);{var Pi=W=>{wa(W,{type:"footer",get contentWidth(){return l(qe)},get deltaLeft(){return l(Se).df},get columns(){return l(Se).footer},get columnStyle(){return e.columnStyle}})};B(Ri,W=>{e.footer&&o().length&&W(Pi)})}L(dt),vt(dt,(W,V)=>Ic?.(W,V),()=>({scroll:p,getWidth:()=>e.clientWidth-(l(G)?l(A):0),getHeight:()=>l(Re),getScrollMargin:()=>l(Ie).width+l(We).width})),L(Ye),Xe(Ye,W=>$=W,()=>$),vt(Ye,(W,V)=>td?.(W,V),()=>e.resize),vt(Ye,(W,V)=>ad?.(W,V),()=>({start:K,move:de,end:xe,getReorder:()=>e.reorder,getDraggableInfo:()=>({hasDraggable:Ue()})})),vt(Ye,(W,V)=>Cr?.(W,V),()=>({keys:fd({undo:h()}),exec:W=>w.exec("hotkey",W)})),L(Je);var Li=le(Je,2);{var zi=W=>{Iu(W,{get config(){return m()},get rowStyle(){return e.rowStyle},get columnStyle(){return e.columnStyle},get cellStyle(){return e.cellStyle},get header(){return e.header},get footer(){return e.footer},get reorder(){return e.reorder}})};B(Li,W=>{m()&&W(zi)})}j(()=>{ye(Je,1,`wx-grid ${e.responsiveLevel?`wx-responsive-${e.responsiveLevel}`:""}`,"svelte-d6gh8v"),Te(Je,`--header-height:${l(ee)??""}px; --footer-height:${l(pe)??""}px;--split-left-width:${l(Ie).width??""}px;
		--split-right-width:${l(We).width??""}px;`),Te(Ye,l(Ee)),De(Ye,"role",g()?"treegrid":"grid"),De(Ye,"aria-colcount",l(Se).data.length),De(Ye,"aria-rowcount",l(te).length),De(Ye,"aria-multiselectable",g()&&e.multiselect?!0:void 0),Te(dt,`overflow-x:${l(ve)?"scroll":"hidden"};overflow-y:${l(G)?"scroll":"hidden"};`),Te(It,`width:${l(qe)??""}px;height:${l(ce)??""}px;`),Te(kn,`padding-top:${l(R).d??""}px;padding-left:${l(Se).d??""}px;`)}),Et("scroll",dt,$e),b(n,Xt),he(),r()}je(["mousedown"]);function Au(n,e){fe(e,!0);let t=E(e,"data",19,()=>[]),r=E(e,"columns",19,()=>[]),a=E(e,"rowStyle",3,null),i=E(e,"columnStyle",3,null),s=E(e,"cellStyle",3,null),o=E(e,"selectedRows",19,()=>[]),c=E(e,"select",3,!0),d=E(e,"multiselect",3,!1),u=E(e,"header",3,!0),f=E(e,"footer",3,!1),h=E(e,"dynamic",3,null),g=E(e,"overlay",3,null),v=E(e,"reorder",3,!1),m=E(e,"onreorder",3,null),w=E(e,"autoRowHeight",3,!1),y=E(e,"sizes",19,()=>({})),S=E(e,"split",19,()=>({left:0})),M=E(e,"tree",3,!1),k=E(e,"autoConfig",3,!1),_=E(e,"init",3,null),x=E(e,"responsive",3,null),T=E(e,"sortMarks",19,()=>({})),z=E(e,"undo",3,!1),p=rn(e,["$$slots","$$events","$$legacy","data","columns","rowStyle","columnStyle","cellStyle","selectedRows","select","multiselect","header","footer","dynamic","overlay","reorder","onreorder","autoRowHeight","sizes","split","tree","autoConfig","init","responsive","sortMarks","undo"]),C=Q(0),H=Q(0),N=Q(null),F=Q(null);const A=new Cc(Ea);let X=A.in;const ue=/-/g;let ne=new Pa((se,I)=>{const R="on"+se.replace(ue,"");p[R]&&p[R](I)});X.setNext(ne);const oe=A.getState.bind(A),$=A.getReactive.bind(A),J=()=>({data:A}),U=X.exec,ce=se=>ne=ne.setNext(se),me=X.intercept.bind(X),Ie=X.on.bind(X),We=X.detach.bind(X),we=se=>A.getRow(se),He=se=>A.getColumn(se),Se={exec:U,setNext:ce,intercept:me,on:Ie,detach:We,getRow:we,getColumn:He,getState:oe,getReactiveState:$,getStores:J};Ln("grid-store",{getState:A.getState.bind(A),getReactiveState:A.getReactive.bind(A),exec:X.exec.bind(X),getRow:A.getRow.bind(A),getRowIndex:A.getRowIndex.bind(A)});const qe=D(()=>{if(k()&&!r().length&&t().length){const se=t()[0],I=[];for(let R in se)if(R!=="id"&&R[0]!=="$"){let ie={id:R,header:R[0].toUpperCase()+R.slice(1)};typeof k()=="object"&&(ie={...ie,...k()}),I.push(ie)}return I}return l(F)?.columns??r()}),ee=D(()=>l(F)?.sizes??y());function pe(se){if(O(C,se.width,!0),O(H,se.height,!0),x()){const R=Object.keys(x()).map(Number).sort((ie,te)=>ie-te).find(ie=>l(C)<=ie)??null;R!==l(N)&&(O(F,x()[R],!0),O(N,R,!0))}}const G=D(()=>{let se=!M();return Mr()||(se=!0),se?v():!1});let ve=D(()=>Ae("wx-theme")),Ce=!0;const Re=()=>{A.init({data:t(),columns:l(qe),split:S(),sizes:l(ee),selectedRows:o(),dynamic:h(),tree:M(),sortMarks:T(),undo:z(),_skin:l(ve),_select:c()}),Ce&&_()&&(_()(Se),Ce=!1)};return Re(),Ve(Re),zn(n,{get words(){return ed},optional:!0,children:(se,I)=>{zu(se,{get header(){return u()},get footer(){return f()},get overlay(){return g()},get rowStyle(){return a()},get columnStyle(){return i()},get cellStyle(){return s()},get reorder(){return l(G)},get onreorder(){return m()},get multiselect(){return d()},get autoRowHeight(){return w()},get clientWidth(){return l(C)},get clientHeight(){return l(H)},get responsiveLevel(){return l(N)},resize:pe})},$$slots:{default:!0}}),he({getState:oe,getReactiveState:$,getStores:J,exec:U,setNext:ce,intercept:me,on:Ie,detach:We,getRow:we,getColumn:He})}function bi(n,e){return n.map(t=>{const r=e(t);return t.data&&t.data.length&&(r.data=bi(t.data,e)),r})}function Si(n,e){const t=[];return n.forEach(r=>{if(r.data){const a=Si(r.data,e);a.length&&t.push({...r,data:a})}else e(r)&&t.push(r)}),t}let Ou=1;function Nu(n){return bi(n,e=>({...e,id:e.id||Ou++}))}const pi={};function Bu(n){return pi[n]}function Fu(n,e){pi[n]=e}var Yu=P("<i></i>"),ju=P('<span class="wx-value svelte-xfznf6"> </span>'),qu=P('<span class="wx-subtext svelte-xfznf6"> </span>'),Uu=P('<i class="wx-sub-icon wxi-angle-right svelte-xfznf6"></i>'),Vu=P("<div><!> <!> <!> <!></div>");function Xu(n,e){fe(e,!0);let t=E(e,"showSub",15,!1),r=E(e,"activeItem",15,null);function a(){t(e.item.data?e.item.id:!1),r(this)}var i=Vu();i.__click=function(...m){e.onclick?.apply(this,m)};var s=Y(i);{var o=m=>{var w=Yu();j(()=>ye(w,1,`wx-icon ${e.item.icon??""}`,"svelte-xfznf6")),b(m,w)};B(s,m=>{e.item.icon&&m(o)})}var c=le(s,2);{var d=m=>{const w=D(()=>Bu(e.item.type));var y=Z(),S=q(y);tt(S,()=>l(w),(M,k)=>{k(M,{get item(){return e.item}})}),b(m,y)},u=m=>{var w=ju(),y=Y(w,!0);L(w),j(()=>Me(y,e.item.text)),b(m,w)};B(c,m=>{e.item.type?m(d):m(u,!1)})}var f=le(c,2);{var h=m=>{var w=qu(),y=Y(w,!0);L(w),j(()=>Me(y,e.item.subtext)),b(m,w)};B(f,m=>{e.item.subtext&&m(h)})}var g=le(f,2);{var v=m=>{var w=Uu();b(m,w)};B(g,m=>{e.item.data&&m(v)})}L(i),j(()=>{ye(i,1,`wx-item ${(e.item.css||"")??""}`,"svelte-xfznf6"),De(i,"data-id",e.item.id)}),Et("mouseenter",i,a),b(n,i),he()}je(["click"]);var Ku=P('<div class="wx-separator svelte-1tqohog"></div>'),Gu=P("<!> <!>",1),Qu=P('<div data-wx-menu="true"></div>');function Ti(n,e){fe(e,!0);let t=E(e,"left",3,0),r=E(e,"top",3,0),a=E(e,"at",3,"bottom"),i=E(e,"parent",3,null),s=E(e,"mount",3,null),o=E(e,"context",3,null),c=E(e,"css",3,""),d=Q(-1e4),u=Q(-1e4),f=Q(20),h=Q(void 0),g=Q(void 0),v=Q(!1),m=Q(null);function w(){const _=qc(l(g),i(),a(),t(),r());_&&(O(d,_.x,!0),O(u,_.y,!0),O(f,_.z,!0),O(h,_.width,!0))}s()&&s()(w),Rt(w);function y(){O(v,!1)}function S(){e.onclick&&e.onclick({action:null})}const M=D(()=>Nu(e.options));Ve(()=>{w(i())});var k=Qu();Ge(k,21,()=>l(M),_=>_.id,(_,x)=>{var T=Gu(),z=q(T);{var p=F=>{var A=Ku();b(F,A)},C=F=>{Xu(F,{get item(){return l(x)},onclick:A=>{if(!l(x).data&&!A.defaultPrevented){const X={context:o(),action:l(x),event:A};l(x).handler&&l(x).handler(X),e.onclick&&e.onclick(X),A.stopPropagation()}},get showSub(){return l(v)},set showSub(A){O(v,A,!0)},get activeItem(){return l(m)},set activeItem(A){O(m,A,!0)}})};B(z,F=>{l(x).type==="separator"?F(p):F(C,!1)})}var H=le(z,2);{var N=F=>{Ti(F,{get css(){return c()},get options(){return l(x).data},at:"right-overlap",get parent(){return l(m)},get context(){return o()},get onclick(){return e.onclick}})};B(H,F=>{l(x).data&&l(v)===l(x).id&&F(N)})}b(_,T)}),L(k),vt(k,(_,x)=>Er?.(_,x),()=>({callback:S,modal:!0})),Xe(k,_=>O(g,_),()=>l(g)),j(()=>{ye(k,1,`wx-menu ${c()??""}`,"svelte-1tqohog"),Te(k,`position:absolute;top:${l(u)??""}px;left:${l(d)??""}px;width:${l(h)??""};z-index:${l(f)??""}`)}),Et("mouseleave",k,y),b(n,k),he()}var Ju=P('<span data-menu-ignore="true"><!></span>'),Zu=P("<!> <!>",1);function $u(n,e){fe(e,!0);let t=E(e,"at",3,"bottom"),r=E(e,"resolver",3,null),a=E(e,"dataKey",3,"contextId"),i=E(e,"filter",3,null),s=E(e,"css",3,"");var o=D(()=>Wt(c)!==null&&i()?Si(e.options,k=>i()(k,Wt(c))):e.options),c=Q(null),d=Q(null);let u=Q(0),f=Q(0);function h(k){O(d,null),e.onclick&&e.onclick(k)}function g(k,_){let x=null;for(;k&&k.dataset&&!x;)x=k.dataset[_],k=k.parentNode;return x?yn(x):null}function v(k,_){if(!k){O(d,null);return}if(k.defaultPrevented)return;const x=k.target;x&&x.dataset&&x.dataset.menuIgnore||(O(u,k.clientX+1),O(f,k.clientY+1),O(c,typeof _<"u"?_:g(x,a()),!0),!(r()&&(O(c,r()(Wt(c),k),!0),!Wt(c)))&&(O(d,x,!0),k.preventDefault()))}var m=Zu(),w=q(m);{var y=k=>{var _=Ju();_.__click=v;var x=Y(_);ct(x,()=>e.children??Vt),L(_),b(k,_)};B(w,k=>{e.children&&k(y)})}var S=le(w,2);{var M=k=>{to(k,{children:(x,T)=>{let z=()=>T?.().mount;var p=Z(),C=q(p);_o(C,()=>Wt(d),H=>{Ti(H,{get css(){return s()},get at(){return t()},get top(){return l(f)},get left(){return l(u)},get mount(){return z()},get parent(){return Wt(d)},get context(){return Wt(c)},onclick:h,get options(){return Wt(o)}})}),b(x,p)},$$slots:{default:!0}})};B(S,k=>{Wt(d)&&k(M)})}return b(n,m),he({show:v})}je(["click"]);je(["click"]);je(["click"]);var ef=P('<span data-menu-ignore="true"><!></span>'),tf=P("<!> <!>",1);function Mi(n,e){fe(e,!0);let t=null;function r(g,v){t.show(g,v)}let a=E(e,"at",3,"bottom"),i=E(e,"resolver",3,null),s=E(e,"dataKey",3,"contextId"),o=E(e,"filter",3,null),c=E(e,"css",3,"");var d=tf(),u=q(d);{var f=g=>{var v=ef();v.__contextmenu=function(...w){t.show?.apply(this,w)};var m=Y(v);ct(m,()=>e.children??Vt),L(v),b(g,v)};B(u,g=>{e.children&&g(f)})}var h=le(u,2);return Xe($u(h,{get css(){return c()},get at(){return a()},get options(){return e.options},get resolver(){return i()},get dataKey(){return s()},get filter(){return o()},get onclick(){return e.onclick}}),g=>t=g,()=>t),b(n,d),he({show:r})}je(["contextmenu"]);var nf=P('<div tabindex="-1" role="menuitem"><div><i class="wxi-eye"></i></div> <span> </span></div>');function rf(n,e){fe(e,!0);var t=nf(),r=Y(t);let a;var i=le(r,2),s=Y(i,!0);L(i),L(t),j(o=>{De(t,"aria-label",e.item.hidden?`Show ${e.item.text} column`:`Hide ${e.item.text} column`),a=ye(r,1,"wx-icon svelte-fogbc2",null,a,o),Me(s,e.item.text)},[()=>({"wx-hidden":!!e.item.hidden})]),b(n,t),he()}function af(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(d,"$rColumns",t);let i=E(e,"columns",3,null);Fu("table-header",rf);function s(f){for(let h=f.header.length-1;h>=0;h--){const g=f.header[h].text;if(g)return g}return f.id}function o(f){const h=f.action;h&&e.api.exec("hide-column",{id:h.id,mode:!h.hidden})}function c(f){return f}let d;const u=D(()=>e.api?(d=e.api.getReactiveState()._columns,(i()?a().filter(h=>i()[h.id]):a()).map(h=>{const g=s(h);return{id:h.id,text:g,type:"table-header",hidden:h.hidden}})):[]);Mi(n,{dataKey:"headerId",get options(){return l(u)},onclick:o,at:"point",resolver:c,children:(f,h)=>{var g=Z(),v=q(g);ct(v,()=>e.children??Vt),b(f,g)},$$slots:{default:!0}}),he(),r()}je(["mousemove"]);wi(Ha);var of=P('<i data-action="open-task"></i>'),sf=P('<i class="wx-toggle-placeholder svelte-r092m"></i>'),lf=P('<div class="wx-content svelte-r092m"><!> <div class="wx-text svelte-r092m"> </div></div>');function cf(n,e){fe(e,!0);function t(d,u){return`justify-content:${u.align};padding-left: ${(d.$level-1)*20}px`}var r=lf(),a=Y(r);{var i=d=>{var u=of();j(()=>ye(u,1,`wx-toggle-icon wxi-menu-${e.row.open?"down":"right"}`,"svelte-r092m")),b(d,u)},s=d=>{var u=sf();b(d,u)};B(a,d=>{e.row.data||e.row.lazy?d(i):d(s,!1)})}var o=le(a,2),c=Y(o,!0);L(o),L(r),j(d=>{Te(r,d),Me(c,e.row.text)},[()=>t(e.row,e.column)]),b(n,r),he()}var df=P('<div><i class="wx-action-icon wxi-plus svelte-1qpa35z"></i></div>');function ya(n,e){fe(e,!0);const t=D(()=>e.column.id);var r=Z(),a=q(r);{var i=s=>{var o=df(),c=Y(o);L(o),j(()=>{Te(o,`text-align:${e.column.align??""}`),De(c,"data-action",l(t))}),b(s,o)};B(a,s=>{(e.cell||e.column.id=="add-task")&&s(i)})}b(n,r),he()}function uf(n,e,t){const r=Bn(n),a=n.target.dataset.action;a&&n.preventDefault(),r?a=="add-task"||a=="open-task"?e(r,a):t.exec("select-task",{id:r,toggle:n.ctrlKey||n.metaKey,range:n.shiftKey,show:!0}):a=="add-task"&&e(null,a)}function ff(n,e,t,r){if(!e.readonly){const a=Bn(n),i=ir(n,"data-col-id");!(i&&l(t).find(o=>o.id==i))?.editor&&a&&r.exec("show-editor",{id:a})}}var hf=P('<div class="wx-table-container svelte-9p5dsy"><div class="wx-table svelte-9p5dsy"><!></div></div>');function gf(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(M,"$scrollTop",t),i=()=>ae(H,"$sort",t),s=()=>ae(N,"$durationUnit",t),o=()=>ae(T,"$area",t),c=()=>ae(p,"$scales",t),d=()=>ae(x,"$selected",t),u=()=>ae(z,"$rTasks",t),f=()=>ae(C,"$columns",t),h=()=>ae(k,"$cellHeight",t);let g=E(e,"width",3,0),v=E(e,"columnWidth",7),m=E(e,"display",11,"all"),w=E(e,"tableAPI",15);const y=Ae("wx-i18n").getGroup("gantt"),S=Ae("gantt-store"),{scrollTop:M,cellHeight:k,_scrollTask:_,_selected:x,area:T,_tasks:z,_scales:p,columns:C,_sort:H,durationUnit:N}=S.getReactiveState();let F=null,A=!0,X=Q(null);function ue(K,de){if(de=="add-task")S.exec(de,{target:K,task:{text:y("New Task")},mode:"child",show:!0});else if(de=="open-task"){const xe=l(I).find(ge=>ge.id===K);(xe.data||xe.lazy)&&S.exec(de,{id:K,mode:!xe.open})}}function ne(){A=!1}function oe(K){A=!0,F=K.touches[0].clientY+a()}function $(K){if(A){const de=F-K.touches[0].clientY;return S.exec("scroll-chart",{top:de}),K.preventDefault(),!1}}let J;function U(K){const de=K.id,{before:xe,after:ge}=K,Pe=K.onMove;let Ee=xe||ge,Oe=xe?"before":"after";if(Pe){if(Oe=="after"){const at=S.getTask(Ee);at.data?.length&&at.open&&(Oe="before",Ee=at.data[0].id)}J={id:de,[Oe]:Ee}}else J=null;S.exec("move-task",{id:de,mode:Oe,target:Ee,inProgress:Pe})}function ce({id:K}){if(e.readonly||(S.getTask(K).open&&S.exec("open-task",{id:K,mode:!1}),O(X,l(I).find(de=>de.id===K),!0),!l(X)))return!1}function me({id:K,top:de}){J?U({...J,onMove:!1}):S.exec("drag-task",{id:K,top:de+l(pe),inProgress:!1}),O(X,null)}function Ie({id:K,top:de,detail:xe}){xe&&U({...xe,onMove:!0}),S.exec("drag-task",{id:K,top:de+l(pe),inProgress:!0})}let We=Q(0),we=Q(void 0),He=Q(void 0),Se=Q(!1);function qe(K){const{key:de,isInput:xe}=K;if(!xe&&(de==="arrowup"||de==="arrowdown"))return K.eventSource="grid",S.exec("hotkey",K),!1;if(de==="enter"){const ge=w().getState().focusCell;if(ge){const{row:Pe,column:Ee}=ge;Ee==="add-task"?ue(Pe,"add-task"):Ee==="text"&&ue(Pe,"open-task")}}}function ee(K){w(K),K.intercept("hotkey",qe),K.intercept("scroll",()=>!1),K.intercept("select-row",()=>!1),K.intercept("sort-rows",de=>{const{key:xe,add:ge}=de;let Pe=i()?i().find(Oe=>Oe.key===xe):null,Ee="asc";return Pe&&(Ee=!Pe||Pe.order==="asc"?"desc":"asc"),S.exec("sort-tasks",{key:xe,order:Ee,add:ge}),!1}),K.on("resize-column",()=>{re(!0)}),K.on("hide-column",de=>{de.mode||ze(),re()}),K.intercept("update-cell",de=>{const{id:xe,column:ge,value:Pe}=de,Ee=l(I).find(Oe=>Oe.id===xe);if(Ee){const Oe={...Ee};let at=Pe;at&&!isNaN(at)&&!(at instanceof Date)&&(at*=1),Oe[ge]=at,mn(Oe,s(),!0,ge),S.exec("update-task",{id:xe,task:Oe})}return!1})}const pe=D(()=>o().from),G=D(()=>c().height),ve=D(()=>!e.compactMode&&m()!=="grid"?v()>g():v()>l(We)),Ce=D(()=>m()==="all"?`${g()}px`:m()==="grid"?"calc(100% - 4px)":l(Be).find(K=>K.id==="add-task")?"50px":"0"),Re=D(()=>l(ve)&&m()==="all"?`width:${v()}px;`:m()==="grid"?l(ve)?`width:${v()}px;`:"width:100%;":""),se=D(()=>d().map(K=>K.id)),I=D(()=>u().slice(o().start,o().end)),R=D(()=>l(X)&&!l(I).find(K=>K.id===l(X).id)?[...l(I),l(X)]:l(I));function ie(){return l(Be).some(K=>K.flexgrow&&!K.hidden)}const te=D(()=>(l(Se),ie()));function re(K){if(!ie()){const de=l(Fe).reduce((xe,ge)=>(K&&ge.$width&&(ge.$width=ge.width),xe+(ge.hidden?0:ge.width)),0);de!==v()&&v(de)}O(Se,!0),O(Se,!1)}function ze(){l(Be).filter(de=>de.flexgrow&&!de.hidden).length===1&&l(Be).forEach(de=>{de.$width&&!de.flexgrow&&!de.hidden&&(de.width=de.$width)})}const Be=D(()=>{let K=f().map(ge=>(ge={...ge},ge.header=y(ge.header),ge));const de=K.findIndex(ge=>ge.id==="text"),xe=K.findIndex(ge=>ge.id==="add-task");if(de!==-1&&(K[de].cell=cf),xe!==-1){if(K[xe].cell=ya,K[xe].header={text:K[xe].header,cell:ya},e.readonly)K.splice(xe,1);else if(e.compactMode){const[ge]=K.splice(xe,1);K.unshift(ge)}}return K.length>0&&(K[K.length-1].resize=!1),K});let $e=D(()=>{if(l(R)&&i()?.length){const K={};return i().forEach(({key:de,order:xe},ge)=>{K[de]={order:xe,...i().length>1&&{index:ge}}}),K}return{}});const Fe=D(()=>{let K=m()==="chart"?l(Be).filter(xe=>xe.id==="add-task"):l(Be);const de=m()==="all"?g():l(We);if(!l(te)){let xe=v(),ge=!1;if(l(Be).some(Pe=>Pe.$width)){let Pe=0;xe=l(Be).reduce((Ee,Oe)=>(Oe.hidden||(Pe+=Oe.width,Ee+=Oe.$width||Oe.width),Ee),0),Pe>xe&&xe>de&&(ge=!0)}if(ge||xe<de){let Pe=1;return ge||(Pe=(de-50)/(xe-50||1)),K.map(Ee=>(Ee.id!=="add-task"&&!Ee.hidden&&(Ee.$width||(Ee.$width=Ee.width),Ee.width=Ee.$width*Pe),Ee))}}return K});Ve(()=>{l(we)&&(a(),l(pe),Ue())});function Ue(){l(we)&&l(R)!==null&&(l(we).querySelector(".wx-body").style.top=-(a()-l(pe))+"px"),l(He).scrollTop=0}const ot=new ResizeObserver(()=>{Ue()});Ve(()=>(l(we)&&(l(Fe),l(Re),m(),l(Ce),l(R),ot.observe(l(we).querySelector(".wx-table-box .wx-body"))),()=>{ot.disconnect()})),_.subscribe(K=>{if(!K)return;const{id:de}=K,xe=w().getState().focusCell;xe&&xe.row!==de&&l(we)&&l(we).contains(document.activeElement)&&w().exec("focus-cell",{row:de,column:xe.column})});var Qe=hf();Et("touchend",Ma,ne);var st=Y(Qe);st.__touchstart=oe,st.__touchmove=$,st.__click=[uf,ue,S],st.__dblclick=[ff,e,Be,S];var _t=Y(st);{let K=D(()=>({rowHeight:h(),headerHeight:l(G)-1})),de=D(()=>[...l(se)]);Au(_t,{init:ee,get sizes(){return l(K)},rowStyle:xe=>xe.$reorder?"wx-reorder-task":"",columnStyle:xe=>`wx-text-${xe.align} ${xe.id==="add-task"?"wx-action":""}`,get data(){return l(R)},get columns(){return l(Fe)},get selectedRows(){return l(de)},get sortMarks(){return l($e)}})}L(st),Xe(st,K=>O(we,K),()=>l(we)),vt(st,(K,de)=>$c?.(K,de),()=>({start:ce,touchStart:ne,end:me,move:Ie,getTask:S.getTask})),L(Qe),Xe(Qe,K=>O(He,K),()=>l(He)),j(()=>{Te(Qe,`flex: 0 0 ${l(Ce)??""};`),Te(st,l(Re))}),$t(Qe,"clientWidth",K=>O(We,K)),b(n,Qe),he(),r()}je(["touchstart","touchmove","click","dblclick"]);var vf=P("<div></div>");function mf(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(c,"$cellWidth",t),i=()=>ae(d,"$cellHeight",t),s=E(e,"borders",3,""),o=Ae("gantt-store"),{cellWidth:c,cellHeight:d}=o.getReactiveState();let u,f=Q("#e4e4e4");Ve(()=>{if(typeof getComputedStyle<"u"){const g=getComputedStyle(u).getPropertyValue("--wx-gantt-border");O(f,g?g.substring(g.indexOf("#")):"#1d1e261a",!0)}});var h=vf();Xe(h,g=>u=g,()=>u),j(g=>Te(h,`width:100%; height:100%; background:url(${g??""}); position: absolute;`),[()=>Nl(a(),i(),l(f),s())]),b(n,h),he(),r()}function wf(n,e){if(n.button!==0)return;const t=xt(n);t&&e(t,n)}function xf(n,e){e(n,n)}function yf(n,e,t){if(!e.readonly){const r=Bn(n.target);r&&!n.target.classList.contains("wx-link")&&t.exec("show-editor",{id:r})}}var _f=P('<div><div class="wx-inner svelte-m10h26"></div></div>'),kf=P('<div class="wx-progress-wrapper svelte-m10h26"><div class="wx-progress-percent svelte-m10h26"></div></div>'),bf=P('<div class="wx-progress-marker svelte-m10h26"> </div>'),Sf=P('<div class="wx-content svelte-m10h26"> </div>'),pf=P("<!> <!> <!>",1),Tf=P('<div class="wx-text-out svelte-m10h26"> </div>'),Mf=P('<div class="wx-content svelte-m10h26"></div> <!>',1),Cf=P('<div><div class="wx-inner svelte-m10h26"></div></div>'),Ef=P("<div><!> <!> <!></div>"),Df=P("<div></div>"),If=P("<!> <!>",1),Wf=P('<div class="wx-bars svelte-m10h26"></div>');function Hf(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(h,"$rTasks",t),i=()=>ae(v,"$area",t),s=()=>ae(m,"$scales",t),o=()=>ae(g,"$rLinks",t),c=()=>ae(w,"$taskTypes",t),d=()=>ae(S,"$selected",t),u=()=>ae(y,"$baselines",t),f=Ae("gantt-store"),{_tasks:h,_links:g,area:v,_scales:m,taskTypes:w,baselines:y,_selected:S,_scrollTask:M}=f.getReactiveState();let k=D(()=>a().slice(i().start,i().end).map(I=>({...I}))),_=D(()=>s().lengthUnitWidth),x=!1,T=Q(void 0),z=Q(null),p=null,C=Q(void 0),H;function N(I){const R=xt(I);R&&(H=setTimeout(()=>{O(C,!0),F(R,I.touches[0])},300))}function F(I,R){const{clientX:ie}=R,te=hn(I),re=f.getTask(te),ze=R.target.classList;if(!e.readonly){if(ze.contains("wx-progress-marker")){const{progress:Be}=f.getTask(te);p={id:te,x:ie,progress:Be,dx:0,node:I,marker:R.target},R.target.classList.add("wx-progress-in-drag")}else{const Be=A(I,R,re)||"move";O(z,{id:te,mode:Be,x:ie,dx:0,l:re.$x,w:re.$w},!0)}J()}}function A(I,R,ie){if(ie||(ie=f.getTask(hn(I))),ie.type==="milestone"||ie.type=="summary")return"";const te=I.getBoundingClientRect(),re=(R.clientX-te.left)/te.width;let ze=.2/(te.width>200?te.width/200:1);return re<ze?"start":re>1-ze?"end":""}function X(I){l(C)?(I.preventDefault(),ue(I,I.touches[0])):H&&(clearTimeout(H),H=null)}function ue(I,R){const{clientX:ie}=R;if(!e.readonly)if(p){const{node:te,x:re,id:ze}=p,Be=p.dx=ie-re,$e=Math.round(Be/te.offsetWidth*100);let Fe=p.progress+$e;p.value=Fe=Math.min(Math.max(0,Fe),100),f.exec("update-task",{id:ze,task:{progress:Fe},inProgress:!0})}else if(l(z)){const{mode:te,l:re,w:ze,x:Be,id:$e,start:Fe}=l(z),Ue=ie-Be;if(!Fe&&Math.abs(Ue)<20||te==="start"&&ze-Ue<l(_)||te==="end"&&ze+Ue<l(_)||te=="move"&&(Ue<0&&re+Ue<0||Ue>0&&re+ze+Ue>l(G)))return;l(z).dx=Ue;let ot,Qe;te==="start"?(ot=re+Ue,Qe=ze-Ue):te==="end"?(ot=re,Qe=ze+Ue):te==="move"&&(ot=re+Ue,Qe=ze);let st={id:$e,width:Qe,left:ot,inProgress:!0};f.exec("drag-task",st);const _t=f.getTask($e);if(!l(z).start&&(te=="move"&&_t.$x==re||te!="move"&&_t.$w==ze))return x=!0,$();l(z).start=!0}else{const te=xt(I);if(te){const re=A(te,R);te.style.cursor=re&&!e.readonly?"col-resize":"pointer"}}}function ne(){$()}function oe(){O(C,null),H&&(clearTimeout(H),H=null),$()}function $(){if(p){const{dx:I,id:R,marker:ie,value:te}=p;p=null,typeof te<"u"&&I&&f.exec("update-task",{id:R,task:{progress:te}}),ie.classList.remove("wx-progress-in-drag"),x=!0,U()}else if(l(z)){const{id:I,mode:R,dx:ie,l:te,w:re,start:ze}=l(z);if(O(z,null),ze){const Be=Math.round(ie/l(_));if(!Be)f.exec("drag-task",{id:I,width:re,left:te,inProgress:!1});else{let $e={},Fe=f.getTask(I);R=="move"?($e.start=Fe.start,$e.end=Fe.end):$e[R]=Fe[R],f.exec("update-task",{id:I,task:$e,diff:Be})}x=!0}U()}}function J(){document.body.style.userSelect="none"}function U(){document.body.style.userSelect=""}function ce(I){if(x){x=!1;return}const R=Bn(I.target);if(R){const ie=I.target.classList;if(ie.contains("wx-link")){const te=ie.contains("wx-left");if(!l(T)){O(T,{id:R,start:te},!0);return}l(T).id!==R&&!Se(R,te)&&f.exec("add-link",{link:{source:l(T).id,target:R,type:He(l(T).start,te)}})}else f.exec("select-task",{id:R,toggle:I.ctrlKey||I.metaKey,range:I.shiftKey})}qe()}function me(I){return`left:${I.$x}px;top:${I.$y}px;width:${I.$w}px;height:${I.$h}px;`}function Ie(I){return`left:${I.$x_base}px;top:${I.$y_base}px;width:${I.$w_base}px;height:${I.$h_base}px;`}function We(I){if(l(C)||H)return I.preventDefault(),!1}const we=["e2s","s2s","e2e","s2e"];function He(I,R){return we[(I?1:0)+(R?0:2)]}function Se(I,R){const ie=l(T).id,te=l(T).start;return I===ie?!0:o().find(re=>re.target==I&&re.source==ie&&re.type===He(te,R))}function qe(){l(T)&&O(T,null)}function ee(I){let R=c().some(ie=>I===ie.id)?I:"task";return R!=="task"&&R!=="milestone"&&R!=="summary"&&(R=`task ${R}`),R}function pe(I){f.exec(I.action,I.data)}let G=Q(0),ve=Q(void 0);const Ce=D(()=>d().length&&l(ve)&&l(ve).contains(document.activeElement)),Re=D(()=>l(Ce)&&d()[d().length-1].id);M.subscribe(I=>{if(l(Ce)&&I){const{id:R}=I,ie=l(ve).querySelector(`.wx-bar[data-id='${R}']`);ie&&ie.focus()}});var se=Wf();Et("mouseup",Ma,ne),se.__contextmenu=We,se.__mousedown=[wf,F],se.__mousemove=[xf,ue],se.__touchstart=N,se.__touchmove=X,se.__touchend=oe,se.__click=ce,se.__dblclick=[yf,e,f],Ge(se,21,()=>l(k),I=>I.id,(I,R)=>{var ie=If(),te=q(ie);{var re=$e=>{var Fe=Ef();let Ue;var ot=Y(Fe);{var Qe=ge=>{var Pe=_f();let Ee;j(Oe=>Ee=ye(Pe,1,"wx-link wx-left svelte-m10h26",null,Ee,Oe),[()=>({"wx-visible":l(T),"wx-target":!l(T)||!Se(l(R).id,!0),"wx-selected":l(T)&&l(T).id===l(R).id&&l(T).start})]),b(ge,Pe)};B(ot,ge=>{e.readonly||ge(Qe)})}var st=le(ot,2);{var _t=ge=>{var Pe=pf(),Ee=q(Pe);{var Oe=Je=>{var Ye=kf(),dt=Y(Ye);L(Ye),j(()=>Te(dt,`width:${l(R).progress??""}%`)),b(Je,Ye)};B(Ee,Je=>{l(R).progress&&Je(Oe)})}var at=le(Ee,2);{var kt=Je=>{var Ye=bf(),dt=Y(Ye,!0);L(Ye),j(()=>{Te(Ye,`left:calc(${l(R).progress??""}% - 10px);`),Me(dt,l(R).progress)}),b(Je,Ye)};B(at,Je=>{e.readonly||Je(kt)})}var Dt=le(at,2);{var it=Je=>{const Ye=D(()=>e.taskTemplate);var dt=Z(),_n=q(dt);tt(_n,()=>l(Ye),(Yn,It)=>{It(Yn,{get data(){return l(R)},get api(){return f},onaction:pe})}),b(Je,dt)},Xt=Je=>{var Ye=Sf(),dt=Y(Ye,!0);L(Ye),j(()=>Me(dt,l(R).text||"")),b(Je,Ye)};B(Dt,Je=>{e.taskTemplate?Je(it):Je(Xt,!1)})}b(ge,Pe)},K=ge=>{var Pe=Mf(),Ee=le(q(Pe),2);{var Oe=kt=>{const Dt=D(()=>e.taskTemplate);var it=Z(),Xt=q(it);tt(Xt,()=>l(Dt),(Je,Ye)=>{Ye(Je,{get data(){return l(R)},get api(){return f},onaction:pe})}),b(kt,it)},at=kt=>{var Dt=Tf(),it=Y(Dt,!0);L(Dt),j(()=>Me(it,l(R).text)),b(kt,Dt)};B(Ee,kt=>{e.taskTemplate?kt(Oe):kt(at,!1)})}b(ge,Pe)};B(st,ge=>{l(R).type!=="milestone"?ge(_t):ge(K,!1)})}var de=le(st,2);{var xe=ge=>{var Pe=Cf();let Ee;j(Oe=>Ee=ye(Pe,1,"wx-link wx-right svelte-m10h26",null,Ee,Oe),[()=>({"wx-visible":l(T),"wx-target":!l(T)||!Se(l(R).id,!1),"wx-selected":l(T)&&l(T).id===l(R).id&&!l(T).start})]),b(ge,Pe)};B(de,ge=>{e.readonly||ge(xe)})}L(Fe),j((ge,Pe,Ee)=>{Ue=ye(Fe,1,`wx-bar wx-${ge??""}`,"svelte-m10h26",Ue,Pe),Te(Fe,Ee),De(Fe,"data-tooltip-id",l(R).id),De(Fe,"data-id",l(R).id),De(Fe,"tabindex",l(Re)===l(R).id?"0":"-1")},[()=>ee(l(R).type),()=>({"wx-touch":l(C)&&l(z)&&l(R).id==l(z).id,"wx-selected":l(T)&&l(T).id===l(R).id,"wx-reorder-task":l(R).$reorder}),()=>me(l(R))]),b($e,Fe)};B(te,$e=>{l(R).$skip||$e(re)})}var ze=le(te,2);{var Be=$e=>{var Fe=Df();let Ue;j((ot,Qe)=>{Ue=ye(Fe,1,"wx-baseline svelte-m10h26",null,Ue,ot),Te(Fe,Qe)},[()=>({"wx-milestone":l(R).type==="milestone"}),()=>Ie(l(R))]),b($e,Fe)};B(ze,$e=>{u()&&!l(R).$skip_baseline&&$e(Be)})}b(I,ie)}),L(se),Xe(se,I=>O(ve,I),()=>l(ve)),j(()=>Te(se,`line-height: ${(l(k).length?l(k)[0].$h:0)??""}px`)),Et("dragstart",se,()=>!1),$t(se,"offsetWidth",I=>O(G,I)),b(n,se),he(),r()}je(["contextmenu","mousedown","mousemove","touchstart","touchmove","touchend","click","dblclick"]);var Rf=Ca('<polyline class="wx-line svelte-g5hrsi"></polyline>'),Pf=Ca('<svg class="wx-links svelte-g5hrsi"></svg>');function Lf(n,e){fe(e,!1);const[t,r]=nt(),a=()=>ae(s,"$links",t),s=Ae("gantt-store").getReactiveState()._links;wo();var o=Pf();Ge(o,5,a,c=>c.id,(c,d)=>{var u=Rf();j(()=>De(u,"points",l(d).$p)),b(c,u)}),L(o),b(n,o),he(),r()}var zf=P('<div><div class="wx-content svelte-1yvi8ns"> </div></div>'),Af=P('<div class="wx-markers svelte-1yvi8ns"></div>'),Of=P("<div></div>"),Nf=P('<div class="wx-gantt-holidays svelte-1yvi8ns" style="height:100%;"></div>'),Bf=P('<div class="wx-selected svelte-1yvi8ns"></div>'),Ff=P('<div class="wx-chart svelte-1yvi8ns" tabindex="-1"><!> <div class="wx-area svelte-1yvi8ns"><!> <!> <!> <!> <!></div></div>');function Yf(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(h,"$selected",t),i=()=>ae(w,"$cellHeight",t),s=()=>ae(M,"$context",t),o=()=>ae(m,"$cellWidth",t),c=()=>ae(S,"$zoom",t),d=()=>ae(y,"$scales",t),u=()=>ae(k,"$markers",t),f=Ae("gantt-store"),{_selected:h,scrollLeft:g,scrollTop:v,cellWidth:m,cellHeight:w,_scales:y,zoom:S,context:M,_markers:k,_scrollTask:_}=f.getReactiveState();let x=Q(void 0),T=Q(void 0),z=Q(void 0),p=Q(void 0),C=1;g.subscribe(G=>O(x,G,!0)),v.subscribe(G=>O(T,G,!0));const H=D(()=>{const G=[];return a().length&&i()&&a().forEach(ve=>{G.push([`height: ${i()}px;top: ${ve.$y-3}px`])}),G});Ve(()=>{l(z),X()});const N=D(()=>Math.max(l(z),e.fullHeight));Ve(()=>{l(p).scrollTop=l(T),l(p).scrollLeft=l(x),l(T)!=l(p).scrollTop&&A({top:!0}),l(x)!=l(p).scrollLeft&&A({left:!0})});function F(){A({left:!0,top:!0}),X()}function A(G){const ve={};G.top&&(ve.top=l(p).scrollTop),G.left&&(ve.left=l(p).scrollLeft),f.exec("scroll-chart",ve)}function X(){const G=l(z)||0,ve=Math.ceil(G/i())+1,Ce=Math.floor((l(p).scrollTop||0)/i()),Re=Math.max(0,Ce-C),se=Ce+ve+C,I=Re*i();f.exec("render-data",{start:Re,end:se,from:I})}function ue(G){if(s()||!G)return;const{id:ve,mode:Ce}=G;if(Ce.toString().indexOf("x")<0)return;const{clientWidth:Re}=l(p),se=f.getTask(ve);if(se.$x+se.$w<l(x))O(x,se.$x-o());else if(se.$x>=Re+l(x)){const I=Re<se.$w?o():se.$w;O(x,se.$x-Re+I)}}_.subscribe(G=>ue(G));function ne(G){if(c()&&(G.ctrlKey||G.metaKey)){G.preventDefault();const ve=-Math.sign(G.deltaY),Ce=G.clientX-l(p).getBoundingClientRect().left;f.exec("zoom-scale",{dir:ve,offset:Ce})}}function oe(G){const ve=e.highlightTime(G.date,G.unit);return ve?{css:ve,width:G.width}:null}const $=D(()=>(d().minUnit==="hour"||d().minUnit==="day")&&e.highlightTime?d().rows[d().rows.length-1].cells.map(oe):null);function J(G){G.eventSource="chart",f.exec("hotkey",G)}var U=Ff(),ce=Y(U);{var me=G=>{var ve=Af();Ge(ve,5,u,gt,(Ce,Re)=>{var se=zf(),I=Y(se),R=Y(I,!0);L(I),L(se),j(()=>{ye(se,1,`wx-marker ${l(Re).css||"wx-default"}`,"svelte-1yvi8ns"),Te(se,`left:${l(Re).left??""}px`),Me(R,l(Re).text)}),b(Ce,se)}),L(ve),j(()=>Te(ve,`height:${l(N)??""}px;`)),b(G,ve)};B(ce,G=>{u().length&&G(me)})}var Ie=le(ce,2),We=Y(Ie);{var we=G=>{var ve=Nf();Ge(ve,21,()=>l($),gt,(Ce,Re,se)=>{var I=Z(),R=q(I);{var ie=te=>{var re=Of();j(()=>{ye(re,1,wn(l(Re).css),"svelte-1yvi8ns"),Te(re,`width: ${l(Re).width??""}px; left:${se*l(Re).width}px`)}),b(te,re)};B(R,te=>{l(Re)&&te(ie)})}b(Ce,I)}),L(ve),b(G,ve)};B(We,G=>{l($)&&G(we)})}var He=le(We,2);mf(He,{get borders(){return e.cellBorders}});var Se=le(He,2);{var qe=G=>{var ve=Z(),Ce=q(ve);Ge(Ce,3,a,Re=>Re.id,(Re,se,I)=>{var R=Z(),ie=q(R);{var te=re=>{var ze=Bf();j(()=>{De(ze,"data-id",l(se).id),Te(ze,l(H)[l(I)])}),b(re,ze)};B(ie,re=>{l(se).$y&&re(te)})}b(Re,R)}),b(G,ve)};B(Se,G=>{a().length&&G(qe)})}var ee=le(Se,2);Lf(ee,{});var pe=le(ee,2);Hf(pe,{get readonly(){return e.readonly},get taskTemplate(){return e.taskTemplate}}),L(Ie),L(U),Xe(U,G=>O(p,G),()=>l(p)),pa(()=>$t(U,"clientHeight",G=>O(z,G))),vt(U,(G,ve)=>Cr?.(G,ve),()=>({keys:{arrowup:!0,arrowdown:!0},exec:G=>J(G)})),j(()=>Te(Ie,`width:${e.fullWidth??""}px;height:${l(N)??""}px`)),Et("scroll",U,F),Et("wheel",U,ne),b(n,U),he(),r()}function jf(n,e,t){e.compactMode?t(t()==="chart"?"grid":"chart"):t(t()==="all"?"chart":"all")}function qf(n,e,t){e.compactMode?t(t()==="grid"?"chart":"grid"):t(t()==="all"?"grid":"all")}var Uf=P('<div><div class="wx-button-expand-box svelte-1n0pa5a"><div class="wx-button-expand-content wx-button-expand-left svelte-1n0pa5a"><i class="wxi-menu-left svelte-1n0pa5a"></i></div> <div class="wx-button-expand-content wx-button-expand-right svelte-1n0pa5a"><i class="wxi-menu-right svelte-1n0pa5a"></i></div></div> <div class="wx-resizer-line"></div></div>');function Vf(n,e){fe(e,!0);let t=E(e,"position",3,"after"),r=E(e,"size",3,4),a=E(e,"dir",3,"x"),i=E(e,"value",15,0),s=E(e,"minValue",3,0),o=E(e,"maxValue",3,0),c=E(e,"display",15,"all");function d(H){let N=0;t()=="center"?N=r()/2:t()=="before"&&(N=r());const F={size:[r()+"px","auto"],p:[H-N+"px","0px"],p2:["auto","0px"]};if(a()!="x")for(let A in F)F[A]=F[A].reverse();return F}let u=0,f,h=Q(!1);function g(H){return a()=="x"?H.clientX:H.clientY}function v(H){u=g(H),f=i(),O(h,!0),document.body.style.cursor=l(M),document.body.style.userSelect="none",window.addEventListener("mousemove",w),window.addEventListener("mouseup",y)}let m;function w(H){const N=f+g(H)-u;(!s()||s()<=N)&&(!o()||o()>=N)&&(i(N),m&&clearTimeout(m),m=setTimeout(()=>e.onmove&&e.onmove(i()),100))}function y(){document.body.style.cursor="",document.body.style.userSelect="",O(h,!1),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",y)}const S=D(()=>d(i())),M=D(()=>c()!=="all"?"auto":a()=="x"?"ew-resize":"ns-resize");var k=Uf();let _;k.__mousedown=v;var x=Y(k),T=Y(x),z=Y(T);z.__click=[jf,e,c],L(T);var p=le(T,2),C=Y(p);C.__click=[qf,e,c],L(p),L(x),cr(2),L(k),j(H=>{_=ye(k,1,`wx-resizer wx-resizer-${a()??""} wx-resizer-display-${c()??""}`,"svelte-1n0pa5a",_,H),Te(k,`width:${l(S).size[0]??""}; height: ${l(S).size[1]??""}; cursor:${l(M)??""};`)},[()=>({"wx-resizer-active":l(h)})]),b(n,k),he()}je(["mousedown","click"]);const Xf=650;function Ci(n){let e;function t(){e=new ResizeObserver(a=>{for(let i of a)if(i.target===document.body){let s=i.contentRect.width<=Xf;n(s)}}),e.observe(document.body)}function r(){e&&(e.disconnect(),e=null)}return{observe:t,disconnect:r}}var Kf=P("<!> <!>",1),Gf=P('<div class="wx-gantt svelte-x3mpcm"><div class="wx-pseudo-rows svelte-x3mpcm"><div class="wx-stuck svelte-x3mpcm"><div tabindex="0" class="wx-layout svelte-x3mpcm"><!> <div class="wx-content svelte-x3mpcm"><!> <!></div></div></div></div></div>');function Qf(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(v,"$rColumns",t),i=()=>ae(h,"$rScales",t),s=()=>ae(f,"$rTasks",t),o=()=>ae(g,"$rCellHeight",t),c=()=>ae(m,"$scrollTop",t);let d=E(e,"tableAPI",15);const u=Ae("gantt-store"),{_tasks:f,_scales:h,cellHeight:g,columns:v,scrollTop:m,_scrollTask:w}=u.getReactiveState();let y=Q(!1),S=Q(0),M=Q(void 0),k=Q(void 0),_=Q(void 0),x=Q(void 0),T=Q("all");Ve(()=>{const ee=Ci(p);return ee.observe(),()=>{ee.disconnect()}});let z=null;function p(ee){ee!=l(y)&&(O(y,ee,!0),l(y)?(z=l(T),l(T)=="all"&&O(T,"grid")):(!z||z=="all")&&O(T,"all"))}const C=D(()=>{let ee;return a().every(pe=>pe.width&&!pe.flexgrow)?ee=a().reduce((pe,G)=>pe+parseInt(G.width),0):l(y)&&l(T)==="chart"?ee=parseInt(a().find(pe=>pe.id==="action")?.width)||50:ee=440,ee});Ve(()=>{O(S,l(C),!0)});const H=D(()=>l(M)-l(_)),N=D(()=>i().width),F=D(()=>s().length*o()),A=D(()=>i().height+l(F)+l(H)),X=D(()=>l(S)+l(N));Ve(()=>{let ee;return l(x)&&(ee=new ResizeObserver(ue),ee.observe(l(x))),()=>{ee&&ee.disconnect()}});function ue(){En().then(()=>{if(l(M)>l(X)){const ee=l(M)-l(S);u.exec("expand-scale",{minWidth:ee})}})}let ne=Q(void 0);function oe(){l(ne)&&c()!==l(ne).scrollTop&&(l(ne).scrollTop=c())}Ve(()=>{c(),oe()});function $(){u.exec("scroll-chart",{top:l(ne).scrollTop})}function J(ee){if(!ee||!l(ne))return;const{id:pe}=ee,G=s().findIndex(ve=>ve.id===pe);if(G>-1){const ve=l(k)-i().height,Ce=G*o(),Re=l(ne).scrollTop;let se=null;Ce<Re?se=Ce:Ce+o()>Re+ve&&(se=Ce-ve+o()+l(H)),se!==null&&u.exec("scroll-chart",{top:Math.max(se,0)})}}w.subscribe(J);var U=Gf(),ce=Y(U),me=Y(ce),Ie=Y(me),We=Y(Ie);{var we=ee=>{var pe=Kf(),G=q(pe);gf(G,{get compactMode(){return l(y)},get columnWidth(){return l(C)},get width(){return l(S)},get readonly(){return e.readonly},get fullHeight(){return l(F)},get display(){return l(T)},set display(Ce){O(T,Ce,!0)},get tableAPI(){return d()},set tableAPI(Ce){d(Ce)}});var ve=le(G,2);Vf(ve,{get compactMode(){return l(y)},minValue:"50",maxValue:"800",get value(){return l(S)},set value(Ce){O(S,Ce,!0)},get display(){return l(T)},set display(Ce){O(T,Ce,!0)}}),b(ee,pe)};B(We,ee=>{a().length&&ee(we)})}var He=le(We,2),Se=Y(He);Pc(Se,{get highlightTime(){return e.highlightTime}});var qe=le(Se,2);Yf(qe,{get readonly(){return e.readonly},get fullWidth(){return l(N)},get fullHeight(){return l(F)},get taskTemplate(){return e.taskTemplate},get cellBorders(){return e.cellBorders},get highlightTime(){return e.highlightTime}}),L(He),Xe(He,ee=>O(x,ee),()=>l(x)),L(Ie),vt(Ie,(ee,pe)=>Cr?.(ee,pe),()=>({keys:{"ctrl+c":!0,"ctrl+v":!0,"ctrl+x":!0,"ctrl+d":!0,backspace:!0},exec:ee=>{ee.isInput||u.exec("hotkey",ee)}})),L(me),L(ce),L(U),Xe(U,ee=>O(ne,ee),()=>l(ne)),j(()=>{Te(ce,`height:${l(A)??""}px;width:100%;`),Te(me,`height:${l(k)??""}px;width:${l(_)??""}px;`)}),Et("scroll",U,$),$t(ce,"offsetWidth",ee=>O(_,ee)),$t(U,"offsetHeight",ee=>O(k,ee)),$t(U,"offsetWidth",ee=>O(M,ee)),b(n,U),he(),r()}function Eg(n,e){fe(e,!0);let t=E(e,"taskTemplate",3,null),r=E(e,"markers",19,()=>[]),a=E(e,"taskTypes",3,Kl),i=E(e,"tasks",19,()=>[]),s=E(e,"selected",19,()=>[]),o=E(e,"activeTask",3,null),c=E(e,"links",19,()=>[]),d=E(e,"scales",19,()=>[{unit:"month",step:1,format:"MMMM yyy"},{unit:"day",step:1,format:"d"}]),u=E(e,"columns",3,Hl),f=E(e,"start",3,null),h=E(e,"end",3,null),g=E(e,"lengthUnit",3,"day"),v=E(e,"durationUnit",3,"day"),m=E(e,"cellWidth",3,100),w=E(e,"cellHeight",3,38),y=E(e,"scaleHeight",3,36),S=E(e,"readonly",3,!1),M=E(e,"cellBorders",3,"full"),k=E(e,"zoom",3,!1),_=E(e,"baselines",3,!1),x=E(e,"highlightTime",3,null),T=E(e,"init",3,null),z=E(e,"autoScale",3,!0),p=E(e,"unscheduledTasks",3,!1),C=E(e,"tableAPI",7,null),H=rn(e,["$$slots","$$events","$$legacy","taskTemplate","markers","taskTypes","tasks","selected","activeTask","links","scales","columns","start","end","lengthUnit","durationUnit","cellWidth","cellHeight","scaleHeight","readonly","cellBorders","zoom","baselines","highlightTime","init","autoScale","unscheduledTasks","tableAPI"]);const N=new Ol(Ea);let F=N.in;const A=/-/g;let X=new Pa((ee,pe)=>{const G="on"+ee.replace(A,"");H[G]&&H[G](pe)});F.setNext(X);const ue=N.getState.bind(N),ne=N.getReactive.bind(N),oe=()=>({data:N}),$=F.exec,J=ee=>X=X.setNext(ee),U=F.intercept.bind(F),ce=F.on.bind(F),me=F.detach.bind(F),Ie=ee=>N.getTask(ee),We=()=>N.serialize(),we=ee=>ee?new Promise(pe=>setTimeout(()=>pe(C()),1)):C(),He={getState:ue,getReactiveState:ne,getStores:oe,exec:$,setNext:J,intercept:U,on:ce,detach:me,getTable:we,getTask:Ie,serialize:We};Ln("gantt-store",{getReactiveState:N.getReactive.bind(N),exec:F.exec.bind(F),getTask:N.getTask.bind(N)});let Se=!0;const qe=()=>{N.init({tasks:i(),links:c(),start:f(),columns:u(),end:h(),lengthUnit:g(),cellWidth:m(),cellHeight:w(),scaleHeight:y(),scales:d(),taskTypes:a(),zoom:k(),selected:s(),activeTask:o(),baselines:_(),autoScale:z(),unscheduledTasks:p(),markers:r(),durationUnit:v()}),Se&&T()&&(T()(He),Se=!1)};return qe(),Ve(qe),zn(n,{get words(){return gr},optional:!0,children:(ee,pe)=>{Qf(ee,{get taskTemplate(){return t()},get readonly(){return S()},get cellBorders(){return M()},get highlightTime(){return x()},get tableAPI(){return C()},set tableAPI(G){C(G)}})},$$slots:{default:!0}}),he({getState:ue,getReactiveState:ne,getStores:oe,exec:$,setNext:J,intercept:U,on:ce,detach:me,getTask:Ie,serialize:We,getTable:we})}var Jf=P("<i></i>"),Zf=P("<button><!></button>");function $f(n,e){let t=E(e,"appearance",3,"primary"),r=E(e,"icon",3,"");var a=Zf();a.__click=function(...o){e.onclick?.apply(this,o)};var i=Y(a);{var s=o=>{var c=Jf();j(()=>ye(c,1,`wx-button-icon ${r()??""}`,"svelte-1js3q4i")),b(o,c)};B(i,o=>{r()&&o(s)})}L(a),j(()=>ye(a,1,`wx-button ${t()??""}`,"svelte-1js3q4i")),b(n,a)}je(["click"]);class eh{constructor(){this.store=new Map}limit(e){this._scope=e}isActive(){return!this._scope||this._scope()}add(e,t){this.store.set(e.toLowerCase().replace(/[ ]/g,""),t)}}const en=[],th={subscribe:n=>{nh();const e=new eh;return en.push(e),n(e),()=>{const t=en.findIndex(r=>r===e);t>=0&&en.splice(t,1)}}};var _a=!1;function nh(){_a||(_a=!0,document.addEventListener("keydown",n=>{if(en.length&&(n.ctrlKey||n.altKey||n.metaKey||n.shiftKey||n.key.length>1||n.key===" ")){const e=[];n.ctrlKey&&e.push("ctrl"),n.altKey&&e.push("alt"),n.metaKey&&e.push("meta"),n.shiftKey&&e.push("shift");let t=n.key.toLocaleLowerCase();n.key===" "&&(t="space"),e.push(t);const r=e.join("+");for(let a=en.length-1;a>=0;a--){const i=en[a],s=i.store.get(r)||i.store.get(t),o=n.target.tagName;if(s&&o!=="INPUT"&&o!=="TEXTAREA"&&i.isActive()){s(n),n.preventDefault();return}}}}))}var rh=P('<div tabindex="0" class="wx-fullscreen svelte-uvwbdg"><!> <div class="wx-fullscreen-icon svelte-uvwbdg"><!></div></div>');function Dg(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(th,"$hotkeys",t);let i=E(e,"hotkey",3,null);Ve(()=>{i()&&a().add(i(),c)});let s=null,o=Q(!1);function c(){let v=!l(o);v&&s?s.requestFullscreen():l(o)&&document.exitFullscreen(),O(o,v)}const d=()=>{O(o,document.fullscreenElement===s)};Ve(()=>(document.addEventListener("fullscreenchange",d),()=>{document.removeEventListener("fullscreenchange",d)}));var u=rh(),f=Y(u);ct(f,()=>e.children??Vt);var h=le(f,2),g=Y(h);{let v=D(()=>l(o)?"collapse":"expand");$f(g,{appearance:"transparent",get icon(){return`wxi-${l(v)??""}`},onclick:()=>c()})}L(h),L(u),Xe(u,v=>s=v,()=>s),b(n,u),he(),r()}const Ei={};function ah(n){return Ei[n]||n}function on(n,e){Ei[n]=e}var ih=P("<div>&nbsp;</div>");function Di(n,e){let t=E(e,"menu",3,!1);var r=ih();j(()=>ye(r,1,`wx-separator${t()?"-menu":""}`,"svelte-1eu7qav")),b(n,r)}var oh=P('<div class="wx-spacer svelte-1mbb7ow"></div>');function Ii(n){var e=oh();b(n,e)}var sh=P("<div><!></div>");function Ir(n,e){fe(e,!0);let t=E(e,"item",19,()=>({})),r=E(e,"menu",3,!1),a=D(()=>ah(t().comp||"label"));function i(){t().handler&&t().handler(t()),e.onclick&&e.onclick({item:t()})}let s=D(()=>t().key?e.values[t().key]:void 0);function o({value:g}){t().handler&&t().handler(t(),g),e.onchange&&e.onchange({value:g,item:t()})}const c=D(()=>r()&&t().menuText||t().text);var d=Z(),u=q(d);{var f=g=>{Ii(g)},h=g=>{var v=Z(),m=q(v);{var w=S=>{Di(S,{get menu(){return r()}})},y=S=>{const M=D(()=>l(a));var k=sh();let _;var x=Y(k);tt(x,()=>l(M),(T,z)=>{z(T,mt({get value(){return l(s)},onchange:o,onclick:i,get text(){return l(c)},get menu(){return r()}},t))}),L(k),j(T=>{_=ye(k,1,`wx-tb-element ${(t().css||"")??""}`,"svelte-ptl7r2",_,T),De(k,"data-id",t().id)},[()=>({"wx-spacer":t().spacer,"wx-menu":r()})]),b(S,k)};B(m,S=>{t().comp=="separator"?S(w):S(y,!1)},!0)}b(g,v)};B(u,g=>{t().comp=="spacer"?g(f):g(h,!1)})}b(n,d),he()}const lh=(n,e)=>O(e,!1);var ch=P("<i></i>"),dh=P('<div class="wx-label-text"> </div>'),uh=P('<i class="wx-label-arrow wxi-angle-down"></i>'),fh=P('<div class="wx-drop-group"><!></div>'),hh=P('<div class="wx-collapsed svelte-155fw4u"><!> <!> <!></div> <!>',1),gh=P('<div class="wx-label svelte-155fw4u"> </div>'),vh=P('<div class="wx-tb-body svelte-155fw4u"></div> <!>',1),mh=P("<div><!></div>");function Pn(n,e){fe(e,!0);let t=E(e,"values",3,null),r=E(e,"menu",3,!1),a=Q(!0);const i=h=>{s(),e.onclick&&e.onclick(h)},s=()=>O(a,!0);var o=mh();let c;var d=Y(o);{var u=h=>{var g=hh(),v=q(g);v.__click=[lh,a];var m=Y(v);{var w=T=>{var z=ch();j(()=>ye(z,1,`icon ${e.item.icon??""}`,"svelte-155fw4u")),b(T,z)};B(m,T=>{e.item.icon&&T(w)})}var y=le(m,2);{var S=T=>{var z=dh(),p=Y(z,!0);L(z),j(()=>Me(p,e.item.text)),b(T,z)};B(y,T=>{e.item.text&&T(S)})}var M=le(y,2);{var k=T=>{var z=uh();b(T,z)};B(M,T=>{e.item.text&&!e.item.icon&&T(k)})}L(v);var _=le(v,2);{var x=T=>{dr(T,{width:"",oncancel:s,children:(z,p)=>{var C=fh(),H=Y(C);{let N=D(()=>({...e.item,text:"",collapsed:!1}));Pn(H,{get item(){return l(N)},get values(){return t()},get menu(){return r()},get onchange(){return e.onchange},onclick:i})}L(C),b(z,C)},$$slots:{default:!0}})};B(_,T=>{l(a)||T(x)})}b(h,g)},f=h=>{var g=vh(),v=q(g);Ge(v,21,()=>e.item.items,gt,(y,S)=>{var M=Z(),k=q(M);{var _=T=>{Pn(T,{get item(){return l(S)},get values(){return t()},onclick:i,get onchange(){return e.onchange}})},x=T=>{Ir(T,{get item(){return l(S)},get values(){return t()},onclick:i,get onchange(){return e.onchange}})};B(k,T=>{l(S).items?T(_):T(x,!1)})}b(y,M)}),L(v);var m=le(v,2);{var w=y=>{var S=gh(),M=Y(S,!0);L(S),j(()=>Me(M,e.item.text)),b(y,S)};B(m,y=>{e.item.text&&y(w)})}b(h,g)};B(d,h=>{e.item.collapsed&&!r()?h(u):h(f,!1)})}L(o),j(h=>c=ye(o,1,`wx-tb-group ${(e.item.css||"")??""}`,"svelte-155fw4u",c,h),[()=>({"wx-column":e.item.layout=="column","wx-group-collapsed":e.item.collapsed&&!r()})]),b(n,o),he()}je(["click"]);var wh=P('<div class="wx-drop-menu svelte-7mtmlh"></div>'),xh=P('<div data-id="$menu"><!> <!></div>');function yh(n,e){fe(e,!0);let t=E(e,"items",19,()=>[]),r=Q(void 0),a=Q(void 0);function i(){O(r,null)}function s(){O(r,!0)}function o(h){i(),e.onclick&&e.onclick(h)}var c=xh(),d=Y(c);ur(d,{icon:"wxi-dots-h",onclick:s});var u=le(d,2);{var f=h=>{dr(h,{get width(){return`${e.width??""}px`},oncancel:i,children:(g,v)=>{var m=wh();Ge(m,21,t,gt,(w,y)=>{var S=Z(),M=q(S);{var k=x=>{Pn(x,{get item(){return l(y)},get values(){return e.values},menu:!0,onclick:o,get onchange(){return e.onchange}})},_=x=>{Ir(x,{get item(){return l(y)},get values(){return e.values},menu:!0,onclick:o,get onchange(){return e.onchange}})};B(M,x=>{l(y).items?x(k):x(_,!1)})}b(w,S)}),L(m),b(g,m)},$$slots:{default:!0}})};B(u,h=>{l(r)&&h(f)})}L(c),Xe(c,h=>O(a,h),()=>l(a)),j(()=>ye(c,1,`wx-menu ${(e.css||"")??""}`,"svelte-7mtmlh")),b(n,c),he()}var _h=P("<div><!> <!></div>");function Wi(n,e){fe(e,!0);let t=E(e,"items",31,()=>Ze([])),r=E(e,"menuCss",3,""),a=E(e,"values",15,null),i=E(e,"overflow",3,"menu");function s(_){a()&&(a(a()[_.item.key]=_.value,!0),a(a())),e.onchange&&e.onchange(_)}let o=null,c=-1,d=Q(Ze([]));function u(){if(i()==="wrap")return;const _=o.clientWidth;if(o.scrollWidth>_){if(i()==="collapse")return h();const z=o.children;let p=0;for(let C=0;C<t().length;C++){if(p+=z[C].clientWidth,t()[C].comp=="separator"&&(p+=8),p>_-40){if(c===C)return;c=C,O(d,[],!0);for(let H=C;H<t().length;H++)l(d).push(t()[H]),z[H].style.visibility="hidden";C>0&&t()[C-1].comp=="separator"&&(z[C-1].style.visibility="hidden");break}z[C].style.visibility=""}}else{const z=_-f();if(z<=0)return;if(i()==="collapse")return g(z);if(l(d).length){c=null;const p=o.children;for(let C=0;C<t().length;C++)p[C].style.visibility="";O(d,[],!0)}}}function f(){const _=o.children;let x=0;for(let T=0;T<t().length;T++)t()[T].comp!="spacer"&&(x+=_[T].clientWidth,t()[T].comp=="separator"&&(x+=8));return x}function h(){for(let _=t().length-1;_>=0;_--)if(t()[_].items&&!t()[_].collapsed){t(t()[_].collapsed=!0,!0),t(t()[_].$width=o.children[_].offsetWidth,!0),En().then(u),t([...t()]);return}}function g(_){for(let x=0;x<t().length;x++)if(t()[x].collapsed&&t()[x].$width){t()[x].$width-o.children[x].offsetWidth<_+10&&(t(t()[x].collapsed=!1,!0),En().then(u)),t([...t()]);return}}function v(_){return _.forEach(x=>{x.id||(x.id=Vc())}),_}Rt(()=>{const _=new ResizeObserver(()=>u());return _.observe(o),()=>{_&&_.unobserve(o)}});const m=D(()=>v(t()));var w=_h();let y;var S=Y(w);Ge(S,17,()=>l(m),gt,(_,x)=>{var T=Z(),z=q(T);{var p=H=>{Pn(H,{get item(){return l(x)},get values(){return a()},get onclick(){return e.onclick},onchange:s})},C=H=>{Ir(H,{get item(){return l(x)},get values(){return a()},get onclick(){return e.onclick},onchange:s})};B(z,H=>{l(x).items?H(p):H(C,!1)})}b(_,T)});var M=le(S,2);{var k=_=>{yh(_,{get items(){return l(d)},get css(){return r()},get values(){return a()},get onclick(){return e.onclick},onchange:s})};B(M,_=>{l(d).length&&_(k)})}L(w),Xe(w,_=>o=_,()=>o),j(_=>y=ye(w,1,`wx-toolbar ${e.css??""}`,"svelte-b19ms9",y,_),[()=>({"wx-wrap":i()==="wrap"})]),b(n,w),he()}var kh=P('<div class="wx-item svelte-b4dkf1"><i></i> </div>');function bh(n,e){let t=E(e,"text",3,"");var r=Z(),a=q(r);{var i=o=>{var c=kh();c.__click=function(...f){e.onclick?.apply(this,f)};var d=Y(c),u=le(d);L(c),j(()=>{ye(d,1,`${e.icon||"wxi-empty"} ${(e.css||"")??""}`,"svelte-b4dkf1"),Me(u,` ${t()??""}`)}),b(o,c)},s=o=>{ur(o,{get icon(){return e.icon},get type(){return e.type},get css(){return e.css},get text(){return t()},get disabled(){return e.disabled},get onclick(){return e.onclick}})};B(a,o=>{e.menu?o(i):o(s,!1)})}b(n,r)}je(["click"]);var Sh=P('<div class="wx-label svelte-agyr5c"><!></div>'),ph=P('<div class="wx-label svelte-agyr5c"> </div>');function Th(n,e){var t=Z(),r=q(t);{var a=s=>{var o=Sh(),c=Y(o);ct(c,()=>e.children),L(o),b(s,o)},i=s=>{var o=ph(),c=Y(o,!0);L(o),j(()=>Me(c,e.value||e.text)),b(s,o)};B(r,s=>{e.children?s(a):s(i,!1)})}b(n,t)}var Mh=P("<i></i>"),Ch=P('<div class="wx-item svelte-ng2v87"><!> </div>');function Eh(n,e){var t=Z(),r=q(t);{var a=s=>{var o=Ch();o.__click=function(...f){e.onclick?.apply(this,f)};var c=Y(o);{var d=f=>{var h=Mh();j(()=>ye(h,1,`${e.icon??""} ${e.css??""}`,"svelte-ng2v87")),b(f,h)};B(c,f=>{e.icon&&f(d)})}var u=le(c);L(o),j(()=>Me(u,` ${e.text??""}`)),b(s,o)},i=s=>{ur(s,{get icon(){return e.icon},get type(){return e.type},get css(){return e.css},get title(){return e.text},get disabled(){return e.disabled},get onclick(){return e.onclick}})};B(r,s=>{e.menu?s(a):s(i,!1)})}b(n,t)}je(["click"]);function Dh(n,e,t){e.onclick&&e.onclick({id:t()})}var Ih=P("<i></i>"),Wh=P("<div><!> </div>");function Hh(n,e){fe(e,!0);let t=E(e,"id",3,""),r=E(e,"text",3,""),a=E(e,"css",3,""),i=E(e,"icon",3,"");var s=Wh();s.__click=[Dh,e,t];var o=Y(s);{var c=u=>{var f=Ih();j(()=>ye(f,1,wn(i()),"svelte-g7c8cw")),b(u,f)};B(o,u=>{i()&&u(c)})}var d=le(o);L(s),j(()=>{ye(s,1,`wx-label ${a()??""}`,"svelte-g7c8cw"),Me(d,` ${r()??""}`)}),b(n,s),he()}je(["click"]);on("button",bh);on("separator",Di);on("spacer",Ii);on("label",Th);on("item",Hh);on("icon",Eh);function Ig(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(f,"$rSelected",t),i=()=>ae(h,"$rTasks",t);let s=E(e,"api",3,null),o=E(e,"items",19,()=>[...Jr]),c=Ae("wx-i18n");c||(c=Dr(gr),Ln("wx-i18n",c));const d=Ae("wx-i18n").getGroup("gantt"),u=D(()=>o().map(v=>(v={...v,disabled:!1},v.handler=pr(Jr,v.id)?m=>Zt(s(),m.id,null,d):v.handler,v.text&&(v.text=d(v.text)),v.menuText&&(v.menuText=d(v.menuText)),v)));let f,h;const g=D(()=>{if(s()){const v=s().getReactiveState();if(f=v._selected,h=v._tasks,a()?.length)return l(u).map(m=>{if(!m.check)return m;const w=a().some(y=>!m.check(y,i()));return{...m,disabled:w}})}return[{...l(u)[0],disabled:!1}]});Wi(n,{get items(){return l(g)}}),he(),r()}var Rh=P('<!> <span data-menu-ignore="true"><!></span>',1);function Wg(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(m,"$rTaskTypes",t),i=()=>ae(w,"$rSelected",t),s=()=>ae(y,"$rTasks",t),o=()=>ae(S,"$rSelectedTasks",t);let c=E(e,"options",19,()=>[...Qr]),d=E(e,"api",3,null),u=E(e,"resolver",3,null),f=E(e,"filter",3,null),h=E(e,"at",3,"point"),g=null,v,m,w,y,S,M=Ae("wx-i18n");M||(M=Dr({...gr,...no}),Ln("wx-i18n",M));const k=Ae("wx-i18n").getGroup("gantt");function _(){const $=c().find(J=>J.id==="convert-task");return $&&($.data=[],a().forEach(J=>{$.data.push($.dataFactory(J))})),x(c())}function x($){return $.map(J=>(J={...J},J.text&&(J.text=k(J.text)),J.subtext&&(J.subtext=k(J.subtext)),J.data&&(J.data=x(J.data)),J))}function T($,J){let U=$?d().getTask($):null;if(u()){const ce=u()($,J);U=ce===!0?U:ce}return U&&(w=d().getReactiveState().selected,g=U.id,i().includes(U.id)||d().exec("select-task",{id:U.id})),U}function z($){const J=$.action;J&&(pr(Qr,J.id)&&Zt(d(),J.id,g,k),e.onclick&&e.onclick($))}function p($,J){const U=l(H).length?l(H):J?[J]:[];let ce=f()?f()($,J):!0;if($.check&&ce){const me=U.some(Ie=>!$.check(Ie,s()));$.css=me?"wx-disabled":""}return ce}const C=D(()=>d()?(v=d().getReactiveState(),m=v.taskTypes,y=v._tasks,w=v.selected,S=v._selected,d().on("scroll-chart",()=>l(N).show()),d().on("drag-task",()=>l(N).show()),_()):null);let H=D(()=>o()||[]),N=Q(void 0);function F($,J){l(N).show($,J)}var A=Rh(),X=q(A);Xe(Mi(X,{filter:p,get options(){return l(C)},dataKey:"id",resolver:T,onclick:z,get at(){return h()}}),$=>O(N,$,!0),()=>l(N));var ue=le(X,2);ue.__contextmenu=function(...$){l(N).show?.apply(this,$)};var ne=Y(ue);ct(ne,()=>e.children??Vt),L(ue),b(n,A);var oe=he({show:F});return r(),oe}je(["contextmenu"]);const lr={};function ka(n){return lr[n]||lr.text}function St(n,e){lr[n]=e}const Ph={editor:{}};var Lh=P('<div class="wx-overlay svelte-8ivub6"> </div>'),zh=P('<div class="wx-message svelte-8ivub6"> </div>'),Ah=P("<div><!> <!></div>"),Oh=P("<div><!> <!> <!></div>");function Xn(n,e){fe(e,!0);let t=E(e,"css",3,""),r=E(e,"focus",3,!1),a=Q(void 0);Rt(()=>{if(r()){const g=document.activeElement;if(g&&l(a).contains(g))return;const v=l(a).querySelector("input:not([disabled]), textarea:not([disabled]), select:not([disabled])");v&&setTimeout(()=>{v.select(),v.focus()},300)}});const i=Ae("wx-i18n").getGroup("editor");let s=D(()=>e.editors.config[0].comp==="readonly"&&e.editors.config.every(g=>!Object.keys(e.data).includes(g.key)));var o=Oh(),c=Y(o);{var d=g=>{var v=Z(),m=q(v);ct(m,()=>e.children),b(g,v)};B(c,g=>{e.children&&g(d)})}var u=le(c,2);{var f=g=>{var v=Lh(),m=Y(v,!0);L(v),j(w=>Me(m,w),[()=>i("No data")]),b(g,v)};B(u,g=>{l(s)&&g(f)})}var h=le(u,2);Ge(h,17,()=>e.editors.config,gt,(g,v)=>{var m=Z(),w=q(m);{var y=S=>{var M=Z(),k=q(M);{var _=T=>{const z=D(()=>ka(l(v).comp));var p=Z(),C=q(p);tt(C,()=>l(z),(H,N)=>{N(H,mt({get label(){return l(v).label},get value(){return e.data[l(v).key]}},()=>l(v),{get onclick(){return e.onclick}}))}),b(T,p)},x=T=>{var z=Ah(),p=Y(z);{const N=(A,X)=>{let ue=()=>X?.().id;const ne=D(()=>ka(l(v).comp));var oe=Z(),$=q(oe);{let J=D(()=>e.errors&&e.errors[l(v).key]);tt($,()=>l(ne),(U,ce)=>{ce(U,mt(()=>l(v),{onchange:me=>{e.onchange&&e.onchange({value:me.value,key:l(v).key,input:me.input})},get id(){return ue()},label:void 0,get error(){return l(J)},get value(){return e.data[l(v).key]}}))})}b(A,oe)};let F=D(()=>l(v).labelTemplate?l(v).labelTemplate(e.data[l(v).key]):l(v).label??"");fr(p,{get label(){return l(F)},get required(){return l(v).required},children:N,$$slots:{default:!0}})}var C=le(p,2);{var H=N=>{var F=zh(),A=Y(F,!0);L(F),j(()=>Me(A,l(v).validationMessage)),b(N,F)};B(C,N=>{e.errors&&e.errors[l(v).key]&&l(v).validationMessage&&N(H)})}L(z),b(T,z)};B(k,T=>{l(v).comp==="readonly"||l(v).comp==="section"?T(_):T(x,!1)})}b(S,M)};B(w,S=>{l(v).hidden||S(y)})}b(g,m)}),L(o),Xe(o,g=>O(a,g),()=>l(a)),j(()=>ye(o,1,`wx-sections ${t()??""}`,"svelte-8ivub6")),b(n,o),he()}function Nh(n){if(typeof n=="string"&&n.includes(".")){const e=n.split(".");return t=>{let r=t;return e.forEach(a=>{r=r[a]}),r}}return e=>e[n]}function Bh(n){if(typeof n=="string"&&n.includes(".")){const e=n.split(".");return(t,r)=>{let a=t;e.forEach((i,s)=>{s===e.length-1?a[i]=r:a=a[i]})}}return(e,t)=>e[n]=t}function Fh(n){const e=n.map(s=>{const o={...s};return s.config&&Object.assign(o,s.config),o.key=s.key||So(),o.setter=s.setter||Bh(s.key),o.getter=s.getter||Nh(s.key),o}),t=s=>{const o={};return e.forEach(c=>{c.comp!=="section"&&(c.getter?o[c.key]=c.getter(s):o[c.key]=s[c.key])}),o},r=(s,o,c)=>((c.length?c.map(u=>e.find(f=>f.key===u)):e).forEach(u=>{u.setter?u.setter(s,o[u.key]):s[u.key]=o[u.key]}),s),a=(s,o)=>{const c=t(s),d=[];return e.forEach(u=>{const f=c[u.key],h=o[u.key];!An(f,h)&&(f!==void 0||h)&&d.push(u.key)}),d},i=(s,o,c)=>{let d=0;const u={};return(o?.length?o.map(h=>e.find(g=>g.key===h)):e).forEach(h=>{h.required&&!s[h.key]?(u[h.key]={errorType:"required"},h.validationMessage=h.validationMessage??c("This field is required"),d++):h.validation&&!h.validation(s[h.key])&&(u[h.key]={errorType:"validation"},h.validationMessage=h.validationMessage??c("Invalid value"),d++)}),d>0?u:null};return{config:e.filter(s=>s.comp!=="hidden"),getValues:t,setValues:r,diff:a,validateValues:i}}function Yh(n){let e=Q(void 0);const t=D(()=>{const r=n();return typeof l(e)<"u"?l(e):r});return[()=>l(t),r=>{O(e,r,!0)}]}function jh(n){const[e,t]=Yh(n);return{get errors(){return e()},set errors(r){t(r)}}}function qh(n,e){fe(e,!0);const t=Ae("wx-i18n").getGroup("editor");let r=E(e,"values",7),a=E(e,"topBar",3,!0),i=E(e,"bottomBar",3,!0),s=E(e,"layout",3,"default"),o=E(e,"placement",3,"inline"),c=Q(null);const d=D(()=>{const x=Fh(e.items);l(c)&&x.config.forEach(p=>{p.comp==="section"&&p.key===l(c)&&(p.sectionMode==="accordion"?p.active||(x.config.forEach(C=>{C.comp==="section"&&C.key!==p.key&&(C.active=!1)}),p.active=!0):p.active=!p.active)});let T=new Set,z=null;return x.config.forEach(p=>{p.sectionMode==="exclusive"&&p.active&&(z=p.key),p.active&&T.add(p.key)}),x.config.forEach(p=>{p.hidden=p.hidden||e.activeBatch&&e.activeBatch!==p.batch||z&&p.key!=z&&p.section!==z||p.section&&!T.has(p.section)}),e.readonly?{...x,config:x.config.map(p=>({...p,comp:"readonly"})),diff:()=>[]}:x});let u=Q(Ze({})),f=Q(Ze({}));$i(()=>{r(),Ta(()=>{O(u,Dn(r()),!0),O(f,Dn(r()),!0)})});let h=jh(()=>r()&&null),g=Q(Ze([]));Ve(()=>r()&&O(g,[],!0));function v({value:x,key:T,input:z}){l(f)[T]=x;const p={key:T,value:x,update:l(f)};if(z&&(p.input=z),e.onchange&&e.onchange(p),!r())return;O(f,p.update,!0);const C=l(d).diff(r(),l(f));if(O(u,l(d).setValues({...l(u)},l(f),w([...C,T])),!0),C.length){const H=e.autoSave?[]:w([...C,...Object.keys(h.errors??{}),T]);h.errors=y(H),m(C)}else{const H=Object.keys(h.errors??{});H.length&&(h.errors=y(H)),O(g,[],!0)}}function m(x){e.autoSave&&!h.errors?(l(d).setValues(r(),l(f),x),e.onsave&&e.onsave({changes:x,values:l(u)})):O(g,x,!0)}function w(x){return[...new Set(x)]}function y(x){const T=l(d).validateValues(l(u),x,t);return An(T,h.errors)||e.onvalidation&&e.onvalidation({errors:T,values:l(u)}),T}function S({item:x}){x.id==="save"?M():x.id==="toggle-section"&&O(c,x.key,!0),e.onaction&&e.onaction({item:x,values:l(u),changes:l(g)})}function M(){l(g).length&&(e.autoSave||(h.errors=y()),h.errors||(e.onsave&&e.onsave({changes:l(g),values:l(u)}),l(d).setValues(r(),l(f),l(g)),O(g,[],!0),r({...l(u)})))}var k=Z(),_=q(k);tt(_,()=>e.view,(x,T)=>{T(x,{get topBar(){return a()},get bottomBar(){return i()},get placement(){return o()},get layout(){return s()},get readonly(){return e.readonly},get autoSave(){return e.autoSave},get css(){return e.css},get data(){return l(f)},get editors(){return l(d)},get focus(){return e.focus},get errors(){return h.errors},onclick:S,onkeydown:S,onchange:v,children:(z,p)=>{var C=Z(),H=q(C);{var N=F=>{var A=Z(),X=q(A);ct(X,()=>e.children),b(F,A)};B(H,F=>{e.children&&F(N)})}b(z,C)},$$slots:{default:!0}})}),b(n,k),he()}function Uh(n,{keys:e,action:t}){function r(a){let i=a.code.replace("Key","").toLowerCase();const s=`${a.ctrlKey||a.metaKey?"ctrl+":""}${i}`,o=e[s];if(!o)return;const c=a.target.closest(".wx-combo")||a.target.closest(".wx-multicombo")||a.target.closest(".wx-richselect");c&&c.querySelector(".wx-list")||(a.preventDefault(),t(o))}return n.addEventListener("keydown",r),{destroy:()=>{n.removeEventListener("keydown",r)}}}var Vh=P('<div class="wx-cols svelte-16omdl8"><div class="wx-left svelte-16omdl8"><!></div> <div class="wx-right svelte-16omdl8"><!></div></div>');function Xh(n,e){fe(e,!0);let t=D(()=>{let o=[];if(e.layout==="columns"&&(o=[{...e.editors,config:[]},{...e.editors,config:[]}],e.editors.config.forEach(c=>{const d=c.column==="left"?0:1;o[d].config.push(c)}),o[0].config.length)){const c=o[0].config[0];c.comp==="text"&&(o[0][0]={...c,css:"title",label:""})}return o});var r=Z(),a=q(r);{var i=o=>{var c=Vh(),d=Y(c),u=Y(d);Xn(u,{get editors(){return l(t)[0]},get data(){return e.data},get errors(){return e.errors},get onclick(){return e.onclick},get onchange(){return e.onchange}}),L(d);var f=le(d,2),h=Y(f);Xn(h,{get editors(){return l(t)[1]},get data(){return e.data},get focus(){return e.focus},get errors(){return e.errors},get onclick(){return e.onclick},get onchange(){return e.onchange}}),L(f),L(c),b(o,c)},s=o=>{Xn(o,{get editors(){return e.editors},get data(){return e.data},get focus(){return e.focus},get errors(){return e.errors},get onclick(){return e.onclick},get onchange(){return e.onchange}})};B(a,o=>{e.layout==="columns"?o(i):o(s,!1)})}b(n,r),he()}var Kh=P("<div><!></div>");function ba(n,e){fe(e,!0);let t=E(e,"values",3,null),r=E(e,"top",3,!0);const a=({item:c,value:d})=>{e.onchange&&e.onchange({key:c.key,value:d})};var i=Z(),s=q(i);{var o=c=>{var d=Kh();let u;var f=Y(d);{let h=D(()=>yo(t()));Wi(f,{get items(){return e.items},get values(){return l(h)},get onclick(){return e.onclick},onchange:a})}L(d),j(h=>u=ye(d,1,"wx-editor-toolbar svelte-6i7qc5",null,u,h),[()=>({"wx-topbar":r(),"wx-bottom":!r()})]),b(c,d)};B(s,c=>{e.items.length&&c(o)})}b(n,i),he()}const dn=()=>({comp:"spacer"}),Kn=n=>({comp:"button",text:n("Cancel"),id:"cancel"}),Gn=n=>({type:"primary",comp:"button",text:n("Save"),id:"save"}),Sa=()=>({comp:"icon",icon:"wxi-close",id:"close"});var Gh=P("<div><!> <div><!> <!> <!></div></div>");function Qn(n,e){fe(e,!0);const t=Ae("wx-i18n").getGroup("editor");let r=D(()=>e.topBar===!0&&e.bottomBar===!0),a=D(()=>{let m=e.topBar&&e.topBar.items?e.topBar.items.map(w=>({...w})):[];return l(r)&&(e.readonly?m=[dn(),Sa()]:(e.autoSave?m=[dn(),Sa()]:e.placement!=="modal"&&(m=[dn(),Kn(t),Gn(t)]),e.layout==="columns"&&!m.length&&(m=[dn(),Gn(t),Kn(t)]))),m}),i=D(()=>{let m=e.bottomBar&&e.bottomBar.items?e.bottomBar.items.map(w=>({...w})):[];return l(r)&&(e.readonly||(e.placement==="modal"&&!e.autoSave&&(m=[dn(),Gn(t),Kn(t)]),e.layout==="columns"&&l(a).length&&(m=[]))),m}),s=D(()=>[...l(a),...l(i)]);var o=Gh(),c=Y(o);ba(c,mt(()=>e.topBar,{get items(){return l(a)},get values(){return e.data},get onclick(){return e.onclick},get onchange(){return e.onchange}}));var d=le(c,2);let u;var f=Y(d);{var h=m=>{var w=Z(),y=q(w);ct(y,()=>e.children),b(m,w)};B(f,m=>{e.children&&m(h)})}var g=le(f,2);Xh(g,{get editors(){return e.editors},get layout(){return e.layout},get data(){return e.data},get focus(){return e.focus},get errors(){return e.errors},get onclick(){return e.onclick},get onchange(){return e.onchange}});var v=le(g,2);ba(v,mt(()=>e.bottomBar,{get items(){return l(i)},get values(){return e.data},top:!1,get onclick(){return e.onclick},get onchange(){return e.onchange}})),L(d),L(o),vt(o,(m,w)=>Uh?.(m,w),()=>({keys:{"ctrl+s":l(s).find(m=>m.id==="save"),escape:l(s).find(m=>m.id==="cancel"||m.id==="close"),"ctrl+d":l(s).find(m=>m.id==="delete")},action:m=>{e.onkeydown&&e.onkeydown({item:m})}})),j(m=>{ye(o,1,wn(e.css),"svelte-u4cjyu"),u=ye(d,1,"wx-content svelte-u4cjyu",null,u,m)},[()=>({"wx-layout-columns":e.layout==="columns"})]),b(n,o),he()}function Qh(n,e){fe(e,!0);let t=rn(e,["$$slots","$$events","$$legacy","css","onclick","placement"]);function r(){e.onclick&&e.onclick({item:{id:"close"}})}var a=Z(),i=q(a);{var s=c=>{ro(c,{children:(d,u)=>{{let f=D(()=>`wx-panel ${e.css}`);Qn(d,mt({get css(){return l(f)},get onclick(){return e.onclick},get placement(){return e.placement}},()=>t))}}})},o=c=>{var d=Z(),u=q(d);{var f=g=>{ao(g,{oncancel:r,children:(v,m)=>{{let w=D(()=>`wx-panel ${e.css}`);Qn(v,mt({get css(){return l(w)},get onclick(){return e.onclick},get placement(){return e.placement}},()=>t))}},$$slots:{default:!0}})},h=g=>{{let v=D(()=>`wx-inline-form ${e.css}`);Qn(g,mt({get css(){return l(v)},get onclick(){return e.onclick},get placement(){return e.placement}},()=>t))}};B(u,g=>{e.placement==="sidebar"?g(f):g(h,!1)},!0)}b(c,d)};B(i,c=>{e.placement==="modal"?c(s):c(o,!1)})}b(n,a),he()}function Jh(n,e){let t=E(e,"values",19,()=>({})),r=E(e,"items",19,()=>[]),a=E(e,"css",3,""),i=E(e,"activeBatch",3,null),s=E(e,"topBar",3,!0),o=E(e,"bottomBar",3,!0),c=E(e,"focus",3,!1),d=E(e,"autoSave",3,!1),u=E(e,"autoApply",3,!1),f=E(e,"layout",3,"default"),h=E(e,"readonly",3,!1),g=E(e,"placement",3,"inline"),v=rn(e,["$$slots","$$events","$$legacy","values","items","css","activeBatch","topBar","bottomBar","focus","autoSave","autoApply","layout","readonly","placement","children"]);zn(n,{get words(){return Ph},optional:!0,children:(m,w)=>{qh(m,mt({get view(){return Qh},get values(){return t()},get items(){return r()},get css(){return a()},get activeBatch(){return i()},get topBar(){return s()},get bottomBar(){return o()},get focus(){return c()},get autoSave(){return d()},get autoApply(){return u()},get layout(){return f()},get readonly(){return h()},get placement(){return g()}},()=>v,{children:(y,S)=>{var M=Z(),k=q(M);{var _=x=>{var T=Z(),z=q(T);ct(z,()=>e.children),b(x,T)};B(k,x=>{e.children&&x(_)})}b(y,M)},$$slots:{default:!0}}))},$$slots:{default:!0}})}function Zh(n,e){fe(e,!0);const t=Ae("wx-i18n").getGroup("editor");let r=D(()=>{let o=e.value;if(typeof e.value=="boolean"&&(o=e.value?t("Yes"):t("No")),e.options){const c=e.options.find(d=>d.id===e.value);c&&(o=c.label)}return o});var a=Z(),i=q(a);{var s=o=>{fr(o,{get label(){return e.label},children:(c,d)=>{cr();var u=wt();j(()=>Me(u,l(r))),b(c,u)},$$slots:{default:!0}})};B(i,o=>{(l(r)||l(r)===0)&&o(s)})}b(n,a),he()}var $h=(n,e)=>e.onclick&&e.onclick({item:{id:"toggle-section",key:e.active?null:e.key}}),eg=P("<div><h3> </h3> <i></i></div>");function tg(n,e){fe(e,!0);var t=eg();let r;t.__click=[$h,e];var a=Y(t),i=Y(a,!0);L(a);var s=le(a,2);L(t),j(o=>{r=ye(t,1,"wx-section svelte-gohf7m",null,r,o),Me(i,e.label),ye(s,1,`wxi-angle-${e.active?"down":"right"} wx-icon`,"svelte-gohf7m")},[()=>({"wx-section-active":e.active})]),b(n,t),he()}je(["click"]);St("text",Da);St("textarea",io);St("checkbox",oo);St("readonly",Zh);St("section",tg);wi(Ha);var ng=(n,e,t)=>e(l(t).link.id),rg=P('<tr><td class="wx-cell svelte-8406i3"><div class="wx-task-name svelte-8406i3"> </div></td><td class="wx-cell svelte-8406i3"><div class="wx-wrapper svelte-8406i3"><!></div></td><td class="wx-cell svelte-8406i3"><i class="wxi-delete wx-delete-icon svelte-8406i3" role="button"></i></td></tr>'),ag=P("<table><tbody></tbody></table>"),ig=P('<div class="wx-links svelte-8406i3"><!></div>');function og(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(o,"$activeTask",t),i=()=>ae(c,"$links",t),s=Ae("wx-i18n").getGroup("gantt"),{activeTask:o,_links:c}=e.api.getReactiveState();let d=Q(void 0);Ve(()=>{O(d,u(),!0)});function u(){if(a()){const w=i().filter(S=>S.target==a()).map(S=>({link:S,task:e.api.getTask(S.source)})),y=i().filter(S=>S.source==a()).map(S=>({link:S,task:e.api.getTask(S.target)}));return[{title:s("Predecessors"),data:w},{title:s("Successors"),data:y}]}}const f=[{id:"e2s",label:s("End-to-start")},{id:"s2s",label:s("Start-to-start")},{id:"e2e",label:s("End-to-end")},{id:"s2e",label:s("Start-to-end")}];function h(w){e.autoSave?e.api.exec("delete-link",{id:w}):(O(d,l(d).map(y=>({...y,data:y.data.filter(S=>S.link.id!==w)})),!0),e.onlinkschange&&e.onlinkschange({id:w,action:"delete-link",data:{id:w}}))}function g(w,y){const S=w.value;e.autoSave?e.api.exec("update-link",{id:y,link:{type:S}}):(O(d,l(d).map(M=>({...M,data:M.data.map(k=>k.link.id===y?{...k,link:{...k.link,type:S}}:k)})),!0),e.onlinkschange&&e.onlinkschange({id:y,action:"update-link",data:{id:y,link:{type:S}}}))}var v=Z(),m=q(v);Ge(m,17,()=>l(d),gt,(w,y,S,M)=>{var k=Z(),_=q(k);{var x=T=>{var z=ig(),p=Y(z);fr(p,{get label(){return l(y).title},position:"top",children:(C,H)=>{var N=ag(),F=Y(N);Ge(F,21,()=>l(y).data,gt,(A,X)=>{var ue=rg(),ne=Y(ue),oe=Y(ne),$=Y(oe,!0);L(oe),L(ne);var J=le(ne),U=Y(J),ce=Y(U);{const We=(He,Se)=>{let qe=()=>Se?.().option;cr();var ee=wt();j(()=>Me(ee,qe().label)),b(He,ee)};let we=D(()=>s("Select link type"));so(ce,{get value(){return l(X).link.type},get placeholder(){return l(we)},get options(){return f},onchange:He=>g(He,l(X).link.id),children:We,$$slots:{default:!0}})}L(U),L(J);var me=le(J),Ie=Y(me);Ie.__click=[ng,h,X],L(me),L(ue),j(()=>Me($,l(X).task.text||"")),b(A,ue)}),L(F),L(N),b(C,N)},$$slots:{default:!0}}),L(z),b(T,z)};B(_,T=>{l(y).data.length&&T(x)})}b(w,k)}),b(n,v),he(),r()}je(["click"]);var sg=P('<div class="date-time-controll svelte-dp4vvh"><!> <!></div>');function lg(n,e){fe(e,!0);let t=rn(e,["$$slots","$$events","$$legacy","value","time","format","onchange"]);function r(c){const d=new Date(c.value);d.setHours(e.value.getHours()),d.setMinutes(e.value.getMinutes()),e.onchange&&e.onchange({value:d})}var a=sg(),i=Y(a);lo(i,mt(()=>t,{get value(){return e.value},onchange:r,get format(){return e.format},buttons:["today"],clear:!1}));var s=le(i,2);{var o=c=>{co(c,{get value(){return e.value},get onchange(){return e.onchange},get format(){return e.format}})};B(s,c=>{e.time&&c(o)})}L(a),b(n,a),he()}function Hg(n,e){fe(e,!0);const[t,r]=nt(),a=()=>ae(l(N),"$activeTask",t),i=()=>ae(l(F),"$taskId",t),s=()=>ae(l($),"$taskTypes",t),o=()=>ae(l(X),"$unscheduledTasks",t),c=()=>ae(l(A),"$unit",t);St("select",Ia),St("date",lg),St("twostate",uo),St("slider",fo),St("counter",ho),St("links",og);const d=Ae("wx-i18n"),u=d.getRaw(),f=u.gantt?.dateFormat||u.formats?.dateFormat,h=Jc(f,u.calendar),g=d.getGroup("gantt");let v=E(e,"items",3,Xl),m=E(e,"css",3,""),w=E(e,"layout",3,"default"),y=E(e,"readonly",3,!1),S=E(e,"placement",3,"sidebar"),M=E(e,"bottomBar",3,!0),k=E(e,"topBar",3,!0),_=E(e,"autoSave",3,!0),x=E(e,"focus",3,!1),T=D(()=>{if(k()===!0&&!y()){const I=[{comp:"icon",icon:"wxi-close",id:"close"},{comp:"spacer"},{comp:"button",type:"danger",text:g("Delete"),id:"delete"}];return _()?{items:I}:{items:[...I,{comp:"button",type:"primary",text:g("Save"),id:"save"}]}}return k()}),z=Q(!1),p=D(()=>l(z)?"wx-full-screen":"");Ve(()=>{const I=Ci(C);return I.observe(),()=>{I.disconnect()}});function C(I){O(z,I,!0)}let H=D(()=>e.api?.getReactiveState()),N=D(()=>l(H)?._activeTask??null),F=D(()=>l(H)?.activeTask??null),A=D(()=>l(H)?.durationUnit),X=D(()=>l(H)?.unscheduledTasks),ue=Q(void 0),ne=Q(void 0),oe=Q(Ze({}));Ve(()=>{O(ue,a()?.type,!0),O(ne,a()?.unscheduled,!0)}),Ve(()=>{i(),O(oe,{},!0)});let $=D(()=>l(H)?.taskTypes),J=D(()=>l(ue)==="milestone"),U=D(()=>l(ue)==="summary");const ce=D(()=>{const I=Ie(v(),l(ne));return We(I)});let me=D(()=>{if(y()&&a()){let I={};return l(ce).forEach(({key:R,comp:ie})=>{if(ie!=="links"){const te=a()[R];ie==="date"&&te instanceof Date?I[R]=h(te):ie==="slider"&&R==="progress"?I[R]=`${te}%`:I[R]=te}}),I}return a()?{...a()}:null});function Ie(I,R){const ie={start:1,end:1,duration:1};return I.map(te=>{const re={...te};if(te.config&&(re.config={...re.config}),re.comp==="links"&&e.api&&(re.api=e.api,re.autoSave=_(),re.onlinkschange=we),re.comp==="select"&&re.key==="type"){let ze=re.options??(l($)?s():[]);re.options=ze.map(Be=>({...Be,label:g(Be.label)}))}return re.comp==="slider"&&re.key==="progress"&&(re.labelTemplate=ze=>`${g(re.label)} ${ze}%`),re.label&&(re.label=g(re.label)),re.config?.placeholder&&(re.config.placeholder=g(re.config.placeholder)),o()&&ie[re.key]&&(R?re.disabled=!0:delete re.disabled),re})}function We(I){return I.filter(({comp:R,key:ie,options:te})=>{switch(R){case"date":return(!l(J)||ie!=="end"&&ie!=="base_end")&&!l(U);case"select":return te.length>1;case"twostate":return o()&&!l(U);case"counter":return!l(U)&&!l(J);case"slider":return!l(J);default:return!0}})}function we({id:I,action:R,data:ie}){l(oe)[I]={action:R,data:ie}}function He(){for(let I in l(oe)){const{action:R,data:ie}=l(oe)[I];e.api.exec(R,ie)}}function Se(){e.api.exec("delete-task",{id:i()})}function qe(){e.api.exec("show-editor",{id:null})}function ee(I){const{item:R,changes:ie}=I;if(R.id==="delete"&&Se(),R.id==="save")if(!ie.length)He();else return;R.comp&&qe()}function pe(I){let{update:R,key:ie,value:te}=I;I.update=G({...R},ie),_()||(ie==="type"&&O(ue,te,!0),O(ne,R.unscheduled,!0))}function G(I,R){return o()&&I.type==="summary"&&(I.unscheduled=!1),mn(I,c(),!0,R),I}function ve(I){let{values:R}=I;R={...R,unscheduled:o()&&R.unscheduled&&R.type!=="summary"},delete R.links,delete R.data,e.api.exec("update-task",{id:i(),task:R}),_()||He()}var Ce=Z(),Re=q(Ce);{var se=I=>{zn(I,{children:(R,ie)=>{{let te=D(()=>`wx-gantt-editor ${l(p)} ${m()}`);Jh(R,{get css(){return l(te)},get items(){return l(ce)},get values(){return l(me)},get topBar(){return l(T)},get bottomBar(){return M()},get placement(){return S()},get layout(){return w()},get readonly(){return y()},get autoSave(){return _()},get focus(){return x()},onaction:ee,onsave:ve,onchange:pe})}},$$slots:{default:!0}})};B(Re,I=>{l(me)&&I(se)})}b(n,Ce),he(),r()}function Rg(n,e){fe(e,!0);let t=E(e,"columns",3,null),r=D(()=>e.api?.getTable());af(n,{get api(){return l(r)},get columns(){return t()},children:(a,i)=>{var s=Z(),o=q(s);ct(o,()=>e.children??Vt),b(a,s)},$$slots:{default:!0}}),he()}var cg=P('<div class="wx-gantt-tooltip-text svelte-110fts1"> </div>'),dg=P('<div class="wx-gantt-tooltip"><!></div>'),ug=P('<div class="wx-tooltip-area svelte-110fts1"><!> <!></div>');function Pg(n,e){fe(e,!0);const t=E(e,"data",3,g);let r,a=Q(Ze({})),i=Q(null),s=Q(null),o=Q(Ze({}));function c(k){for(;k;){if(k.getAttribute){const _=k.getAttribute("data-tooltip-id"),x=k.getAttribute("data-tooltip-at"),T=k.getAttribute("data-tooltip");if(_||T)return{id:_,tooltip:T,target:k,at:x}}k=k.parentNode}return{id:null,tooltip:null,target:null,at:null}}Ve(()=>{if(l(s)){const k=l(s).getBoundingClientRect();k.right>=l(a).right&&(l(o).left=l(a).width-k.width-5),k.bottom>=l(a).bottom&&(l(o).top-=k.bottom-l(a).bottom+2)}});let d;const u=300,f=k=>{clearTimeout(d),d=setTimeout(()=>{k()},u)};function h(k){let{id:_,tooltip:x,target:T,at:z}=c(k.target);if(O(o,null),O(i,null),!x)if(_)x=v(_);else{clearTimeout(d);return}f(()=>{_&&t()&&O(i,t()(m(_)),!0);const p=T.getBoundingClientRect();O(a,r.getBoundingClientRect(),!0);let C,H;z==="left"?(C=p.top+5-l(a).top,H=p.right+5-l(a).left):(C=p.top+p.height-l(a).top,H=k.clientX-l(a).left),O(o,{top:C,left:H,text:x},!0)})}function g(k){return e.api?.getTask(m(k))||null}function v(k){return g(k)?.text||""}function m(k){const _=parseInt(k);return isNaN(_)?k:_}var w=ug();w.__mousemove=h;var y=Y(w);{var S=k=>{var _=dg(),x=Y(_);{var T=p=>{var C=Z(),H=q(C);tt(H,()=>e.content,(N,F)=>{F(N,{get data(){return l(i)}})}),b(p,C)},z=p=>{var C=Z(),H=q(C);{var N=F=>{var A=cg(),X=Y(A,!0);L(A),j(()=>Me(X,l(o).text)),b(F,A)};B(H,F=>{l(o).text&&F(N)},!0)}b(p,C)};B(x,p=>{e.content?p(T):p(z,!1)})}L(_),Xe(_,p=>O(s,p),()=>l(s)),j(()=>Te(_,`top:${l(o).top??""}px;left:${l(o).left??""}px`)),b(k,_)};B(y,k=>{l(o)&&(l(o).text||e.content)&&k(S)})}var M=le(y,2);ct(M,()=>e.children),L(w),Xe(w,k=>r=k,()=>r),b(n,w),he()}je(["mousemove"]);function Lg(n,e){let t=E(e,"fonts",3,!0);var r=Z(),a=q(r);{var i=o=>{Pr(o,{get fonts(){return t()},children:(c,d)=>{var u=Z(),f=q(u);ct(f,()=>e.children),b(c,u)},$$slots:{default:!0}})},s=o=>{Pr(o,{get fonts(){return t()}})};B(a,o=>{e.children?o(i):o(s,!1)})}b(n,r)}function zg(n,e){let t=E(e,"fonts",3,!0);var r=Z(),a=q(r);{var i=o=>{Lr(o,{get fonts(){return t()},children:(c,d)=>{var u=Z(),f=q(u);ct(f,()=>e.children),b(c,u)},$$slots:{default:!0}})},s=o=>{Lr(o,{get fonts(){return t()}})};B(a,o=>{e.children?o(i):o(s,!1)})}b(n,r)}function Ag(n,e){let t=E(e,"fonts",3,!0);var r=Z(),a=q(r);{var i=o=>{zr(o,{get fonts(){return t()},children:(c,d)=>{var u=Z(),f=q(u);ct(f,()=>e.children),b(c,u)},$$slots:{default:!0}})},s=o=>{zr(o,{get fonts(){return t()}})};B(a,o=>{e.children?o(i):o(s,!1)})}b(n,r)}export{Wg as ContextMenu,Hg as Editor,Dg as Fullscreen,Eg as Gantt,Rg as HeaderMenu,Lg as Material,Ig as Toolbar,Pg as Tooltip,zg as Willow,Ag as WillowDark,Hl as defaultColumns,Xl as defaultEditorItems,Qr as defaultMenuOptions,Kl as defaultTaskTypes,Jr as defaultToolbarButtons,St as registerEditorItem,Cg as registerScaleUnit};
